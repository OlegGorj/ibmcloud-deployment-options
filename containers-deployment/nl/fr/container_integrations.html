<!DOCTYPE html><html lang="fr-fr">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="dcterms.date" content="2017-11-10">
<meta name="dcterms.rights" content="© Copyright IBM Corp. 2014, 2017">

<meta name="description" content="Vous pouvez utiliser divers services du Catalogue Bluemix avec IBM Bluemix Container Service. De nombreux services Bluemix vous aident à élargir les capacités des applications que vous déployez dans des conteneurs. De plus, certains services Bluemix peuvent vous aider à gérer vos conteneurs.">
<meta name="keywords" content="IBM Containers, conteneurs, services, Bluemix, intégrations, liaison, notification d'alerte, règles, notifications, Delivery Pipeline, pipeline, distribution continue, conteneur unique, delivery pipeline, image, génération, Vulnerability Advisor, sécurité, service, nettoyage des images, propriétés d'environnement, lier, groupe de conteneurs, services Devops, conteneur, services Devops, déployer">
<meta name="geo.country" content="ZZ">
<script>
    digitalData = {
      page: {
        pageInfo: {
  language: "fr-fr",

  version: "v18",
  ibm: {
  country: "ZZ",
  type: "CT701"
  
         }
       }
     }
   };
  </script><link rel="stylesheet" type="text/css" href="./ibmdita.css">
<title>Intégration de services à utiliser avec conteneurs uniques et évolutifs</title>
</head>
<body><main role="main"><div><article class="nested0" role="article" aria-labelledby="d58934e6" id="container_integrations"><h1 class="topictitle1" id="d58934e6"><span class="ph" id="title">Intégration de services avec
les <span class="ph">conteneurs uniques et évolutifs</span></span></h1>
<div class="body conbody"><div class="abstract"><div class="shortdesc"><span class="ph" id="shortdesc">Vous pouvez utiliser divers services du <span class="keyword wintitle">Catalogue</span> <span class="keyword">Bluemix</span>
avec <span class="keyword">IBM®
Bluemix Container Service</span>. De nombreux services
<span class="keyword">Bluemix</span> vous aident à élargir les capacités des applications que vous déployez dans des
conteneurs. De plus, certains services <span class="keyword">Bluemix</span> peuvent vous aider à gérer vos conteneurs.</span></div>


<div class="p"><div class="note attention"><span class="attentiontitle">Avertissement :</span> <span class="ph">Des comptes d'essai gratuits ne sont pas disponibles pour <span class="ph">conteneurs uniques et évolutifs</span>. <a href="cs_ov.html" title="IBM Bluemix Container Service combine Docker et Kubernetes afin de proposer des outils performants, une expérience utilisateur intuitive et une sécurité et un isolement intégrés afin d'automatiser le déploiement, l'opération, la mise à l'échelle et la surveillance des applications conteneurisées dans un cluster d'hôtes de traitement indépendants via les API Kubernetes.">Découvrez la gestion de cluster et migrez vers
Kubernetes dans <span class="keyword">IBM
Bluemix Container Service</span> sur <span class="keyword">Bluemix</span> Public.</a></span></div>
</div>


<div class="p">Sur cette page :<div class="lines">&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__data">Services d'analyse et de stockage de données</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__devops">Services DevOps</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__integrate">Services d'intégration</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__network">Services réseau</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__security">Services de sécurité</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations_binding" title="IBM Bluemix comporte une liste de services qu'il gère pour les développeurs d'application. Pour ajouter un service Bluemix pour son utilisation par votre conteneur, vous devez demander une instance de ce service et le lier au conteneur.">Liaison d'un service depuis l'interface graphique Bluemix</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations_binding_cli" title="IBM Bluemix comporte une liste de services qu'il gère pour les développeurs d'application. Pour ajouter un service Bluemix pour son utilisation par votre conteneur, vous devez demander une instance de ce service et le lier au conteneur.">Liaison d'un service à un conteneur depuis l'interface CLI</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_alertnotification" title="Configurez votre application afin d'envoyer des notifications lorsqu'une certaine condition ou un certain critère sont remplis et utilisez le service Alert Notification pour gérer vos notifications. A l'aide du service Alert Notification, vous pouvez créer des règles de notification personnalisées afin de filtrer les alertes qui vous intéressent. Vous pouvez affiner selon vos besoins les filtres de règle en spécifiant des individus ou des groupes comme destinataires des alertes, ainsi que les méthodes de notification privilégiées et leur fréquence.">Configuration d'alertes à l'aide d'Alert Notification pour les applications déployées dans des conteneurs</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_pipeline_ov" title="Vous pouvez automatiser vos générations d'applications et vos déploiements de conteneurs dans Bluemix à l'aide du Delivery Pipeline, lequel est un élément d'IBM Bluemix Continuous Delivery.">Automatisation des déploiements de vos conteneurs à l'aide du Delivery Pipeline dans le service Continuous Delivery</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_cfapp_tutorial_intro" title="Vous pouvez prendre une application déployée auparavant à l'aide de Cloud et la déployer dans un conteneur à l'aide d'IBM Bluemix Container Service.">Tutoriel : Déploiement d'une application Cloud Foundry Node.js dans un conteneur</a></div>
</div>
</div>
<section role="region" aria-labelledby="d58934e217" id="container_integrations__data"><h2 class="sectiontitle" id="d58934e217">Services d'analyse et de stockage de données</h2>
<div class="p"><dl><dt class="dlterm"><span class="keyword">Object Storage</span></dt>
<dd><p>Stockez les données persistantes répliquées sur plusieurs noeuds de stockage afin de les sauvegarder.</p>

<div class="p"><ul><li>Pour des informations générales sur le service <span class="keyword">Object Storage</span>, voir
<a href="../services/ObjectStorage/index.html">Initiation au service
<span class="keyword">Object Storage</span></a>.</li>
</ul>
</div>
</dd>
</dl>
</div>
</section><section role="region" aria-labelledby="d58934e243" id="container_integrations__devops"><h2 class="sectiontitle" id="d58934e243">Services DevOps</h2>
<div class="p"><dl><dt class="dlterm"><span class="keyword">Active Deploy</span></dt>
<dd><p>Vous pouvez mettre à jour vos groupes de conteneurs sans encourir d'indisponibilité et, le cas échéant, rétablir rapidement leur version d'origine. Le
service <span class="keyword">IBM Active
Deploy for Bluemix</span>
utilise une approche échelonnée des déploiements, ce qui vous laisse du temps pour tester et valider votre application mise à jour dans un environnement de production.</p>
</dd>
<dd class="ddexpand"><div class="p">Pour plus d'informations sur la mise à jour de groupes de conteneurs en cours d'exécution, voir :<ul><li><a href="../services/ActiveDeploy/updatingapps.html#updatingappscli" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">Mise à jour d'applications ou de groupes de conteneurs à
l'aide du service Active Deploy (Interface de ligne de commande)</a></li>
<li><a href="../services/ActiveDeploy/updatingapps.html#updatingappsgui" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">Mise à jour d'applications ou de groupes de conteneurs à
l'aide du service Active Deploy service (Interface graphique)</a></li>
</ul>
</div>
</dd>
<dt class="dlterm"><span class="keyword">Alert Notification</span></dt>
<dd><p>Définissez des règles de notification pour ne filtrer que les alertes qui doivent provenir de vos applications. Vous pouvez affiner selon vos besoins les filtres de règle en
spécifiant des individus ou des groupes comme destinataires des alertes, ainsi que les méthodes de notification privilégiées et leur fréquence. </p>

<div class="p"><ul><li>Pour plus d'informations sur l'utilisation de conteneurs avec <span class="keyword">Alert Notification</span>,
voir <a href="container_integrations.html#container_alertnotification" title="Configurez votre application afin d'envoyer des notifications lorsqu'une certaine condition ou un certain critère sont remplis et utilisez le service Alert Notification pour gérer vos notifications. A l'aide du service Alert Notification, vous pouvez créer des règles de notification personnalisées afin de filtrer les alertes qui vous intéressent. Vous pouvez affiner selon vos besoins les filtres de règle en spécifiant des individus ou des groupes comme destinataires des alertes, ainsi que les méthodes de notification privilégiées et leur fréquence.">Configuration d'alertes à l'aide d'Alert Notification pour les applications déployées dans des conteneurs</a>.</li>
<li>Pour des informations générales sur le service <span class="keyword">Alert Notification</span>, voir
<a href="../services/AlertNotification/index.html">Initiation à
<span class="keyword">Alert Notification</span></a>.</li>
</ul>
</div>
</dd>
<dt class="dlterm"><span class="keyword">Delivery Pipeline</span></dt>
<dd><p>Vous pouvez automatiser vos générations d'applications et vos déploiements de conteneurs dans <span class="keyword">Bluemix</span> à l'aide du <span class="keyword">Delivery Pipeline</span>, lequel est un élément
d'<span class="keyword">IBM
Bluemix Continuous Delivery</span>. </p>

<div class="p"><ul><li>Pour plus d'informations sur l'utilisation des conteneurs avec le pipeline, voir <a href="container_integrations.html#container_pipeline_ov" title="Vous pouvez automatiser vos générations d'applications et vos déploiements de conteneurs dans Bluemix à l'aide du Delivery Pipeline, lequel est un élément d'IBM Bluemix Continuous Delivery.">Automatisation des déploiements de vos conteneurs à l'aide du Delivery Pipeline dans le service Continuous Delivery</a>.</li>
<li>Pour des informations générales sur le service <span class="keyword">Delivery Pipeline</span>, voir
<a href="../services/ContinuousDelivery/pipeline_about.html">Initiation à Delivery Pipeline</a>.</li>
</ul>
</div>
</dd>
<dt class="dlterm">UrbanCode Deploy</dt>
<dd><p>Gérez vos éditions et automatisez les déploiements de conteneurs à l'aide d'IBM UrbanCode Deploy. Ce service fournit des outils vous permettant une visibilité
de vos déploiements dans tous les environnements. Vous pouvez l'utiliser à la place du service
<span class="keyword">Delivery Pipeline</span>.</p>

<ul><li>Pour des informations sur l'achat du produit, accédez à la page produit
d'<a href="http://www.ibm.com/software/products/en/ucdep" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">IBM UrbanCode Deploy</a>.</li>
<li>Pour des informations générales sur UrbanCode Deploy, reportez-vous au site
<a href="http://www.ibm.com/support/knowledgecenter/SS4GSP/ucd_welcome.html" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">IBM Knowledge
Center</a>.</li>
</ul>
</dd>
</dl>
</div>
</section><section role="region" aria-labelledby="d58934e387" id="container_integrations__integrate"><h2 class="sectiontitle" id="d58934e387">Services d'intégration</h2>
<div class="p"><dl><dt class="dlterm">Istio</dt>
<dd><p>Vous pouvez gérer vos microservices dans <span class="keyword">IBM
Bluemix Container Service</span>
pour une application ou un service. <span class="ph">Pour toute information ou si vous désirez vous impliquer dans le projet open source Istio, voir
<a href="https://istio.io/" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">https://istio.io/</a>.</span></p>
</dd>
<dt class="dlterm"><span class="keyword">Secure Gateway</span></dt>
<dd><p>Connectez des applications <span class="keyword">Bluemix</span> de manière sécurisée à des emplacements distants sur site ou dans le cloud.</p>

<div class="p"><ul><li>Pour toute information sur l'utilisation d'<span class="keyword">IBM
Bluemix Container Service</span>
avec <span class="keyword">Secure Gateway</span>, voir <a href="../services/SecureGateway/sg_003.html#sg_003">Utilisation de Docker en tant que client</a>.</li>
<li>Pour des informations générales sur le service <span class="keyword">Secure Gateway</span>, voir
<a href="../services/SecureGateway/secure_gateway.html">Initiation au service
<span class="keyword">Secure Gateway</span></a>.</li>
</ul>
</div>

</dd>
</dl>
</div>
</section><section role="region" aria-labelledby="d58934e454" id="container_integrations__network"><h2 class="sectiontitle" id="d58934e454">Services réseau</h2>
<div class="p"><dl><dt class="dlterm">VPN</dt>
<dd><p>Permet à des conteneurs de communiquer entre-eux entre un espace <span class="keyword">Bluemix</span> et un serveur intranet.</p>

<div class="p"><ul><li>Pour des informations générales sur le service <span class="keyword">IBM
VPN</span>, voir
<a href="../services/vpn/index.html">Initiation au service <span class="keyword">IBM
VPN</span></a>.</li>
</ul>
</div>
</dd>
</dl>
</div>
</section><section role="region" aria-labelledby="d58934e487" id="container_integrations__security"><h2 class="sectiontitle" id="d58934e487">Services de sécurité</h2>
<div class="p"><dl><dt class="dlterm"><span class="keyword">Activity Tracker</span></dt>
<dd><p>Effectuez un audit des appels d'API pour n'importe quel type d'activité anormale et pour la mise en conformité avec les exigences en matière d'audit réglementaire.</p>
</dd>
<dd class="ddexpand"><div class="p"><ul><li>Pour des informations générales sur le service <span class="keyword">Activity Tracker</span>, voir
<a href="../services/AccessTrail/index.html">Initiation au service
<span class="keyword">Activity Tracker</span></a>.</li>
</ul>
</div>
</dd>
</dl>
</div>
</section></div>
<article class="topic concept nested1" role="article" aria-labelledby="d58934e513" id="rellinks"><h2 class="topictitle2" id="d58934e513">Liens connexes</h2>
<aside role="complementary" aria-labelledby="d58934e513">
<div class="linklist" id="general"><h3 class="linklistlabel">Liens connexes</h3>
<ul><li><img src="./sout.gif" alt=""><a href="https://wiki.eclipse.org/Linux_Tools_Project/Docker_Tooling" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">Outils Docker pour Eclipse</a></li>
</ul></div>
</aside></article><article class="topic task nested1" role="article" aria-labelledby="d58934e523" lang="fr-fr" id="container_integrations_binding"><h2 class="topictitle2" id="d58934e523">Liaison d'un service depuis l'interface graphique <span class="keyword">Bluemix</span></h2>
<div class="body taskbody"><p class="shortdesc"><span class="keyword">IBM
Bluemix</span> comporte une liste de services qu'il gère pour les développeurs d'application. Pour ajouter un
service <span class="keyword">Bluemix</span> pour son utilisation par votre conteneur,
vous devez demander une instance de ce service et le lier au conteneur.</p>
<div class="section prereq">Avant de commencer, ajoutez le service à votre espace <span class="keyword">Bluemix</span>. Pour plus
d'informations, voir <a href="../services/reqnsi.html#req_instance">Demande d'une nouvelle instance de service</a>.</div><div class="section context"><div class="note restriction" id="container_integrations_binding__restriction"><span class="restrictiontitle">Restriction :</span> Certains services <span class="keyword">Bluemix</span> ne gèrent pas leur liaison directe à un conteneur et cela provoque un échec lors de la création de conteneur. Dans ce cas, commencez par lier le service <span class="keyword">Bluemix</span> à une application Cloud Foundry, puis liez l'application au conteneur. L'application fait office de pont entre le service et le conteneur. Pour plus d'informations, voir
<a href="container_troubleshoot.html#ts_bridge_app">Le service Bluemix ne peut pas être lié directement à un conteneur</a>.</div>
</div><ol class="steps"><li class="step"><span class="cmd">Dans le <span class="keyword wintitle">Catalogue</span> <span class="keyword">Bluemix</span>, cliquez sur
<span class="ph uicontrol">Conteneurs</span>.</span></li>
<li class="step"><span class="cmd">Cliquez sur une image de conteneur.</span></li>
<li class="step"><span class="cmd">Développez <span class="ph uicontrol">Options avancées</span> et, pour <span class="ph uicontrol">Sélectionner un service</span>,
sélectionnez un service <span class="keyword">Bluemix</span> disponible.</span></li>
<li class="step"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter</span>.</span> Le service <span class="keyword">Bluemix</span> est affiché dans la zone
<span class="ph uicontrol">Déjà lié à votre conteneur</span>.</li>
<li class="step"><span class="cmd">Renseignez les autres zones, puis cliquez sur <span class="ph uicontrol">CREER</span>.</span></li>
<li class="step"><span class="cmd">Lorsque le conteneur est créé, vérifiez que les informations VCAP_SERVICES sont affichées.</span> Dans l'onglet Présentation du conteneur, localisez le service lié et cliquez sur
<span class="ph uicontrol">Afficher les données d'identification</span>. Les informations affichées sont celles de VCAP_SERVICES.</li>
</ol>
</div>
</article><article class="topic task nested1" role="article" aria-labelledby="d58934e679" lang="fr-fr" id="container_integrations_binding_cli"><h2 class="topictitle2" id="d58934e679">Liaison d'un service à un conteneur depuis l'interface CLI</h2>
<div class="body taskbody"><p class="shortdesc"><span class="keyword">IBM
Bluemix</span> comporte une liste de services qu'il gère pour les développeurs d'application. Pour ajouter un
service <span class="keyword">Bluemix</span> pour son utilisation par votre conteneur,
vous devez demander une instance de ce service et le lier au conteneur.</p>
<div class="section prereq">Avant de commencer, ajoutez le service à votre espace <span class="keyword">Bluemix</span>. Pour plus
d'informations, voir <a href="../services/reqnsi.html#req_instance">Demande d'une nouvelle instance de service</a>.</div><div class="section context"><div class="note restriction" id="container_integrations_binding_cli__restriction"><span class="restrictiontitle">Restriction :</span> Certains services <span class="keyword">Bluemix</span> ne gèrent pas leur liaison directe à un conteneur et cela provoque un échec lors de la création de conteneur. Dans ce cas, commencez par lier le service <span class="keyword">Bluemix</span> à une application Cloud Foundry, puis liez l'application au conteneur. L'application fait office de pont entre le service et le conteneur. Pour plus d'informations, voir
<a href="container_troubleshoot.html#ts_bridge_app">Le service Bluemix ne peut pas être lié directement à un conteneur</a>.</div>
</div><ol class="steps"><li class="step stepexpand"><span class="cmd">Utilisez l'une des commandes suivantes pour lier l'instance de service <span class="keyword">Bluemix</span> à un nouveau conteneur.</span> <div class="note tip"><span class="tiptitle">Conseil :</span> <span class="ph">Exécutez <samp class="ph codeph"><span class="ph">bx ic</span> namespace-get</samp> pour extraire votre espace de nom et remplacez <var class="keyword varname">&lt;my_namespace&gt;</var> par votre espace de nom. </span></div>
<ul class="ul choices"><li class="li choice">Si vous créez un conteneur unique, utilisez la commande suivante.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> run --name
<var class="keyword varname">nom_conteneur</var> -e "<var class="keyword varname">CCS_BIND_SRV</var>=<var class="keyword varname">instance_service1</var>,<var class="keyword varname">instance_service2</var>"
registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">&lt;mon_espace_nom&gt;</var>/<var class="keyword varname">nom_image</var></code></pre>
</li>
<li class="li choice">Si vous créez un groupe de conteneurs, utilisez la commande suivante.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> group-create --name <var class="keyword varname">nom_groupe_conteneurs</var> -e "<var class="keyword varname">CCS_BIND_SRV</var>=<var class="keyword varname">instance_service1</var>,<var class="keyword varname">instance_service2</var>" registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">&lt;mon_espace_nom&gt;</var>/<var class="keyword varname">nom_image</var></code></pre>
</li>
<li class="li choice">Si vous liez un service à un groupe de conteneurs déjà en exécution, utilisez la commande suivante. Cette commande n'est disponible que pour les groupes de
conteneurs. Vous ne pouvez lier qu'un seul service.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> service-bind <var class="keyword varname">nom_groupe_conteneurs</var> <var class="keyword varname">instance_service</var></code></pre>
</li>
</ul>
</li>
<li class="step stepexpand"><span class="cmd">Utilisez l'une des commandes suivantes pour vérifier que l'instance de service est liée au conteneur.</span> <ul class="ul choices"><li class="li choice">Pour un conteneur unique, utilisez la commande suivante.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> inspect CONTENEUR</code></pre>
</li>
<li class="li choice">Pour un groupe de conteneurs, utilisez la commande suivante.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> group-inspect GROUPE</code></pre>
</li>
</ul>
Vérifiez que les informations VCAP_SERVICES sur le service sont affichées.
<pre class="codeblock"><code>{
 "VCAP_SERVICES": {
  "&lt;service_name&gt;": [
   {
    "credentials": {
     "hostname": "&lt;hostname_id&gt;",
     "jdbcUrl": "&lt;jdbc_URL&gt;",
     "name": "&lt;encoded_name&gt;",
     "password": "&lt;encoded_password&gt;",
     "port": "&lt;port_number&gt;",
     "uri": "&lt;service_URI&gt;",
     "username": "&lt;encoded_username&gt;"
    },
    "label": "&lt;service_name&gt;",
    "name": "&lt;service_instance&gt;",
    "plan": "&lt;plan_name&gt;",
    "tags": [
     "&lt;tag1&gt;",
     "&lt;tag2&gt;",
     "&lt;tag3&gt;"
    ]
   } </code></pre>
</li>
</ol>
</div>
</article><article class="topic task nested1" role="article" aria-labelledby="d58934e878" lang="fr-fr" id="container_alertnotification"><h2 class="topictitle2" id="d58934e878">Configuration d'alertes à l'aide d'<span class="keyword">Alert Notification</span> pour les applications déployées dans
des conteneurs</h2>
<div class="body taskbody"><p class="shortdesc">Configurez votre application afin d'envoyer des notifications lorsqu'une certaine condition ou un certain critère sont remplis et utilisez le service
<span class="keyword">Alert Notification</span> pour gérer vos notifications. A l'aide du service
<span class="keyword">Alert Notification</span>, vous pouvez créer des règles de notification personnalisées afin de filtrer
les alertes qui vous intéressent. Vous pouvez affiner selon vos besoins les filtres de règle en
spécifiant des individus ou des groupes comme destinataires des alertes, ainsi que les méthodes de notification privilégiées et leur fréquence.</p>
<div class="section prereq">Avant de commencer, consultez la rubrique <a href="../services/reqnsi.html#req_instance">Demande d'une nouvelle instance de service</a> et créez une instance du service <span class="keyword">Alert Notification</span> dans votre espace <span class="keyword">Bluemix</span>. </div><div class="section context"><p>Les étapes décrites ci-après illustrent la création d'un conteneur qui exécute un exemple d'application de noeud <span class="keyword">Alert Notification</span>. Vous pouvez envoyer des alertes de test au service <span class="keyword">Alert Notification</span> et les examiner dans l'outil Afficheur d'alertes. </p>
</div><ol class="steps"><li class="step stepexpand"><span class="cmd">Téléchargez et clonez l'exemple d'application <a href="https://github.com/IBM-Bluemix/alert-notification-helloworld" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">Alert
Notification</a> sur votre machine locale. </span> <pre class="codeblock"><code>git clone <span class="ph filepath">https://github.com/IBM-Bluemix/alert-notification-helloworld.git</span></code></pre>


<div class="steps note"><span class="notetitle">Remarque :</span> Lorsque vous clonez le projet Git, un nouveau dossier nommé <span class="ph filepath">alert-notification-helloworld</span> est créé sur votre machine locale. </div>
</li>
<li class="step stepexpand"><span class="cmd">Générez une image de conteneur incluant l'exemple d'application Alert Notification et transférez-la à votre registre d'images
<span class="keyword">Bluemix</span> privé. </span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd"><a href="container_cli_cfic_install.html#container_cli_login" title="Après son installation, connectez-vous à l'interface de ligne de commande pour l'utiliser.">Connectez-vous à l'interface de ligne de commande
d'<span class="keyword">IBM
Bluemix Container Service</span></a>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Accédez au répertoire <span class="ph filepath">alert-notification-helloworld</span>. </span></li>
<li class="li substep substepexpand"><span class="cmd">Créez votre image de conteneur et transférez-la à votre registre d'images <span class="keyword">Bluemix</span>
privé. Exécutez <samp class="ph codeph"><span class="ph"><samp class="ph codeph">bx ic</samp></span>
namespace-get</samp> pour extraire les informations sur votre espace de nom en
remplaçant <var class="keyword varname">&lt;mon_espace_nom&gt;</var> par votre espace de nom.</span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> build -t
registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">&lt;mon_espace_nom&gt;</var>/alert .</code></pre>
</li>
<li class="li substep substepexpand"><span class="cmd">Vérifiez que votre image de conteneur a bien été générée et transférée. </span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> images</code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Créez un conteneur à partir de l'image et liez-lui le service <span class="keyword">Alert Notification</span>. Remplacez
<var class="keyword varname">&lt;mon_espace_nom&gt;</var> par les informations de votre espace de nom et
<var class="keyword varname">&lt;mon_alerte&gt;</var> par le nom de l'instance de service que vous avez créée au début. </span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> run --name alertcontainer -p 8080 -e "CCS_BIND_SRV=<var class="keyword varname">&lt;mon_alerte&gt;</var>"
registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">&lt;mon_espace_nom&gt;</var>/alert</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Vérifiez que votre conteneur est en exécution.</span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span>ps</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Liez une adresse IP publique à votre conteneur. </span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Répertoriez les adresses IP publiques disponibles dans votre espace et notez celle que vous désirez utiliser. </span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> ips</code></pre>


<div class="note tip"><span class="tiptitle">Conseil :</span> Si aucune adresse IP publique n'est disponible dans votre espace,
exécutez <samp class="ph codeph"><span class="ph"><samp class="ph codeph">bx ic</samp></span> ip-request</samp> pour réclamer une nouvelle adresse IP. Vous pouvez également annuler la liaison à un conteneur d'une adresse IP
en exécutant la commande
<samp class="ph codeph"><span class="ph"><samp class="ph codeph">bx ic</samp></span> unbind
<var class="keyword varname">&lt;ADRESSE_IP&gt;</var> <var class="keyword varname">&lt;CONTENEUR&gt;</var></samp>.</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Liez l'adresse IP publique à votre conteneur. Remplacez <var class="keyword varname">&lt;ADRESSE_IP&gt;</var> par l'adresse IP que vous avez notée à l'étape précédente. </span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> ip-bind <var class="keyword varname">&lt;ADRESSE_IP&gt;</var> alertcontainer</code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Créez une alerte de test.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Ouvrez votre navigateur Web.</span></li>
<li class="li substep substepexpand"><span class="cmd">Entrez l'adresse IP et le port dans votre navigateur comme suit :
<samp class="ph codeph"><var class="keyword varname">&lt;ADRESSE_IP&gt;</var>:8080</samp>. </span> La page d'accueil de votre application Web <span class="keyword">Alert Notification</span> s'ouvre.
<p><img src="images/alertapp.png" width="400" alt="Testez votre application Web Alert Notification"></p>
</li>
<li class="li substep substepexpand"><span class="cmd">Cliquez sur le bouton <span class="ph uicontrol">Send Sample Alert</span> pour envoyer une alerte de test à l'afficheur d'alertes.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Ouvre l'<span class="keyword wintitle">Afficheur d'alertes</span> et examinez votre alerte de test.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Dans l'interface graphique <span class="keyword">Bluemix</span>, sélectionnez votre instance de conteneur en cours d'exécution. </span></li>
<li class="li substep"><span class="cmd">Cliquez sur le service <span class="keyword">Alert Notification</span> sous <span class="ph uicontrol">Services liés</span>.</span></li>
<li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Lancer</span> pour ouvrir l'afficheur d'alertes.</span></li>
<li class="li substep"><span class="cmd">Examinez votre alerte de test. </span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Explorez les capacités du service <span class="keyword">Alert Notification</span>.</span> Consultez la documentation d'<span class="keyword">Alert Notification</span>
pour plus d'informations sur la
<a href="../services/AlertNotification/alert_configuring.html" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">création de règles de
notification</a> et la <a href="../services/AlertNotification/alert_viewer.html" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">gestion de
vos alertes</a>.</li>
</ol>
</div>
</article><article class="topic concept nested1" role="article" aria-labelledby="d58934e1206" lang="fr-fr" id="container_pipeline_ov"><h2 class="topictitle2" id="d58934e1206">Automatisation des déploiements de vos conteneurs à l'aide du <span class="keyword">Delivery Pipeline</span> dans le service <span class="keyword">Continuous Delivery</span></h2>
<div class="body conbody"><p class="shortdesc">Vous pouvez automatiser vos générations d'applications et vos déploiements de conteneurs dans <span class="keyword">Bluemix</span> à l'aide du <span class="keyword">Delivery Pipeline</span>, lequel est un élément d'<span class="keyword">IBM
Bluemix Continuous Delivery</span>.</p>
<div class="p">Le <span class="keyword">Delivery Pipeline</span> prend en charge :<ul><li>la génération d'images Docker</li>
<li>le déploiement d'images dans des conteneurs dans <span class="keyword">Bluemix</span></li>
</ul>
</div>
<div><p>Guide de démarrage rapide pour le déploiement de conteneurs à l'aide du
<span class="keyword">Delivery Pipeline</span></p>

<ol><li>Créez un référentiel Git contenant votre code.</li>
<li>Incluez un <samp class="ph codeph">Dockerfile</samp> dans le répertoire racine de votre référentiel. </li>
<li>Dans le menu, cliquez sur <span class="ph menucascade"><span class="ph uicontrol">Services</span> &gt; <span class="ph uicontrol">DevOps</span></span>, puis sur
<span class="ph uicontrol">Pipelines</span>.</li>
<li>Cliquez sur <span class="ph menucascade"><span class="ph uicontrol">Créer un pipeline</span> &gt; <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span></span>.</li>
<li>Cliquez sur <span class="ph uicontrol">Créer</span>.</li>
<li>Ajoutez votre référentiel Git à la chaîne d'outils.<ol type="a" id="container_pipeline_ov__ol_mvk_s3v_vz"><li>Cliquez sur <span class="ph uicontrol">Ajouter un outil</span>.</li>
<li>Cliquez sur le type de service Git qui héberge votre référentiel.</li>
<li>Soumettez les informations de configuration pour votre référentiel.</li>
<li>Cliquez sur <span class="ph uicontrol">Créer une intégration</span>.</li>
</ol>
</li>
<li>Dans la page Présentation de la chaîne d'outils, cliquez sur <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</li>
<li>Créez une étape de génération incluant un travail de génération.<ol type="a" id="container_pipeline_ov__ol_pds_x3v_vz"><li>Cliquez sur <span class="ph uicontrol">Ajouter une étape</span>.</li>
<li>Dans l'onglet <span class="ph uicontrol">Entrée</span>, pour <span class="ph uicontrol">Type d'entrée</span>, sélectionnez <span class="ph uicontrol">Référentiel Git</span>.</li>
<li>Dans l'onglet <span class="ph uicontrol">Travaux</span>, ajoutez un travail de génération. Pour <span class="ph uicontrol">Type de générateur</span>, sélectionnez <span class="ph uicontrol">IBM Containers on <span class="keyword">Bluemix</span></span>.</li>
</ol>
</li>
<li>Créez une étape de déploiement incluant un travail de déploiement.<ol type="a" id="container_pipeline_ov__ol_ahk_djv_vz"><li>Dans l'onglet <span class="ph uicontrol">Entrée</span>, pour <span class="ph uicontrol">Type d'entrée</span>, sélectionnez <span class="ph uicontrol">Artefacts de génération</span>.</li>
<li>Dans l'onglet <span class="ph uicontrol">Travaux</span>, pour <span class="ph uicontrol">Type de déployeur</span>, sélectionnez
<span class="ph uicontrol">IBM Container Service for Bluemix</span>.</li>
</ol>
</li>
<li>Exécutez un déploiement en envoyant une modification du code ou en cliquant sur l'icône Exécuter une étape lors de l'étape de génération du
<span class="keyword">Delivery Pipeline</span>.</li>
</ol>
</div><div>Besoin d'informations supplémentaires ? Consultez les rubriques suivantes.<ul><li><a href="container_integrations.html#container_single_pipeline_ov" title="Automatisez la construction et le déploiement de vos conteneurs uniques à l'aide de Delivery Pipeline.">Création d'un conteneur unique à l'aide de Delivery Pipeline</a></li>
<li><a href="container_integrations.html#container_group_pipeline_ov" title="Automatisez la construction et le déploiement de vos groupes de conteneurs à l'aide du Delivery Pipeline.">Création de groupes de conteneurs à l'aide du Delivery Pipeline</a></li>
</ul>
</div></div>
<article class="topic task nested2" role="article" aria-labelledby="d58934e1439" lang="fr-fr" id="container_single_pipeline_ov"><h3 class="topictitle3" id="d58934e1439">Création d'un conteneur unique à l'aide de <span class="keyword">Delivery Pipeline</span></h3>
<div class="body taskbody"><p class="shortdesc">Automatisez la construction et le déploiement de vos conteneurs uniques à l'aide de <span class="keyword">Delivery Pipeline</span>.</p>
</div>
<article class="topic task nested3" role="article" aria-labelledby="d58934e1499" lang="fr-fr" id="container_single_pipeline_build"><h4 class="topictitle4" id="d58934e1499">Création d'étapes de génération pour les conteneurs à l'aide du <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc"><span class="keyword">IBM
Bluemix Container Service</span>
inclut un service de génération qui reçoit le code source, puis génère et publie une image Docker dans le registre de conteneurs. <span class="keyword">Delivery Pipeline</span>,
lequel est un élément d'<span class="keyword">IBM
Bluemix Continuous Delivery</span>, comporte un travail de génération qui utilise le service de génération de conteneur. Ce travail de génération récupère le code source depuis un référentiel, génère une image Docker depuis ce code, versionne (étiquette) cette image pour
qu'elle corresponde au numéro de génération, puis envoie par commande push l'image générée dans le registre
<span class="keyword">IBM
Bluemix Container Service</span> de l'organisation dans <span class="keyword">Bluemix</span>. Ensuite, les membres de l'organisation peuvent déployer l'image générée dans des espaces de l'organisation.</p>
<div class="section prereq" id="container_single_pipeline_build__prereq"> <div class="p">Avant de commencer, prenez en compte les informations suivantes. <ul><li>Pour plus d'informations sur les générations, les étapes et la fonctionnalité pipeline de base, reportez-vous à la rubrique <a href="../services/ContinuousDelivery/pipeline_about.html">A propos de <span class="keyword">Delivery Pipeline</span></a> dans la documentation de <span class="keyword">Continuous Delivery</span>.</li>
<li>Identifiez une image existante du registre d'images privé de votre organisation à utiliser dans votre conteneur en consultant
le <span class="keyword wintitle">Catalogue</span> <span class="keyword">Bluemix</span>.</li>
<li>Si vous comptez lier un service au conteneur, créez une application faisant office de pont.
Pour plus d'informations, voir <a href="container_integrations.html#unique_1116937171" title="Les services ne peuvent pas être directement liés à un conteneur. Comme alternative, vous pouvez lier le service à une application, puis lier cette application au conteneur en configurant une propriété d'environnement dans une étape de pipeline. L'application sert de pont entre le service et le conteneur.">Liaison d'un service à un conteneur à l'aide du
<span class="keyword">Delivery Pipeline</span></a>.</li>
</ul>
</div>
 </div><p class="li stepsection">Construisez une image Docker depuis <span class="keyword">Delivery Pipeline</span>.</p><ol class="steps" id="container_single_pipeline_build__steps"><li class="step stepexpand"><span class="cmd">Créez un Dockerfile dans le répertoire racine du référentiel Git associé à votre chaîne d'outils et validez-le dans le référentiel.</span></li>
<li class="step stepexpand"><span class="cmd">Dans la page Présentation de la chaîne d'outils, cliquez sur <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step stepexpand"><span class="cmd">Créez une étape de génération.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une étape</span>.</span></li>
<li class="li substep"><span class="cmd">Nommez l'étape. </span> Par exemple, <samp class="ph codeph"><var class="keyword varname">Génération</var></samp>.</li>
<li class="li substep"><span class="cmd">Pour <span class="ph uicontrol">Type d'entrée</span>, sélectionnez <span class="ph uicontrol">Référentiel Git</span>.</span></li>
<li class="li substep"><span class="cmd">Vérifiez les valeurs et mettez à jour, si nécessaire, les valeurs des autres zones.</span></li>
<li class="li substep"><span class="cmd">Cliquez sur l'onglet <span class="ph uicontrol">Travaux</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Dans l'étape de génération, créez un travail de génération.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Dans l'onglet <span class="ph uicontrol">Travaux</span>, cliquez sur <span class="ph uicontrol">Ajouter un travail</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Sélectionnez le type de travail <span class="ph uicontrol">Génération</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour <span class="ph uicontrol">Type de générateur</span>, sélectionnez <span class="ph uicontrol">IBM Containers on <span class="keyword">Bluemix</span></span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Si nécessaire, mettez à jour la cible <span class="keyword">Bluemix</span>, l'organisation et l'espace. </span></li>
<li class="li substep substepexpand"><span class="cmd">Pour l'option <span class="ph uicontrol">Utiliser les couches de cache</span>, désélectionnez la zone contraignant une réactualisation des couches extrayant dynamiquement un contenu d'autres sources. </span> <p>Par exemple, si le fichier <samp class="ph codeph">Dockerfile</samp> inclut une commande <samp class="ph codeph">apt-get install</samp> ou <samp class="ph codeph">wget</samp>,
assurez-vous que ces dépendances dynamiques sont regroupées dans chaque génération en désélectionnant la case à cocher <span class="ph uicontrol">Utiliser les couches de cache</span>. </p>
 <div class="steps note"><span class="notetitle">Remarque :</span> Lorsque l'option <span class="ph uicontrol">Utiliser les couches de cache</span> est désélectionnée, les temps de génération sont plus longs vu que les couches de cache
ne sont pas utilisées lors de la construction de l'image.</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom de l'image</span>, entrez un nom pour l'image à générer. Pour respecter les conventions de dénomination Docker, utilisez
uniquement des lettres en minuscules, des chiffres et des traits d'union (-). </span> Lorsque l'image est générée,
elle est étiquetée avec un nom d'image et un numéro de génération.  Par exemple, si vous entrez le nom d'image <samp class="ph codeph">monimageapp</samp>, l'image générée pour le numéro de génération 4 s'appelle
<samp class="ph codeph">monimageapp:4</samp>. </li>
<li class="li substep substepexpand"><span class="cmd">Si votre fichier Dockerfile ne se trouve pas dans le répertoire principal du projet, dans la section Build Script,
ajoutez le chemin du fichier Dockerfile aux emplacements suivants.</span> <ol type="i"><li>Avant la section Run unit tests, ajoutez le nom du dossier avec une commande de changement de répertoire.<div class="p"><pre class="codeblock"><code>cd <var class="keyword varname">&lt;folder&gt;</var></code></pre>
</div>
</li>
<li>Lorsque la variable <var class="keyword varname">${WORKSPACE}</var> s'affiche, ajoutez le nom du dossier. La variable
<var class="keyword varname">${WORKSPACE}</var> détecte automatiquement le répertoire principal du projet pour vous.<div class="p">Exemple<pre class="codeblock"><code>BUILD_COMMAND="build --pull --tag ${FULL_REPOSITORY_NAME} ${WORKSPACE}/<var class="keyword varname">&lt;folder&gt;</var>"</code></pre>
</div>
</li>
</ol>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Cliquez sur l'icône <span class="ph uicontrol">Exécuter étape</span> pour vérifier que l'étape peut être construite sans erreurs.</span> Si la génération échoue, examinez les journaux et corrigez les erreurs. Si l'étape réussit, examinez le registre d'images de votre organisation et vérifiez que l'image a été générée.</li>
</ol>
</div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58934e1799" lang="fr-fr" id="container_pipeline_vulnerability"><h4 class="topictitle4" id="d58934e1799">(Facultatif) Vérification de la sécurité de l'image dans le cadre du pipeline</h4>
<div class="body taskbody"><div class="abstract"><span class="shortdesc">Identifiez des problèmes de sécurité ou de configuration à l'aide de Vulnerability Advisor avant que le conteneur ne soit déployé.</span>
</div>
<div class="section context"><div class="p">Configuration de pipeline courante incluant cet examen :<ul><li>Etape de génération pour générer les fichiers source</li>
<li>Etape de traitement, qui inclut les travaux suivants : <ul><li>Un travail de génération exécutant une génération de conteneur</li>
<li>Un travail de test exécutant Vulnerability Advisor sur une image</li>
</ul>
</li>
<li>Etape de déploiement pour déployer le conteneur</li>
</ul>
</div>

<div class="note tip"><span class="tiptitle">Conseil :</span> Cette tâche décrit comment créer un travail de test pour Vulnerability Advisor dans une étape différente que celle de construction de l'image du
conteneur. Vous pouvez également utiliser la même étape. Si vous choisissez de créer une étape distincte, vous n'avez pas besoin de définir la variable d'environnement. </div>
</div><p class="li stepsection">Créez l'analyse Vulnerability Advisor.</p><ol class="steps" id="container_pipeline_vulnerability__steps"><li class="step stepexpand"><span class="cmd">Créez une étape de traitement.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une étape</span>.</span></li>
<li class="li substep"><span class="cmd">Nommez l'étape. </span> Par exemple, <samp class="ph codeph"><var class="keyword varname">Traitement</var></samp>. </li>
<li class="li substep"><span class="cmd">Pour le type d'entrée, sélectionnez <span class="ph uicontrol">Artefacts de génération</span>.</span></li>
<li class="li substep"><span class="cmd">Pour l'étape et le travail, vérifiez les valeurs et mettez-les à jour, si nécessaire.</span></li>
<li class="li substep"><span class="cmd">Cliquez sur l'onglet <span class="ph uicontrol">Travaux</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Dans l'étape de traitement, ajoutez un travail de test pour exécuter l'examen du code.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Dans l'onglet <span class="ph uicontrol">Travaux</span>, cliquez sur <span class="ph uicontrol">Ajouter un travail</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour le type de travail, sélectionnez <span class="ph uicontrol">Tester</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Dans la zone <span class="ph uicontrol">Type de testeur</span>, sélectionnez <span class="ph uicontrol">IBM Vulnerability
Advisor</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Si nécessaire, mettez à jour la cible <span class="keyword">Bluemix</span>, l'organisation et l'espace. </span></li>
<li class="li substep substepexpand"><span class="cmd">Dans la zone <span class="ph uicontrol">Temps d'attente (en minutes) avant la fin de l'analyse (0 - 59)</span>, entrez une valeur comprise entre 0 et 59 minutes.</span> La valeur par défaut est <var class="keyword varname">5</var> minutes. Une adresse URL d'accès au tableau de bord est fournie dans les
journaux de la console à la fin du travail. 
<p>Si l'examen n'est pas terminé au bout de ce délai, le travail échoue, mais l'analyse d'examen continue de s'exécuter et peut être affichée
dans le tableau de bord. Une fois l'examen terminé, si vous réexécutez le travail,
la demande d'examen n'est pas soumise à nouveau et le travail du pipeline peut aboutir. Vous pouvez aussi configurer le pipeline de sorte qu'il ne soit pas bloqué si
l'examen aboutit, comme décrit à l'étape suivante. </p>
</li>
<li class="li substep substepexpand"><span class="cmd">Pour déterminer le comportement à suivre à l'expiration du délai imparti, désélectionnez l'option
<span class="ph uicontrol">Arrêter d'exécuter cette étape si ce travail échoue</span>.</span> <p>Vous pouvez configurer le travail pour qu'il bloque les travaux ultérieurs dans l'étape ainsi que l'exécution des étapes ultérieures si ce travail
échoue, ou vous pouvez configurer l'étape pour qu'elle continue sans bloquer les travaux et les étapes ultérieures.
Le statut du travail est déterminé par la présence éventuelle de problèmes de sécurité critiques. </p>


<p>La présence de problèmes de sécurité critiques entraîne l'échec du travail. Selon que vous avez sélectionné ou non l'option <span class="ph uicontrol">Arrêter d'exécuter cette
étape si ce travail échoue</span>, l'échec du travail entraîne l'arrêt de l'étape et de la progression dans le pipeline, ou bien leur permet de continuer. Si vous savez que le rapport inclut de nombreux problèmes devant être traités, vous pouvez configurer l'étape pour qu'elle continue de s'exécuter car
l'examen peut durer longtemps. Dans ce cas, il n'est pas souhaitable que le reste de vos travaux et de vos étapes s'arrêtent uniquement parce que l'examen
dure trop longtemps.</p>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Si le travail relève de la même étape que le travail de génération, définissez une variable d'environnement pour le nom de référentiel.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Cliquez sur l'onglet <span class="ph uicontrol">ENVIRONMENT PROPERTIES</span>.</span></li>
<li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une propriété</span> et sélectionnez <span class="ph uicontrol">Propriété de texte</span>.</span></li>
<li class="li substep"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom</span>, entrez <samp class="ph codeph">Nom_complet_référentiel</samp></span></li>
<li class="li substep"><span class="cmd">Laissez vide la zone <span class="ph uicontrol">Valeur</span>.</span> Le nom d'image spécifié dans le travail de construction du conteneur est transmis via cette variable d'environnement.</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Cliquez sur l'icône <span class="ph uicontrol">Exécuter étape</span> pour vérifier que l'étape peut être construite sans erreurs.</span></li>
</ol>
<div class="section result"><div class="p">Pour afficher les résultats d'un examen Vulnerability Advisor, une fois le travail terminé, cliquez sur <span class="ph uicontrol">View results and history</span>. Dans l'onglet <span class="ph uicontrol">Journaux</span>, recherchez la section suivante :<pre class="pre msgblock"><code>image registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">espace_nom</var>/<var class="keyword varname">image</var> résulats de vulnérabilité détectés</code></pre>
</div>

<p>Une liste des packages vulnérables, des problèmes de sécurité et des améliorations suggérées est affichée, comme décrit dans la rubrique de
Vulnerability Advisor <a href="va/va_index.html#va_reviewing">Examen des vulnérabilités
d'une image</a>. Le code Dockerfile pour résolution de certains problèmes courants est
disponible sur la page
<a href="va/va_index.html#va_report">Résolution des
vulnérabilités dans les images</a>.</p>
</div></div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58934e2077" lang="fr-fr" id="container_pipeline_cleanup"><h4 class="topictitle4" id="d58934e2077">(Facultatif) Nettoyage d'images à l'aide du <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">Le travail de génération du service <span class="keyword">IBM
Bluemix Container Service</span> nettoie automatiquement les images
inutilisées. Les images qui sont utilisées ne sont pas supprimées. Vous pouvez spécifier le nombre de versions d'image à conserver ou désactiver le
nettoyage de l'image.</p>
<p class="li stepsection">Pour modifier le nombre de versions d'image à conserver pour un projet, procédez comme suit :</p><ol class="steps"><li class="step"><span class="cmd">Dans le pipeline, ouvrez la configuration pour l'étape de génération.</span></li>
<li class="step"><span class="cmd">Dans l'onglet <span class="ph uicontrol">Propriétés d'environnement</span>, cliquez sur <span class="ph uicontrol">Ajouter une propriété</span>.</span></li>
<li class="step"><span class="cmd">Sélectionnez <span class="ph uicontrol">Propriété de texte</span>.</span></li>
<li class="step"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom</span>, entrez la commande <samp class="ph codeph">IMAGE_LIMIT</samp>.</span></li>
<li class="step"><span class="cmd">Dans la zone <span class="ph uicontrol">Valeur</span>, entrez le nombre de versions d'image à conserver pour ce projet dans le registre. Par défaut, les cinq images les
plus récentes du projet sont conservées. Pour désactiver le nettoyage des
images et conserver toutes leurs versions, affectez à ce paramètre la valeur <samp class="ph codeph">-1</samp>.</span></li>
<li class="step"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
</ol>
</div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58934e2212" lang="fr-fr" id="container_binding_pipeline"><h4 class="topictitle4" id="d58934e2212">(Facultatif) Liaison d'un service à un conteneur à l'aide du <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">Les services ne peuvent pas être directement liés à un conteneur. Comme alternative, vous pouvez lier le
service à une application, puis lier cette application au conteneur en configurant une propriété d'environnement dans une étape de pipeline. L'application sert de pont entre le
service et le conteneur.</p>
<div class="section prereq"><p id="container_binding_pipeline__context"><span class="keyword">Bluemix</span> fournit un ensemble de variables d'environnement qui
définissent les noms et les détails des services liés à une application, par exemple la base de données ClearDB MySQL ou Question and Answer. Ces variables d'environnement sont appelées <samp class="ph codeph">VCAP_SERVICES</samp>. Lorsqu'un conteneur est lié à un service, les variables <samp class="ph codeph">VCAP_SERVICES</samp> sont transmises au conteneur sous forme de variables d'environnement
via une application qui sert de pont entre le conteneur et le service. Le conteneur peut ensuite rechercher des informations dans le service, comme le
noeud final, l'utilisateur et le mot de passe.</p>

<p>Avant de configurer la propriété d'environnement, identifiez une application existante à laquelle sont déjà liés des
services ou créez une application à l'aide de l'interface graphique <span class="keyword">Bluemix</span> ou de la ligne de commande. Pour plus d'informations, voir
<a href="container_troubleshoot.html#ts_bridge_app">Le service Bluemix ne peut pas être lié directement à un conteneur</a>.</p>
</div><p class="li stepsection">Liez l'application pont au conteneur.</p><ol class="steps"><li class="step"><span class="cmd">Dans la page de présentation de la chaîne d'outils, cliquez sur <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step"><span class="cmd">Ouvrez une étape de pipeline et cliquez sur l'onglet <span class="ph uicontrol">Propriétés d'environnement</span>.</span></li>
<li class="step"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une propriété</span> et sélectionnez <span class="ph uicontrol">Propriété de texte</span>.</span></li>
<li class="step"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom</span>, entrez la commande
<kbd class="ph userinput">BIND_TO</kbd>.</span></li>
<li class="step"><span class="cmd">Dans la zone <span class="ph uicontrol">Valeur</span>, entrez le nom de l'application pont (par exemple,
<var class="keyword varname">application_pont_pipeline</var>).</span></li>
<li class="step"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
<li class="step"><span class="cmd">Testez la configuration en exécutant votre pipeline.</span></li>
</ol>
<div class="section postreq"><div class="note tip"><span class="tiptitle">Conseil :</span> Une fois que l'application pont a été liée à un conteneur, ne la supprimez pas. Si vous la
supprimez, le conteneur se bloque. Supprimez le conteneur et tous les autres conteneurs utilisant l'application pont avant de la supprimer.</div>
</div></div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58934e2371" lang="fr-fr" id="container_single_pipeline_deploy"><h4 class="topictitle4" id="d58934e2371">Création d'étapes de déploiement pour les conteneurs à l'aide du <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">Vous pouvez créer une étape de déploiement pour votre conteneur avec <span class="keyword">Delivery Pipeline</span>.</p>
<div class="section prereq"><div class="p">Avant de commencer :<ul><li><a href="container_integrations.html#container_single_pipeline_build" title="IBM Bluemix Container Service inclut un service de génération qui reçoit le code source, puis génère et publie une image Docker dans le registre de conteneurs. Delivery Pipeline, lequel est un élément d'IBM Bluemix Continuous Delivery, comporte un travail de génération qui utilise le service de génération de conteneur. Ce travail de génération récupère le code source depuis un référentiel, génère une image Docker depuis ce code, versionne (étiquette) cette image pour qu'elle corresponde au numéro de génération, puis envoie par commande push l'image générée dans le registre IBM Bluemix Container Service de l'organisation dans Bluemix. Ensuite, les membres de l'organisation peuvent déployer l'image générée dans des espaces de l'organisation.">Créez une étape de génération</a>.</li>
<li><a href="https://github.com/Osthanes/deployscripts/blob/master/deploycontainer.sh" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">Passez en revue le script de déploiement par défaut pour les conteneurs uniques</a>.
Vous pouvez dévier le scrit par défaut et l'éditer ou créez votre propre script à la place.</li>
<li><a href="../services/ContinuousDelivery/pipeline_deploy_var.html">Examinez la liste des variables d'environnement disponibles fournies par le service <span class="keyword">Delivery Pipeline</span></a>.</li>
</ul>
</div>
</div><ol class="steps"><li class="step stepexpand"><span class="cmd">Dans la page Présentation de la chaîne d'outils, cliquez sur <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step stepexpand" id="container_single_pipeline_deploy__deploy_stage"><span class="cmd">Créez une étape de déploiement.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une étape</span>.</span></li>
<li class="li substep"><span class="cmd">Nommez l'étape. </span> Par exemple, <samp class="ph codeph"><var class="keyword varname">Déploiement</var></samp>.</li>
<li class="li substep"><span class="cmd">Pour le type d'entrée, sélectionnez <span class="ph uicontrol">Artefacts de génération</span>.</span></li>
</ol>
</li>
<li class="step stepexpand" id="container_single_pipeline_deploy__deployment_job"><span class="cmd">Dans l'étape, créez un travail de déploiement.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Dans l'onglet <span class="ph uicontrol">Travaux</span>, cliquez sur <span class="ph uicontrol">Ajouter un travail</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour le type de travail, sélectionnez <span class="ph uicontrol">Déployer</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour le type de déployeur, sélectionnez <span class="ph uicontrol">IBM Container Service on <span class="keyword">Bluemix</span></span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour l'organisation et l'espace, vérifiez les valeurs et mettez-les à jour, si nécessaire.</span></li>
<li class="li substep substepexpand"><span class="cmd">Dans la zone <span class="ph uicontrol">Stratégie de déploiement</span>, entrez l'une des valeurs suivantes.</span> <ul><li><span class="ph uicontrol">red_black</span> - Déploie une nouvelle version de l'application. Si le déploiement aboutit, le déploiement précédent de l'application
est supprimé et l'adresse IP ou la route est mappée à la nouvelle version.</li>
<li><span class="ph uicontrol">clean</span> - Supprime tous les déploiements antérieurs de l'application. </li>
</ul>
 <div class="note tip"><span class="tiptitle">Conseil :</span> La propriété d'environnement
<samp class="ph codeph">CONCURRENT_VERSIONS</samp> définit le nombre de versions des déploiements d'application qui doivent rester actives. La valeur par défaut est une version. Par exemple, si <samp class="ph codeph">CONCURRENT_VERSIONS</samp> a pour valeur 2 et que vous utilisez une adresse IP, le
déploiement le plus récent est lié à l'adresse IP, mais la version précédente reste déployée comme version de secours. 
<p>Pour supprimer systématiquement tous les déploiements de l'application, dans l'onglet <span class="ph uicontrol">Propriétés d'environnement</span>, vous pouvez
associer <samp class="ph codeph">CONCURRENT_VERSIONS</samp> à la valeur <samp class="ph codeph">0</samp>.</p>
</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom</span>, entrez le nom du conteneur à déployer.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour le port, entrez le port publié pour le conteneur.</span> Séparez plusieurs ports par une virgule (,).
<div class="note tip" id="container_single_pipeline_deploy__private_container"><span class="tiptitle">Conseil :</span> Si aucun port n'est spécifié et que vous utilisez le script de déploiement par défaut, le port 80 est automatiquement publié. Pour rendre un contenu privé avec le script de déploiement par défaut, procédez comme indiqué ci-après.
<ol type="i"><li>Pour la stratégie de déploiement, entrez <kbd class="ph userinput">simple</kbd>.</li>
<li> Laissez la zone <span class="ph uicontrol">Port</span> non renseignée.</li>
<li>Etant donné que les déploiements simples ne nettoient pas les déploiements précédents, vous pouvez créer une autre étape de déploiement pour les nettoyer. Affectez la valeur <kbd class="ph userinput">clean</kbd> à la <span class="ph uicontrol">stratégie de déploiement</span> dans la deuxième étape de déploiement.</li>
</ol>
</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Le cas échéant, entrez des arguments de déploiement facultatifs.</span> Par exemple, si votre application requiert une variable d'environnement pour l'emplacement de votre base de données dorsale,  vous pourriez inclure la ligne suivante :

<pre class="codeblock"><code>--env MY_DB_HOSTNAME_PROPERTY=<var class="keyword varname">mon_nom_hôte_bd</var></code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Si vous avez créé votre propre script de déploiement, ouvrez la section <span class="ph uicontrol">Script de déployeur</span> pour l'utiliser.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Copiez la ligne suivante et mettez-la à jour pour utiliser votre référentiel.</span> <pre class="pre screen"><code>git_retry clone https://github.com/Osthanes/deployscripts.git deployscripts</code></pre>
</li>
<li class="li substep substepexpand"><span class="cmd">Editez la ligne suivante pour utiliser votre script.</span> <pre class="pre screen"><code>/bin/bash deployscripts/deploycontainer.sh</code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
</ol>
</div>
</article></article><article class="topic task nested2" role="article" aria-labelledby="d58934e2647" lang="fr-fr" id="container_group_pipeline_ov"><h3 class="topictitle3" id="d58934e2647">Création de groupes de conteneurs à l'aide du <span class="keyword">Delivery Pipeline</span></h3>
<div class="body taskbody"><p class="shortdesc">Automatisez la construction et le déploiement de vos groupes de conteneurs à l'aide du
<span class="keyword">Delivery Pipeline</span>.</p>
</div>
<article class="topic task nested3" role="article" aria-labelledby="d58934e2713" lang="fr-fr" id="container_group_pipeline_build"><h4 class="topictitle4" id="d58934e2713">Création d'étapes de génération pour les groupes de conteneurs à l'aide du <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc"><span class="keyword">IBM
Bluemix Container Service</span>
inclut un service de génération qui reçoit le code source, puis génère et publie une image Docker dans le registre de conteneurs. <span class="keyword">Delivery Pipeline</span>,
lequel est un élément d'<span class="keyword">IBM
Bluemix Continuous Delivery</span>, comporte un travail de génération qui utilise le service de génération de conteneur. Ce travail de génération récupère le code source depuis un référentiel, génère une image Docker depuis ce code, versionne (étiquette) cette image pour
qu'elle corresponde au numéro de génération, puis envoie par commande push l'image générée dans le registre
<span class="keyword">IBM
Bluemix Container Service</span> de l'organisation dans <span class="keyword">Bluemix</span>. Ensuite, les membres de l'organisation peuvent déployer l'image générée dans des espaces de l'organisation.</p>
<div class="section prereq"> <div class="p">Avant de commencer, prenez en compte les informations suivantes. <ul><li>Pour plus d'informations sur les générations, les étapes et la fonctionnalité pipeline de base, reportez-vous à la rubrique <a href="../services/ContinuousDelivery/pipeline_about.html">A propos de <span class="keyword">Delivery Pipeline</span></a> dans la documentation de <span class="keyword">Continuous Delivery</span>.</li>
<li>Identifiez une image existante du registre d'images privé de votre organisation à utiliser dans votre conteneur en consultant
le <span class="keyword wintitle">Catalogue</span> <span class="keyword">Bluemix</span>.</li>
<li>Si vous comptez lier un service au conteneur, créez une application faisant office de pont.
Pour plus d'informations, voir <a href="container_integrations.html#unique_1116937171" title="Les services ne peuvent pas être directement liés à un conteneur. Comme alternative, vous pouvez lier le service à une application, puis lier cette application au conteneur en configurant une propriété d'environnement dans une étape de pipeline. L'application sert de pont entre le service et le conteneur.">Liaison d'un service à un conteneur à l'aide du
<span class="keyword">Delivery Pipeline</span></a>.</li>
</ul>
</div>
 </div><p class="li stepsection">Construisez une image Docker depuis <span class="keyword">Delivery Pipeline</span>.</p><ol class="steps"><li class="step stepexpand"><span class="cmd">Créez un Dockerfile dans le répertoire racine du référentiel Git associé à votre chaîne d'outils et validez-le dans le référentiel.</span></li>
<li class="step stepexpand"><span class="cmd">Dans la page Présentation de la chaîne d'outils, cliquez sur <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step stepexpand"><span class="cmd">Créez une étape de génération.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une étape</span>.</span></li>
<li class="li substep"><span class="cmd">Nommez l'étape. </span> Par exemple, <samp class="ph codeph"><var class="keyword varname">Génération</var></samp>.</li>
<li class="li substep"><span class="cmd">Pour <span class="ph uicontrol">Type d'entrée</span>, sélectionnez <span class="ph uicontrol">Référentiel Git</span>.</span></li>
<li class="li substep"><span class="cmd">Vérifiez les valeurs et mettez à jour, si nécessaire, les valeurs des autres zones.</span></li>
<li class="li substep"><span class="cmd">Cliquez sur l'onglet <span class="ph uicontrol">Travaux</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Dans l'étape de génération, créez un travail de génération.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Dans l'onglet <span class="ph uicontrol">Travaux</span>, cliquez sur <span class="ph uicontrol">Ajouter un travail</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Sélectionnez le type de travail <span class="ph uicontrol">Génération</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour <span class="ph uicontrol">Type de générateur</span>, sélectionnez <span class="ph uicontrol">IBM Containers on <span class="keyword">Bluemix</span></span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Si nécessaire, mettez à jour la cible <span class="keyword">Bluemix</span>, l'organisation et l'espace. </span></li>
<li class="li substep substepexpand"><span class="cmd">Pour l'option <span class="ph uicontrol">Utiliser les couches de cache</span>, désélectionnez la zone contraignant une réactualisation des couches extrayant dynamiquement un contenu d'autres sources. </span> <p>Par exemple, si le fichier <samp class="ph codeph">Dockerfile</samp> inclut une commande <samp class="ph codeph">apt-get install</samp> ou <samp class="ph codeph">wget</samp>,
assurez-vous que ces dépendances dynamiques sont regroupées dans chaque génération en désélectionnant la case à cocher <span class="ph uicontrol">Utiliser les couches de cache</span>. </p>
 <div class="steps note"><span class="notetitle">Remarque :</span> Lorsque l'option <span class="ph uicontrol">Utiliser les couches de cache</span> est désélectionnée, les temps de génération sont plus longs vu que les couches de cache
ne sont pas utilisées lors de la construction de l'image.</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom de l'image</span>, entrez un nom pour l'image à générer. Pour respecter les conventions de dénomination Docker, utilisez
uniquement des lettres en minuscules, des chiffres et des traits d'union (-). </span> Lorsque l'image est générée,
elle est étiquetée avec un nom d'image et un numéro de génération.  Par exemple, si vous entrez le nom d'image <samp class="ph codeph">monimageapp</samp>, l'image générée pour le numéro de génération 4 s'appelle
<samp class="ph codeph">monimageapp:4</samp>. </li>
<li class="li substep substepexpand"><span class="cmd">Si votre fichier Dockerfile ne se trouve pas dans le répertoire principal du projet, dans la section Build Script,
ajoutez le chemin du fichier Dockerfile aux emplacements suivants.</span> <ol type="i"><li>Avant la section Run unit tests, ajoutez le nom du dossier avec une commande de changement de répertoire.<div class="p"><pre class="codeblock"><code>cd <var class="keyword varname">&lt;folder&gt;</var></code></pre>
</div>
</li>
<li>Lorsque la variable <var class="keyword varname">${WORKSPACE}</var> s'affiche, ajoutez le nom du dossier. La variable
<var class="keyword varname">${WORKSPACE}</var> détecte automatiquement le répertoire principal du projet pour vous.<div class="p">Exemple<pre class="codeblock"><code>BUILD_COMMAND="build --pull --tag ${FULL_REPOSITORY_NAME} ${WORKSPACE}/<var class="keyword varname">&lt;folder&gt;</var>"</code></pre>
</div>
</li>
</ol>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Cliquez sur l'icône <span class="ph uicontrol">Exécuter étape</span> pour vérifier que l'étape peut être construite sans erreurs.</span> Si la génération échoue, examinez les journaux et corrigez les erreurs. Si l'étape réussit, examinez le registre d'images de votre organisation et vérifiez que l'image a été générée.</li>
</ol>
</div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58934e3017" lang="fr-fr" id="unique_392824845"><h4 class="topictitle4" id="d58934e3017">(Facultatif) Vérification de la sécurité de l'image dans le cadre du pipeline</h4>
<div class="body taskbody"><div class="abstract"><span class="shortdesc">Identifiez des problèmes de sécurité ou de configuration à l'aide de Vulnerability Advisor avant que le conteneur ne soit déployé.</span>
</div>
<div class="section context"><div class="p">Configuration de pipeline courante incluant cet examen :<ul><li>Etape de génération pour générer les fichiers source</li>
<li>Etape de traitement, qui inclut les travaux suivants : <ul><li>Un travail de génération exécutant une génération de conteneur</li>
<li>Un travail de test exécutant Vulnerability Advisor sur une image</li>
</ul>
</li>
<li>Etape de déploiement pour déployer le conteneur</li>
</ul>
</div>

<div class="note tip"><span class="tiptitle">Conseil :</span> Cette tâche décrit comment créer un travail de test pour Vulnerability Advisor dans une étape différente que celle de construction de l'image du
conteneur. Vous pouvez également utiliser la même étape. Si vous choisissez de créer une étape distincte, vous n'avez pas besoin de définir la variable d'environnement. </div>
</div><p class="li stepsection">Créez l'analyse Vulnerability Advisor.</p><ol class="steps" id="unique_392824845__steps"><li class="step stepexpand"><span class="cmd">Créez une étape de traitement.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une étape</span>.</span></li>
<li class="li substep"><span class="cmd">Nommez l'étape. </span> Par exemple, <samp class="ph codeph"><var class="keyword varname">Traitement</var></samp>. </li>
<li class="li substep"><span class="cmd">Pour le type d'entrée, sélectionnez <span class="ph uicontrol">Artefacts de génération</span>.</span></li>
<li class="li substep"><span class="cmd">Pour l'étape et le travail, vérifiez les valeurs et mettez-les à jour, si nécessaire.</span></li>
<li class="li substep"><span class="cmd">Cliquez sur l'onglet <span class="ph uicontrol">Travaux</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Dans l'étape de traitement, ajoutez un travail de test pour exécuter l'examen du code.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Dans l'onglet <span class="ph uicontrol">Travaux</span>, cliquez sur <span class="ph uicontrol">Ajouter un travail</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour le type de travail, sélectionnez <span class="ph uicontrol">Tester</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Dans la zone <span class="ph uicontrol">Type de testeur</span>, sélectionnez <span class="ph uicontrol">IBM Vulnerability
Advisor</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Si nécessaire, mettez à jour la cible <span class="keyword">Bluemix</span>, l'organisation et l'espace. </span></li>
<li class="li substep substepexpand"><span class="cmd">Dans la zone <span class="ph uicontrol">Temps d'attente (en minutes) avant la fin de l'analyse (0 - 59)</span>, entrez une valeur comprise entre 0 et 59 minutes.</span> La valeur par défaut est <var class="keyword varname">5</var> minutes. Une adresse URL d'accès au tableau de bord est fournie dans les
journaux de la console à la fin du travail. 
<p>Si l'examen n'est pas terminé au bout de ce délai, le travail échoue, mais l'analyse d'examen continue de s'exécuter et peut être affichée
dans le tableau de bord. Une fois l'examen terminé, si vous réexécutez le travail,
la demande d'examen n'est pas soumise à nouveau et le travail du pipeline peut aboutir. Vous pouvez aussi configurer le pipeline de sorte qu'il ne soit pas bloqué si
l'examen aboutit, comme décrit à l'étape suivante. </p>
</li>
<li class="li substep substepexpand"><span class="cmd">Pour déterminer le comportement à suivre à l'expiration du délai imparti, désélectionnez l'option
<span class="ph uicontrol">Arrêter d'exécuter cette étape si ce travail échoue</span>.</span> <p>Vous pouvez configurer le travail pour qu'il bloque les travaux ultérieurs dans l'étape ainsi que l'exécution des étapes ultérieures si ce travail
échoue, ou vous pouvez configurer l'étape pour qu'elle continue sans bloquer les travaux et les étapes ultérieures.
Le statut du travail est déterminé par la présence éventuelle de problèmes de sécurité critiques. </p>


<p>La présence de problèmes de sécurité critiques entraîne l'échec du travail. Selon que vous avez sélectionné ou non l'option <span class="ph uicontrol">Arrêter d'exécuter cette
étape si ce travail échoue</span>, l'échec du travail entraîne l'arrêt de l'étape et de la progression dans le pipeline, ou bien leur permet de continuer. Si vous savez que le rapport inclut de nombreux problèmes devant être traités, vous pouvez configurer l'étape pour qu'elle continue de s'exécuter car
l'examen peut durer longtemps. Dans ce cas, il n'est pas souhaitable que le reste de vos travaux et de vos étapes s'arrêtent uniquement parce que l'examen
dure trop longtemps.</p>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Si le travail relève de la même étape que le travail de génération, définissez une variable d'environnement pour le nom de référentiel.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Cliquez sur l'onglet <span class="ph uicontrol">ENVIRONMENT PROPERTIES</span>.</span></li>
<li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une propriété</span> et sélectionnez <span class="ph uicontrol">Propriété de texte</span>.</span></li>
<li class="li substep"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom</span>, entrez <samp class="ph codeph">Nom_complet_référentiel</samp></span></li>
<li class="li substep"><span class="cmd">Laissez vide la zone <span class="ph uicontrol">Valeur</span>.</span> Le nom d'image spécifié dans le travail de construction du conteneur est transmis via cette variable d'environnement.</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Cliquez sur l'icône <span class="ph uicontrol">Exécuter étape</span> pour vérifier que l'étape peut être construite sans erreurs.</span></li>
</ol>
<div class="section result"><div class="p">Pour afficher les résultats d'un examen Vulnerability Advisor, une fois le travail terminé, cliquez sur <span class="ph uicontrol">View results and history</span>. Dans l'onglet <span class="ph uicontrol">Journaux</span>, recherchez la section suivante :<pre class="pre msgblock"><code>image registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">espace_nom</var>/<var class="keyword varname">image</var> résulats de vulnérabilité détectés</code></pre>
</div>

<p>Une liste des packages vulnérables, des problèmes de sécurité et des améliorations suggérées est affichée, comme décrit dans la rubrique de
Vulnerability Advisor <a href="va/va_index.html#va_reviewing">Examen des vulnérabilités
d'une image</a>. Le code Dockerfile pour résolution de certains problèmes courants est
disponible sur la page
<a href="va/va_index.html#va_report">Résolution des
vulnérabilités dans les images</a>.</p>
</div></div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58934e3295" lang="fr-fr" id="unique_471591791"><h4 class="topictitle4" id="d58934e3295">(Facultatif) Nettoyage d'images à l'aide du <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">Le travail de génération du service <span class="keyword">IBM
Bluemix Container Service</span> nettoie automatiquement les images
inutilisées. Les images qui sont utilisées ne sont pas supprimées. Vous pouvez spécifier le nombre de versions d'image à conserver ou désactiver le
nettoyage de l'image.</p>
<p class="li stepsection">Pour modifier le nombre de versions d'image à conserver pour un projet, procédez comme suit :</p><ol class="steps"><li class="step"><span class="cmd">Dans le pipeline, ouvrez la configuration pour l'étape de génération.</span></li>
<li class="step"><span class="cmd">Dans l'onglet <span class="ph uicontrol">Propriétés d'environnement</span>, cliquez sur <span class="ph uicontrol">Ajouter une propriété</span>.</span></li>
<li class="step"><span class="cmd">Sélectionnez <span class="ph uicontrol">Propriété de texte</span>.</span></li>
<li class="step"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom</span>, entrez la commande <samp class="ph codeph">IMAGE_LIMIT</samp>.</span></li>
<li class="step"><span class="cmd">Dans la zone <span class="ph uicontrol">Valeur</span>, entrez le nombre de versions d'image à conserver pour ce projet dans le registre. Par défaut, les cinq images les
plus récentes du projet sont conservées. Pour désactiver le nettoyage des
images et conserver toutes leurs versions, affectez à ce paramètre la valeur <samp class="ph codeph">-1</samp>.</span></li>
<li class="step"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
</ol>
</div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58934e3430" lang="fr-fr" id="unique_1116937171"><h4 class="topictitle4" id="d58934e3430">(Facultatif) Liaison d'un service à un conteneur à l'aide du <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">Les services ne peuvent pas être directement liés à un conteneur. Comme alternative, vous pouvez lier le
service à une application, puis lier cette application au conteneur en configurant une propriété d'environnement dans une étape de pipeline. L'application sert de pont entre le
service et le conteneur.</p>
<div class="section prereq"><p id="unique_1116937171__context"><span class="keyword">Bluemix</span> fournit un ensemble de variables d'environnement qui
définissent les noms et les détails des services liés à une application, par exemple la base de données ClearDB MySQL ou Question and Answer. Ces variables d'environnement sont appelées <samp class="ph codeph">VCAP_SERVICES</samp>. Lorsqu'un conteneur est lié à un service, les variables <samp class="ph codeph">VCAP_SERVICES</samp> sont transmises au conteneur sous forme de variables d'environnement
via une application qui sert de pont entre le conteneur et le service. Le conteneur peut ensuite rechercher des informations dans le service, comme le
noeud final, l'utilisateur et le mot de passe.</p>

<p>Avant de configurer la propriété d'environnement, identifiez une application existante à laquelle sont déjà liés des
services ou créez une application à l'aide de l'interface graphique <span class="keyword">Bluemix</span> ou de la ligne de commande. Pour plus d'informations, voir
<a href="container_troubleshoot.html#ts_bridge_app">Le service Bluemix ne peut pas être lié directement à un conteneur</a>.</p>
</div><p class="li stepsection">Liez l'application pont au conteneur.</p><ol class="steps"><li class="step"><span class="cmd">Dans la page de présentation de la chaîne d'outils, cliquez sur <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step"><span class="cmd">Ouvrez une étape de pipeline et cliquez sur l'onglet <span class="ph uicontrol">Propriétés d'environnement</span>.</span></li>
<li class="step"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une propriété</span> et sélectionnez <span class="ph uicontrol">Propriété de texte</span>.</span></li>
<li class="step"><span class="cmd">Dans la zone <span class="ph uicontrol">Nom</span>, entrez la commande
<kbd class="ph userinput">BIND_TO</kbd>.</span></li>
<li class="step"><span class="cmd">Dans la zone <span class="ph uicontrol">Valeur</span>, entrez le nom de l'application pont (par exemple,
<var class="keyword varname">application_pont_pipeline</var>).</span></li>
<li class="step"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
<li class="step"><span class="cmd">Testez la configuration en exécutant votre pipeline.</span></li>
</ol>
<div class="section postreq"><div class="note tip"><span class="tiptitle">Conseil :</span> Une fois que l'application pont a été liée à un conteneur, ne la supprimez pas. Si vous la
supprimez, le conteneur se bloque. Supprimez le conteneur et tous les autres conteneurs utilisant l'application pont avant de la supprimer.</div>
</div></div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58934e3589" lang="fr-fr" id="container_group_pipeline_deploy"><h4 class="topictitle4" id="d58934e3589">Création d'étapes de déploiement pour les groupes de conteneurs à l'aide du <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">Vous pouvez créer une étape de déploiement pour votre groupe de conteneurs à l'aide de <span class="keyword">Delivery Pipeline</span>.</p>
<div class="section prereq"><div class="p">Avant de commencer :<ul><li><a href="container_integrations.html#container_group_pipeline_build" title="IBM Bluemix Container Service inclut un service de génération qui reçoit le code source, puis génère et publie une image Docker dans le registre de conteneurs. Delivery Pipeline, lequel est un élément d'IBM Bluemix Continuous Delivery, comporte un travail de génération qui utilise le service de génération de conteneur. Ce travail de génération récupère le code source depuis un référentiel, génère une image Docker depuis ce code, versionne (étiquette) cette image pour qu'elle corresponde au numéro de génération, puis envoie par commande push l'image générée dans le registre IBM Bluemix Container Service de l'organisation dans Bluemix. Ensuite, les membres de l'organisation peuvent déployer l'image générée dans des espaces de l'organisation.">Créez une étape de génération</a>.</li>
<li><a href="https://github.com/Osthanes/deployscripts/blob/master/deploygroup.sh" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">Passez en revue le script de déploiement par défaut pour les groupes de conteneurs</a>. Vous pouvez dévier le script par défaut et l'éditer ou créez votre propre script à la place.</li>
<li><a href="../services/ContinuousDelivery/pipeline_deploy_var.html">Examinez la liste des variables d'environnement disponibles fournies par le service <span class="keyword">Delivery Pipeline</span></a>.</li>
</ul>
</div>
</div><ol class="steps"><li class="step stepexpand"><span class="cmd">Créez une étape de déploiement.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Cliquez sur <span class="ph uicontrol">Ajouter une étape</span>.</span></li>
<li class="li substep"><span class="cmd">Nommez l'étape. </span> Par exemple, <samp class="ph codeph"><var class="keyword varname">Déploiement</var></samp>.</li>
<li class="li substep"><span class="cmd">Pour le type d'entrée, sélectionnez <span class="ph uicontrol">Artefacts de génération</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Dans l'étape, créez un travail de déploiement.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Dans l'onglet <span class="ph uicontrol">Travaux</span>, cliquez sur <span class="ph uicontrol">Ajouter un travail</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour le type de travail, sélectionnez <span class="ph uicontrol">Déployer</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour le type de déployeur, sélectionnez <span class="ph uicontrol">IBM Container Service on <span class="keyword">Bluemix</span></span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Sélectionnez l'organisation et l'espace.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour la stratégie de déploiement, entrez l'une des valeurs suivantes.</span> <ul><li><span class="ph uicontrol">red_black</span> - Déploie une nouvelle version de l'application. Si le déploiement aboutit, le déploiement précédent de l'application
est supprimé et l'adresse IP ou la route est mappée à la nouvelle version.</li>
<li><span class="ph uicontrol">clean</span> - Supprime tous les déploiements antérieurs de l'application. </li>
</ul>
</li>
<li class="li substep substepexpand"><span class="cmd">Pour le nom, entrez le nom du conteneur à déployer.</span></li>
<li class="li substep substepexpand"><span class="cmd">Pour le port, entrez le port publié pour le conteneur.</span> Pour les groupes de conteneurs, vous ne pouvez spécifier qu'un seul port.
<div class="note tip"><span class="tiptitle">Conseil :</span> Si aucun port n'est spécifié et que vous utilisez le script de déploiement par défaut, le port 80 est automatiquement publié. Pour rendre un contenu privé avec le script de déploiement par défaut, procédez comme indiqué ci-après.
<ol type="i"><li>Pour la stratégie de déploiement, entrez <kbd class="ph userinput">simple</kbd>.</li>
<li> Laissez la zone <span class="ph uicontrol">Port</span> non renseignée.</li>
<li>Etant donné que les déploiements simples ne nettoient pas les déploiements précédents, vous pouvez créer une autre étape de déploiement pour les nettoyer. Affectez la valeur <kbd class="ph userinput">clean</kbd> à la <span class="ph uicontrol">stratégie de déploiement</span> dans la deuxième étape de déploiement.</li>
</ol>
</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Le cas échéant, entrez des arguments de déploiement facultatifs.</span> Par exemple, si votre application requiert une variable d'environnement pour l'emplacement de votre base de données dorsale,  vous pourriez inclure la ligne suivante :

<pre class="codeblock"><code>--env MY_DB_HOSTNAME_PROPERTY=<var class="keyword varname">mon_nom_hôte_bd</var></code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Configurez un déploiement de groupe de conteneurs au lieu d'un déploiement de conteneur unique. Dans la section "Deployer
script", retirez l'annotation # pour annuler la mise en commentaires du script de groupe de conteneurs :</span> <pre class="pre screen"><code>/bin/bash deployscripts/deploygroup.sh</code></pre>
Ajoutez une annotation # pour mettre en commentaire le script de conteneur unique :
<pre class="pre screen"><code>#/bin/bash deployscripts/deploycontainer.sh</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Si vous avez créé votre propre script de déploiement, éditez la section <span class="ph uicontrol">Script de déployeur</span> pour l'utiliser.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Copiez la ligne suivante et mettez-la à jour pour utiliser votre référentiel.</span> <pre class="pre screen"><code>git_retry clone https://github.com/Osthanes/deployscripts.git deployscripts</code></pre>
</li>
<li class="li substep substepexpand"><span class="cmd">Editez la ligne suivante pour utiliser votre script.</span> <pre class="pre screen"><code>/bin/bash deployscripts/deploygroup.sh</code></pre>
</li>
</ol>
</li>
<li class="step stepexpand">Facultatif  : <span class="cmd">Pour configurer un groupe de conteneurs de base, définissez chacune des variables d'environnement du tableau.</span> Ces propriétés vous permettent de définir certaines des options que vous êtes susceptible de définir lorsque vous déployez des conteneurs à partir de la ligne de commande ou de l'interface utilisateur <span class="keyword">Bluemix</span>. Pour les autres propriétés, voir les commentaires dans la section Script de déployeur de l'interface utilisateur.<ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Cliquez sur l'onglet <span class="ph uicontrol">Propriétés d'environnement</span>, puis sur <span class="ph uicontrol">Ajouter une propriété</span>. </span></li>
<li class="li substep substepexpand"><span class="cmd">Sélectionnez <span class="ph uicontrol">Propriété de texte</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Entrez le nom et la valeur d'une propriété d'environnement.</span> <div class="tablenoborder"><table summary="" id="container_group_pipeline_deploy__common_properties" class="defaultstyle"><thead><tr><th id="d58934e3878" class="thleft">Propriété</th>
<th id="d58934e3880" class="thleft">Description</th>
</tr>
</thead>
<tbody><tr><td headers="d58934e3878 "><span class="ph uicontrol">AUTO_RECOVERY</span></td>
<td headers="d58934e3880 "><kbd class="ph userinput">true</kbd> ou <kbd class="ph userinput">false</kbd><p><span class="ph">Lorsque la reprise automatique est activée pour un groupe de conteneurs et que ce groupe est en opération depuis 10 minutes,
l'équilibreur de charge du groupe commence à vérifier régulièrement la santé de chaque instance de conteneur du groupe par le biais de demandes HTTP. Si une instance de conteneur ne répond pas d'ici 100 secondes, elle est marquée comme inactive. Les
instances de conteneur inactives sont supprimées du groupe et recréées par le processus de reprise automatique. La reprise automatique tente de récupérer par trois
fois les instances de conteneur d'un groupe. Après la troisième tentative, la reprise automatique ne récupère aucune instance de conteneur du groupe pendant 60 minutes. Au bout de 60 minutes, le processus de reprise automatique démarre à nouveau.</span></p>
</td>
</tr>
<tr><td headers="d58934e3878 "><span class="ph uicontrol">CONCURRENT_VERSIONS</span></td>
<td headers="d58934e3880 ">Un nombre<p>La propriété d'environnement
<samp class="ph systemoutput">CONCURRENT_VERSIONS</samp> définit le nombre de versions des déploiements d'application qui doivent rester actives. La valeur par défaut est une version. Par exemple, si <samp class="ph systemoutput">CONCURRENT_VERSIONS</samp> a pour valeur 2 et que vous déployez un groupe de conteneurs,
deux groupes sont mappés à la route et reçoivent du trafic.</p>

<p>Pour supprimer systématiquement tous les déploiements de l'application, dans l'onglet Propriétés d'environnement, vous pouvez attribuer à
<samp class="ph systemoutput">CONCURRENT_VERSIONS</samp> la valeur <samp class="ph systemoutput">0</samp>.</p>
</td>
</tr>
<tr><td headers="d58934e3878 "><span class="ph uicontrol">DESIRED_INSTANCES</span></td>
<td headers="d58934e3880 ">Un nombre<p>Exemple : <samp class="ph codeph">4</samp></p>
<span class="ph">Le nombre d'instances de groupe de conteneurs requis par votre application dépend de la charge de travail anticipée et du délai
sous lequel une demande peut être traitée par l'application. Par exemple, la capacité multi-tâches ou la connectivité réseau ont une
incidence sur le nombre d'instances pouvant être requis pour votre application.</span><p><span class="ph">Pour assurer la haute disponibilité de votre groupe de conteneurs et le rendre plus réfractaire aux défaillances, pensez à ajouter des instances
supplémentaires par rapport au nombre minimal d'instances afin de traiter la charge de travail prévue.
Des instances supplémentaires peuvent traiter la charge de travail en cas de panne d'une autre instance. Pour assurer la reprise automatique d'une instance ayant échoué sans affecter la charge de travail, ajoutez une instance supplémentaire. Pour protéger votre système contre deux pannes simultanées, ajoutez deux instances supplémentaires. Cette configuration correspond à un canevas <var class="keyword varname">N+2</var> où <var class="keyword varname">N</var> désigne le nombre d'instances permettant de traiter les
demandes et <var class="keyword varname">+2</var> indique que deux instances supplémentaires doivent être ajoutées.</span></p>
</td>
</tr>
<tr><td headers="d58934e3878 "><span class="ph uicontrol">ROUTE_DOMAIN</span></td>
<td headers="d58934e3880 ">Une chaîne ou la valeur <samp class="ph codeph">Néant</samp><p>Exemple : <samp class="ph codeph">mycustomdomain.com</samp></p>
<p>Le domaine système par défaut,
<samp class="ph codeph"><span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span></samp>, fournit déjà un certificat SSL, de sorte que vous pouvez accéder à vos groupes de conteneurs via HTTPS sans configuration supplémentaire. Pour utiliser un domaine personnalisé,
vous devez l'enregistrer sur un serveur DNS public, configurer le domaine personnalisé dans <span class="keyword">Bluemix</span>,
puis le mapper au domaine système <span class="keyword">Bluemix</span> sur le serveur
DNS public.</p>
<p>Si un domaine n'est pas spécifié, <samp class="ph codeph"><span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span></samp> est utilisé. Si la valeur <samp class="ph codeph">Néant</samp> est spécifiée, aucun nom domaine n'est créé.</p>
<p>Si la valeur <samp class="ph codeph">Néant</samp> est spécifiée pour le nom d'hôte et le domaine, le groupe est accessible par d'autres conteneurs figurant dans le même espace, mais il n'est pas accessible par le public.</p>
</td>
</tr>
<tr><td headers="d58934e3878 "><span class="ph uicontrol">ROUTE_HOSTNAME</span></td>
<td headers="d58934e3880 ">Une chaîne ou la valeur <samp class="ph codeph">Néant</samp><p>Exemple : <samp class="ph codeph">myapp</samp></p>
<p>Nom d'hôte, tel que <var class="keyword varname">monhôteconteneur</var>. N'incluez pas de traits de soulignement (_) dans le nom d'hôte. L'hôte et le port
combinés forment l'URL de route publique complète. Par exemple,
<samp class="ph codeph">http://mycontainerhost.<span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span></samp>. </p>
<p>Si un nom d'hôte n'est pas spécifié, le système en crée un pour vous. Si la valeur <samp class="ph codeph">Néant</samp> est spécifiée, aucun nom d'hôte n'est créé.</p>
<p>Si la valeur <samp class="ph codeph">Néant</samp> est spécifiée pour le nom d'hôte et le domaine, le groupe est accessible par d'autres conteneurs figurant dans le même espace, mais il n'est pas accessible par le public.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Cliquez sur <span class="ph uicontrol">Sauvegarder</span>.</span></li>
</ol>
</div>
</article></article></article><article class="topic tutorial tutorialIntro nested1" role="article" aria-labelledby="d58934e4022" lang="fr-fr" id="container_cfapp_tutorial_intro"><h2 class="topictitle2" id="d58934e4022">Tutoriel : Déploiement d'une application Cloud Foundry Node.js dans un conteneur</h2>
<div class="body  tutorialIntroBody"><p class="shortdesc">Vous pouvez prendre une application déployée auparavant à l'aide de Cloud et la déployer dans un conteneur à l'aide
d'<span class="keyword">IBM
Bluemix Container Service</span>.</p>
<div class="section tutorialDesc longDesc"></div><section class="section learningObjectives tutorialLearningObjectives" role="region" aria-labelledby="d58934e4071"><h3 class="sectiontitle" id="d58934e4071">Objectifs</h3>
<ul><li>Apprentissage de la procédure générale de déploiement de conteneurs</li>
<li>Connaissance des éléments à inclure dans un Dockerfile pour construire une image</li>
</ul>
</section>
<section class="section timeRequired tutorialTimeRequired" role="region" aria-labelledby="d58934e4080"><h3 class="sectiontitle" id="d58934e4080">Durée</h3>30 minutes</section>
<section role="region" aria-labelledby="d58934e4084" class="section section audienceDesc"><h3 class="sectiontitle" id="d58934e4084">Public</h3>Développeurs d'applications Cloud Foundry</section><section role="region" aria-labelledby="d58934e4088" class="section section prerequisites"><h3 class="sectiontitle" id="d58934e4088">Conditions
prérequises</h3>
<ul><li><a href="container_cli_cfic_install.html#container_cli_cfic_install" title="Installez le plug-in IBM Bluemix Container Service (bx ic) afin d'exécuter des commandes CLI natives de Docker pour gérer vos conteneurs.">Installez l'interface de ligne de commande (CLI) de
<span class="keyword">IBM
Bluemix Container Service</span></a></li>
<li><a href="container_cli_cfic_install.html#container_cli_login" title="Après son installation, connectez-vous à l'interface de ligne de commande pour l'utiliser.">Connectez-vous à l'interface utilisateur (CLI) de
<span class="keyword">IBM
Bluemix Container Service</span></a></li>
</ul>
</section></div>
<article class="topic task tutorialLesson nested2" role="article" aria-labelledby="d58934e4129" lang="fr-fr" id="container_cfapp_tutorial_lesson1"><h3 class="topictitle3" id="d58934e4129">Leçon 1 : Téléchargement du code d'application Cloud Foundry Node.js</h3>
<div class="body taskbody"><p class="shortdesc">Préparation de votre code Node.js pour son utilisation. Si vous n'avez pas encore de code, vous pouvez télécharger un code de démarrage depuis
<span class="keyword">Bluemix</span> et l'utiliser dans ce tutoriel.</p>
<div class="section prereq">Avant de commencer, <a href="container_cli_cfic_install.html#container_cli_cfic_install" title="Installez le plug-in IBM Bluemix Container Service (bx ic) afin d'exécuter des commandes CLI natives de Docker pour gérer vos conteneurs.">installez l'interface de ligne de commande
d'<span class="keyword">IBM
Bluemix Container Service</span> (CLI) </a> et
<a href="container_cli_cfic_install.html#container_cli_login" title="Après son installation, connectez-vous à l'interface de ligne de commande pour l'utiliser.">connectez-vous</a>.</div><p class="li stepsection">Pour obtenir et organiser le code d'application :</p><ol class="steps"><li class="step stepexpand"><span class="cmd">Créez un répertoire nommé <kbd class="ph userinput"><var class="keyword varname">cf-pi-myinitials</var></kbd> et accédez à ce répertoire.</span> Dans ce répertoire, vous sauvegardez tous les fichiers requis pour construire l'image Docker et pour exécuter votre application
Node.js. Vous pouvez utiliser n'importe quel nom pour le répertoire. Si vous utilisez celui de l'exemple,
remplacez <var class="keyword varname">myinitials</var> par vos initiales (par exemple, <var class="keyword varname">cf-pi-ms</var>).
<pre class="codeblock"><code>mkdir <var class="keyword varname">cf-pi-myinitials</var> &amp;&amp; cd <var class="keyword varname">cf-pi-myinitials</var></code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Copiez votre code d'application Node.js et tous les fichiers associés dans ce répertoire.</span> Vous pouvez utiliser votre propre code d'application Node.js ou télécharger l'application Personal Insights depuis
<span class="keyword">Bluemix</span>. 
<p>Pour télécharger le code d'application Personal Insights depuis <span class="keyword">Bluemix</span>, procédez comme
suit.</p>
<ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Dans le <span class="keyword wintitle">Catalogue</span> <span class="keyword">Bluemix</span>, sous <span class="ph uicontrol">Conteneurs
boilerplate</span>, cliquez sur <span class="ph uicontrol">Personality Insights Node.js Web Starter</span>.</span> Ce conteneur boilerplate inclut une application Node.js qui utilise le service
<span class="keyword">IBM
Watson Personality Insights</span> pour extraire une panoplie de caractéristiques cognitives et sociales
depuis un texte généré par une personne via des blogues, des tweets ou des articles de forum.</li>
<li class="li substep substepexpand"><span class="cmd">Entrez le nom d'application <kbd class="ph userinput"><var class="keyword varname">cf-pi-myinitials</var></kbd> et cliquez sur
<span class="ph uicontrol">Créer</span>.</span> Pour accéder au code d'application du conteneur boilerplate, vous devez d'abord déployer l'application CF sur
<span class="keyword">Bluemix</span>. Vous pouvez utiliser n'importe quel nom pour l'application. Si vous utilisez celui de l'exemple, remplacez <var class="keyword varname">myinitials</var> par vos initiales, par exemple, <var class="keyword varname">cf-pi-ms</var>, pour être certain qu'il soit unique. 
<p>Ce déploiement crée une application nommée <var class="keyword varname">cf-pi-myinitials</var>, ainsi qu'une instance du service
<span class="keyword">IBM
Watson Personality Insights</span> nommée <var class="keyword varname">cf-pi-myinitials-personality_insights</var>. </p>

<p>Au fur et à mesure du déploiement de l'application, les instructions de
<strong>déploiement de votre application à l'aide de l'interface de ligne de commande</strong> sont affichées.</p>
</li>
<li class="li substep substepexpand"><span class="cmd">Conformément à l'étape 1, cliquez sur <span class="ph uicontrol">DOWNLOAD STARTER CODE</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Décompressez le fichier .zip et enregistrez les fichiers d'application dans votre répertoire. </span></li>
</ol>
</li>
</ol>
<div class="section result">Votre code d'application Cloud Foundry est prêt à intégrer un conteneur.</div></div>
</article><article class="topic task tutorialLesson nested2" role="article" aria-labelledby="d58934e4325" lang="fr-fr" id="container_cfapp_tutorial_lesson2"><h3 class="topictitle3" id="d58934e4325">Leçon 2 : Création d'une image Docker avec votre code d'application CF</h3>
<div class="body taskbody"><p class="shortdesc">Créez un fichier Dockerfile incluant votre code d'application Node.js et les configurations nécessaires pour votre conteneur. Générez ensuite une
image Docker depuis ce fichier Dockerfile et transférez-la à votre registre
<span class="keyword">Bluemix</span> privé.</p>
<p class="li stepsection">Pour créer une image Docker avec votre code d'application, procédez comme suit.</p><ol class="steps"><li class="step stepexpand"><span class="cmd">Créez un fichier <span class="ph filepath">Dockerfile</span>, lequel constitue la base pour la création d'un conteneur. </span> Vous pouvez créer le fichier Dockerfile à l'aide de l'éditeur CLI de votre choix ou d'un éditeur de texte sur votre ordinateur. L'exemple suivant illustre comment créer un fichier Dockerfile avec l'éditeur nano
<a href="https://www.nano-editor.org/dist/v2.2/nano.html" rel="external" target="_blank" title="(S'ouvre dans un nouvel onglet ou une nouvelle fenêtre)">https://www.nano-editor.org/dist/v2.2/nano.html</a>. 
<pre class="codeblock"><code>Dockerfile nano</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Copiez le script suivant dans le fichier Dockerfile.</span> <pre class="codeblock"><code>#Utilisez l'image IBM Node comme image de base
FROM registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/ibmnode:latest

#Exposez le port pour votre application Personal Insights et définissez-le 
#par le biais d'une variable d'environnement, comme attendu par les applications cf
ENV PORT=3000
EXPOSE 3000
ENV NODE_ENV production

#Copiez tous les fichiers d'application depuis le répertoire actuel vers le 
répertoire d'application de votre conteneur. Définissez ce répertoire d'application
#comme répertoire de travail
ADD . /app
WORKDIR /app

#Installez les logiciels requis depuis package.json
RUN npm install

#Effectuez une pause avant le démarrage de l'application. Cette commande garantit que la
#mise en réseau d'IBM Containers se termine avant le démarrage de l'application. 
CMD (sleep 60; npm start)

#Lancez l'application Personal Insight. 
CMD ["node", "/app/app.js"]</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Enregistrez vos modifications en appuyant sur les touches <span class="ph uicontrol">ctrl + o</span>. Confirmez vos modifications en appuyant sur la touche
<span class="ph uicontrol">ENTREE</span>. Quittez l'éditeur nano en appuyant sur les touches <span class="ph uicontrol">ctrl + x</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Générez l'image Docker avec votre code d'application et transférez-la à votre registre
<span class="keyword">Bluemix</span> privé.</span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> build -t
registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">espace_nom</var>/<var class="keyword varname">cf-pi-myinitials</var> .</code></pre>


<div class="tablenoborder"><table summary="" id="container_cfapp_tutorial_lesson2__table_build" class="defaultstyle"><thead><tr><th colspan="2" id="d58934e4435" class="thleft"><span class="ph"><img src="images/idea.png" alt="Cette icône indique l'existence d'informations supplémentaires sur l'exécution de cette étape de la tâche."></span> Description des composantes de cette commande</th>
</tr>
</thead>
<tbody><tr><td style="width: 50%" headers="d58934e4435 "><samp class="ph codeph">build</samp></td>
<td style="width: 50%" headers="d58934e4435 ">Commande <samp class="ph codeph">build</samp>.</td>
</tr>
<tr><td style="width: 50%" headers="d58934e4435 "><samp class="ph codeph">registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">espace_nom</var>/<var class="keyword varname">cf-pi-myinitials</var></samp></td>
<td style="width: 50%" headers="d58934e4435 ">Chemin de votre registre <span class="keyword">Bluemix</span> privé,
incluant votre espace de nom unique et le nom d' l'image. Dans cet exemple, nous avons conservé pour l'image le même nom que pour l'application
CF <var class="keyword varname">cf-pi-myinitials</var>, mais vous pouvez choisir un nom quelconque pour l'image dans le registre. Si vous n'être pas sûr du nom de votre espace
de nom, exécutez la commande suivante.
<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> namespace-get</code></pre>
</td>
</tr>
<tr><td style="width: 50%" headers="d58934e4435 "><samp class="ph codeph">.</samp></td>
<td style="width: 50%" headers="d58934e4435 ">Emplacement du fichier Dockerfile. Si vous exécutez la commande build depuis le répertoire où réside le fichier Dockerfile, entrez un point (.). Sinon,
utilisez un chemin relatif au Dockerfile.</td>
</tr>
</tbody>
</table>
</div>
</li>
</ol>
<div class="section result">L'image est créée dans votre registre. Vous pouvez exécuter la commande <samp class="ph codeph"><span class="ph"><samp class="ph codeph">bx ic</samp></span> images</samp> pour vérifier qie l'image a été créée.<pre class="pre screen"><code>$ <span class="ph"><samp class="ph codeph">bx ic</samp></span> images
REPOSITORY                                        TAG                 IMAGE ID            CREATED             SIZE
registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">espace_nom</var>/<var class="keyword varname">cf-pi-myinitials</var>  latest
b02b7a24c35f  48 seconds ago  251.3 MB</code></pre>
</div></div>
</article><article class="topic task tutorialLesson nested2" role="article" aria-labelledby="d58934e4505" lang="fr-fr" id="container_cfapp_tutorial_lesson3"><h3 class="topictitle3" id="d58934e4505">Leçon 3: Déploiement d'un conteneur depuis votre image</h3>
<div class="body taskbody"><p class="shortdesc">Déploiement de votre application en tant que groupe de conteneurs dans <span class="keyword">Bluemix</span>.</p>
<p class="li stepsection">Pour déployer votre application dans un groupe de conteneurs, procédez comme suit.</p><ol class="steps"><li class="step stepexpand"><span class="cmd"> Créez en lançant la commande suivante un groupe de conteneurs depuis l'image que vous avez créée à l'étape précédente.</span>  <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> group-create --name <var class="keyword varname">cf-pi-myinitials</var> -m 64 -n <var class="keyword varname">pi-app-myinitials</var> -d <span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span> -p 3000 -e CCS_BIND_SRV=<var class="keyword varname">cf-pi-myinitials-personal_insights</var> --desired 3 --auto --anti registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">namespace</var>/<var class="keyword varname">cf-pi-myinitials</var>:latest</code></pre>


<div class="p"><div class="tablenoborder"><table summary="" id="container_cfapp_tutorial_lesson3__table_group_create" class="defaultstyle"><thead><tr><th colspan="2" id="d58934e4591" class="thleft"><span class="ph"><img src="images/idea.png" alt="Cette icône indique l'existence d'informations supplémentaires sur l'exécution de cette étape de la tâche."></span> Description des composantes de cette commande</th>
</tr>
</thead>
<tbody><tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">group-create</samp></td>
<td style="width: 50%" headers="d58934e4591 ">Commande <samp class="ph codeph">group-create</samp>.</td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">--name <var class="keyword varname">cf-pi-myinitials</var></samp></td>
<td style="width: 50%" headers="d58934e4591 ">Nom de conteneur à afficher dans l'interface graphique <span class="keyword">Bluemix</span>. </td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">-m 64</samp></td>
<td style="width: 50%" headers="d58934e4591 ">Une mémoire de 64 Mo est affectée à chaque instance du groupe. </td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">-n <var class="keyword varname">pi-app-myinitials</var></samp></td>
<td style="width: 50%" headers="d58934e4591 ">Nom d'hôte dans l'URL de la route.<div class="note tip"><span class="tiptitle">Conseil :</span> Si vous utilisez le code de démarrage, utilisez un autre nom pour le nom d'hôte que celui que vous avez
utilisé dans la leçon précédente pour le déploiement de l'application Cloud Foundry. Si le même nom d'hôte est utilisé et que l'application CF est toujours en cours d'exécution, un équilibrage de charge se produit entre le groupe de conteneurs et l'application. </div>
</td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">-d <span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span></samp></td>
<td style="width: 50%" headers="d58934e4591 ">Nom de domaine dans l'URL de la route. A moins que vous n'ayez un domaine personnalisé, utilisez
<span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span>.</td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">-p 3000</samp></td>
<td style="width: 50%" headers="d58934e4591 ">Numéro de port à exposer . Les connexions à l'URL de la route sont acheminées au port 3000 sur le conteneur. </td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">-e CCS_BIND_SRV=<var class="keyword varname">cf-pi-myinitials-personal_insights</var></samp></td>
<td style="width: 50%" headers="d58934e4591 ">Liez l'instance de service <span class="keyword">IBM
Watson Personality Insights</span>
au conteneur, de manière à pouvoir analyser les caractéristiques cognitives et sociales du texte saisi dans l'application
Personal Insights. L'instance de service a été créée dans le cadre du déploiement de l'application CF dans la leçon 1. <div class="p">Si vous n'être pas sûr du nom de votre instance de service, exécutez la commande suivante. <pre class="codeblock"><code>bx service list</code></pre>
</div>
</td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">--desired 3</samp></td>
<td style="width: 50%" headers="d58934e4591 ">Nombre d'instances de conteneur unique à créer dans le groupe de conteneurs. Toutes les instances sont identiques.</td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">--auto</samp></td>
<td style="width: 50%" headers="d58934e4591 ">Active la reprise automatique pour le groupe de conteneurs. Si une des instances du groupe devient indisponible, une autre
instance est créée automatiquement à sa place. </td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">--anti</samp></td>
<td style="width: 50%" headers="d58934e4591 ">Active l'anti-affinité pour le groupe de conteneurs. Chaque instance du groupe est placée sur un noeud de traitement physique distinct, ce qui réduit les
risques d'une défaillance de tous les conteneurs d'un groupe suite à une panne matérielle.</td>
</tr>
<tr><td style="width: 50%" headers="d58934e4591 "><samp class="ph codeph">registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">espace_nom</var>/<var class="keyword varname">cf-pi-myinitials</var>:latest</samp></td>
<td style="width: 50%" headers="d58934e4591 ">Chemin du répertoire de destination, lequel inclut votre espace de nom unique et le nom de l'image de
destination. Dans cet exemple, le même nom est utilisé pour l'image que l'application de noeud CF
<var class="keyword varname">cf-pi-myinitials</var>. </td>
</tr>
</tbody>
</table>
</div>
</div>
</li>
<li class="step stepexpand"><span class="cmd">Patientez quelques minutes que s'achève le déploiement et que le réseau soit mis en place. Une fois le conteneur déployé,
vous pouvez accéder à votre application Personal Insights dans un navigateur en entrant l'URL suivante : <span class="ph filepath">http://<var class="keyword varname">pi-app-myinitials</var>.<span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span>/</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Supprimez l'application CF. </span> Maintenant que votre code d'application CF est déployé dans un conteneur, vous pouvez supprimer l'application
CF pour optimiser l'utilisation de votre quota. 
<pre class="codeblock"><code>cf delete <var class="keyword varname">cf-pi-myinitials</var></code></pre>
Confirmez la suppression en entrant <span class="ph uicontrol">o</span>. </li>
</ol>
<div class="section result">Votre application est déployée dans un conteneur.</div></div>
</article></article></article></div></main></body></html>