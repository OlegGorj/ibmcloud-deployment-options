---

copyright:
  years: 2014, 2018
lastupdated: "2018-05-24"

---

{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:pre: .pre}
{:table: .aria-labeledby="caption"}
{:codeblock: .codeblock}
{:tip: .tip}
{:download: .download}




# {{site.data.keyword.containerlong_notm}} の高可用性
{: #ha}

組み込みの Kubernetes 機能と {{site.data.keyword.containerlong}} 機能を使用してクラスターの可用性を高め、クラスター内のコンポーネントに障害が発生した場合にアプリでダウン時間が生じないように保護することができます。
{: shortdesc}

高可用性とは、サイトの一部または全体に障害が発生した後でもアプリを稼働状態に保つための、IT インフラストラクチャーの中核分野です。 高可用性の主な目的は、IT インフラストラクチャー内の潜在的な障害点を除去することです。 例えば、冗長性を追加してフェイルオーバー・メカニズムをセットアップすることで、1 つのシステムの障害に備えることができます。

高可用性は、IT インフラストラクチャーのさまざまなレベルで、また、クラスターのさまざまなコンポーネント内で実現できます。 どのレベルの可用性が適しているかは、ビジネス要件、顧客と合意したサービス・レベル・アグリーメント、予算など、いくつかの要因によって決まります。

## {{site.data.keyword.containerlong_notm}} の潜在的な障害点の概要
{: #fault_domains} 

{{site.data.keyword.containerlong_notm}} のアーキテクチャーとインフラストラクチャーは、信頼性を確保し、処理待ち時間を短く、サービスの実行可能時間を最大にするように設計されています。 ただし、障害が発生する可能性はあります。 {{site.data.keyword.Bluemix_notm}} でホストするサービスによっては、たとえ数分の障害であっても障害を許容できないものがあります。
{: shortdesc}

{{site.data.keyword.containershort_notm}} には、冗長性とアンチアフィニティーを追加してクラスターの可用性を向上させる方法がいくつか用意されています。 以下の図を参照して、潜在的な障害点とその除去方法を確認してください。

<img src="images/cs_failure_ov.png" alt="{{site.data.keyword.containershort_notm}} 地域内の高可用性クラスターにある障害ドメインの概要。" width="250" style="width:250px; border-style: none"/>


<table summary="この表は {{site.data.keyword.containershort_notm}} の障害点を示しています。行は左から右に読みます。1 列目は障害点の番号、2 列目は障害点の名称、3 列目は説明、4 列目は文書へのリンクです。">
<caption>障害点</caption>
<col width="3%">
<col width="10%">
<col width="70%">
<col width="17%">
  <thead>
  <th>#</th>
  <th>障害点</th>
  <th>説明</th>
  <th>資料へのリンク</th>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>コンテナーまたはポッドの障害</td>
      <td>設計上、コンテナーやポッドの存続期間は短く、予期せぬ障害が起こることがあります。 例えば、アプリでエラーが発生した場合、コンテナーやポッドが異常終了する可能性があります。 アプリの可用性を高くするには、ワークロードを処理できる十分な数のアプリ・インスタンスに加えて、障害時用の追加インスタンスを用意しておく必要があります。 ワーカー・ノードの障害からアプリを保護するために、これらのインスタンスを複数のワーカー・ノードに分散させるのが理想的です。</td>
      <td>[可用性の高いアプリをデプロイする。](cs_app.html#highly_available_apps)</td>
  </tr>
  <tr>
    <td>2</td>
    <td>ワーカー・ノードの障害</td>
    <td>ワーカー・ノードは、物理ハードウェアの上で実行される VM です。 ワーカー・ノードの障害には、電源、冷却、ネットワーキングなどのハードウェア障害と VM 自体の問題が含まれます。 クラスター内に複数のワーカー・ノードをセットアップすることで、ワーカー・ノードの障害に備えられます。 <br/><br/><strong>注:</strong> 1 つのロケーションに複数のワーカー・ノードを作成しても、それらが別々の物理コンピュート・ホストに置かれる保証はありません。 例えば、3 つのワーカー・ノードを持つクラスターがあるとしても、3 つのワーカー・ノードのすべてが IBM ロケーションの同じ物理コンピュート・ホスト上に作成されている場合があります。 その物理コンピュート・ホストがダウンした場合、すべてのワーカー・ノードがダウンします。 このような障害から保護するには、別のロケーションに 2 つ目のクラスターをセットアップする必要があります。</td>
    <td>[複数のワーカー・ノードを持つクラスターを作成する。](cs_cli_reference.html#cs_cluster_create)</td>
  </tr>
  <tr>
    <td>3</td>
    <td>クラスターの障害</td>
    <td>Kubernetes マスターは、クラスターを稼働状態に保つための主要なコンポーネントです。 このマスターは、クラスターの真実の単一点 (Single Point of Truth) として機能する etcd データベースに、すべてのクラスター・データを保管します。 ネットワーク障害でマスターに到達できなくなったり、etcd データベース内のデータが破損したりすると、クラスター障害が発生します。 1 つのロケーションに複数のクラスターを作成すると、Kubernetes マスターまたは etcd の障害からアプリを保護できます。 クラスター間でロード・バランシングを行うには、外部ロード・バランサーをセットアップする必要があります。 <br/><br/><strong>注:</strong> 1 つのロケーションに複数のクラスターをセットアップしても、ワーカー・ノードが別々の物理コンピュート・ホストにデプロイされる保証はありません。 このような障害から保護するには、別のロケーションに 2 つ目のクラスターをセットアップする必要があります。</td>
    <td>[可用性の高いクラスターをセットアップする。](cs_clusters.html#planning_clusters)</td>
  </tr>
  <tr>
    <td>4</td>
    <td>ロケーションの障害</td>
    <td>ロケーションの障害は、すべての物理コンピュート・ホストおよび NFS ストレージに影響します。 この障害には、電力、冷却、ネットワーキング、ストレージの故障と自然災害 (洪水、地震、ハリケーンなど) が含まれます。 ロケーションの障害から保護するには、2 つの異なるロケーションにクラスターを作成し、それらを外部ロード・バランサーでロード・バランシングする必要があります。</td>
    <td>[可用性の高いクラスターをセットアップする。](cs_clusters.html#planning_clusters)</td>
  </tr>
  <tr>
    <td>5</td>
    <td>地域の障害</td>
    <td>すべての地域に、その地域に固有の API エンドポイントからアクセスできる高可用性ロード・バランサーがセットアップされています。 このロード・バランサーが、着信要求と発信要求を、その地域の各ロケーションにある複数のクラスターにルーティングします。 ある地域全体で障害が発生する可能性はごくわずかです。 それでも、このような障害に備えるには、複数のクラスターを別々の地域にセットアップし、それらを外部ロード・バランサーを使用して接続します。ある地域全体で障害が発生した場合は、他の地域のクラスターがワークロードを引き継ぐことができます。 <br/><br/><strong>注:</strong> 複数地域にまたがるクラスターには複数のクラウド・リソースが必要になるので、アプリによっては複雑でコストがかかる場合があります。 複数地域のセットアップが必要かどうか、あるいは、潜在的なサービスの中断に対応できるかどうかを確認してください。 複数地域にまたがるクラスターをセットアップする場合は、アプリとデータが別の地域でもホスト可能であること、また、アプリがグローバルなデータ複製に対応できることを確認してください。</td>
    <td>[可用性の高いクラスターをセットアップする。](cs_clusters.html#planning_clusters)</td>
  </tr>
  <tr>
    <td>6a、6b</td>
    <td>ストレージの障害</td>
    <td>ステートフルなアプリでは、データが、アプリを稼働状態に保つために重要な役割を果たします。 潜在的な障害からリカバリーできるようにするには、データの可用性を高くする必要があります。 {{site.data.keyword.containershort_notm}} では、データを保持する方法を複数の選択肢から選択できます。 例えば、Kubernetes ネイティブ永続ボリュームを使用して NFS ストレージをプロビジョンしたり、{{site.data.keyword.Bluemix_notm}} データベース・サービスを使用してデータを保管したりできます。</td>
    <td>[可用性の高いデータを計画する。](cs_storage.html#planning)</td>
  </tr>
  </tbody>
  </table>



