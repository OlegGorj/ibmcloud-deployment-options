<!DOCTYPE html><html lang="pt-br">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8">
<meta name="dcterms.date" content="2017-11-10">
<meta name="dcterms.rights" content="© Copyright IBM Corporation 2014, 2017">

<meta name="description" content="É possível usar vários serviços no Catálogo do Bluemix com o IBM Bluemix Container Service. Muitos dos serviços do Bluemix ajudam a trazer recursos extras para os apps implementados em contêineres. Além disso, alguns serviços do Bluemix podem ser usados para ajudar a gerenciar seus contêineres.">
<meta name="keywords" content="IBM Containers, contêineres, remotos, Bluemix, integrações, ligando, notificação de alerta, políticas, notificações, Delivery Pipeline, pipeline, entrega contínua, contêiner único, pipeline de entrega, imagem, compilação, Vulnerability Advisor, segurança, serviço, limpeza da imagem, propriedades do ambiente, ligar, grupo de contêineres, Devops Services, contêiner, implementar">
<meta name="geo.country" content="ZZ">
<script>
    digitalData = {
      page: {
        pageInfo: {
  language: "pt-br",

  version: "v18",
  ibm: {
  country: "ZZ",
  type: "CT701"
  
         }
       }
     }
   };
  </script><link rel="stylesheet" type="text/css" href="./ibmdita.css">
<title>Integrando serviços para uso com o contêineres únicos e escaláveis</title>
</head>
<body><main role="main"><div><article class="nested0" role="article" aria-labelledby="d58942e6" id="container_integrations"><h1 class="topictitle1" id="d58942e6"><span class="ph" id="title">Integrando serviços com o <span class="ph">contêineres únicos e escaláveis</span></span></h1>
<div class="body conbody"><div class="abstract"><div class="shortdesc"><span class="ph" id="shortdesc">É possível usar vários serviços no <span class="keyword wintitle">Catálogo</span>
do <span class="keyword">Bluemix</span> com o <span class="keyword">IBM®
Bluemix Container Service</span>. Muitos
dos serviços do
<span class="keyword">Bluemix</span> ajudam a
trazer recursos extras para os apps implementados em
contêineres. Além disso, alguns serviços do
<span class="keyword">Bluemix</span> podem ser
usados para ajudar a gerenciar seus contêineres. </span></div>


<div class="p"><div class="note attention"><span class="attentiontitle">Atenção:</span> <span class="ph">Avaliações grátis para o <span class="ph">contêineres únicos e escaláveis</span>
não estão disponíveis. <a href="cs_ov.html" title="O IBM Bluemix Container Service combina o Docker e o Kubernetes para entregar ferramentas poderosas, uma experiência intuitiva do usuário e a segurança e o isolamento integrados para automatizar a implementação, operação, ajuste de escala e monitoramento de apps conteinerizados por um cluster de hosts de cálculo independente usando as APIs do Kubernetes.">Saiba mais sobre gerenciamento de
cluster e migração para o Kubernetes no <span class="keyword">IBM
Bluemix Container Service</span> no <span class="keyword">Bluemix</span> Public.</a></span></div>
</div>


<div class="p">Nesta página:<div class="lines">&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__data">Serviços de analítica de dados e de armazenamento</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__devops">Serviços DevOps</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__integrate">Integrar serviços</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__network">Serviços de Rede</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations__security">Serviços de segurança</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations_binding" title="O IBM Bluemix possui uma lista de serviços e gerencia-os em nome dos desenvolvedores de apps. Para incluir um serviço do Bluemix para uso do contêiner, deve-se solicitar uma instância desse serviço e ligar o serviço ao contêiner.">Ligando um serviço a partir da GUI do Bluemix</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_integrations_binding_cli" title="O IBM Bluemix possui uma lista de serviços e gerencia-os em nome dos desenvolvedores de apps. Para incluir um serviço do Bluemix para uso do contêiner, deve-se solicitar uma instância desse serviço e ligar o serviço ao contêiner.">Ligando um serviço a um contêiner a partir da CLI</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_alertnotification" title="Configure seu app para enviar notificações quando uma determinada condição ou critérios são atendidos e use o serviço Alert Notification para gerenciar suas notificações de alerta. Com o serviço Alert Notification, é possível criar políticas de notificação customizadas que filtram os alertas do seu interesse. É possível refinar os filtros de política conforme necessário para especificar indivíduos ou grupos como destinatários de alertas, bem como métodos e frequência de notificação preferenciais.">Configurando alertas para apps implementados em contêineres usando o Alert Notification</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_pipeline_ov" title="Automatize as construções de app e as implementações de contêiner para o Bluemix usando o Delivery Pipeline, que faz parte do IBM Bluemix Continuous Delivery.">Automatizando implementações de contêiner usando o Delivery Pipeline no serviço Continuous Delivery</a><br>
&nbsp;&nbsp;&nbsp;&nbsp; • <a href="container_integrations.html#container_cfapp_tutorial_intro" title="É possível usar um app implementado anteriormente usando o Cloud Foundry e implementá-lo em um contêiner usando o IBM Bluemix Container Service.">Tutorial: Implementando um app Node.js do Cloud Foundry em um contêiner</a></div>
</div>
</div>
<section role="region" aria-labelledby="d58942e220" id="container_integrations__data"><h2 class="sectiontitle" id="d58942e220">Serviços de analítica de dados e de armazenamento</h2>
<div class="p"><dl><dt class="dlterm"><span class="keyword">Object Storage</span></dt>
<dd><p>Armazene dados persistentes que são replicados nos múltiplos nós de armazenamento para fazer backup deles.</p>

<div class="p"><ul><li>Para obter informações gerais sobre o serviço <span class="keyword">Object Storage</span>, consulte <a href="../services/ObjectStorage/index.html">Introdução ao
serviço <span class="keyword">Object Storage</span></a>.</li>
</ul>
</div>
</dd>
</dl>
</div>
</section><section role="region" aria-labelledby="d58942e246" id="container_integrations__devops"><h2 class="sectiontitle" id="d58942e246">Serviços DevOps</h2>
<div class="p"><dl><dt class="dlterm"><span class="keyword">Active Deploy</span></dt>
<dd><p>Atualize seus grupos de contêineres em execução sem tempo de inatividade e, se
necessário, reverta rapidamente à versão original. O serviço
<span class="keyword">IBM Active
Deploy for Bluemix</span> usa uma
abordagem em fases para implementações, dando a você tempo para testar e validar seu
app atualizado em um ambiente de produção.</p>
</dd>
<dd class="ddexpand"><div class="p">Para obter informações sobre como atualizar grupos de contêineres em execução, veja:<ul><li><a href="../services/ActiveDeploy/updatingapps.html#updatingappscli" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">Atualizando apps ou grupos de contêineres com o serviço de Implementação ativa (CLI)</a></li>
<li><a href="../services/ActiveDeploy/updatingapps.html#updatingappsgui" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">Atualizando apps ou grupos de contêineres com o serviço de Implementação ativa (GUI)</a></li>
</ul>
</div>
</dd>
<dt class="dlterm"><span class="keyword">Alert Notification</span></dt>
<dd><p>Configure políticas de notificação para filtrar apenas os alertas em que estiver interessado obter de seu
aplicativo. É possível refinar
os filtros de política conforme necessário para especificar indivíduos ou grupos como destinatários de alertas, bem como
métodos e frequência de notificação preferenciais. </p>

<div class="p"><ul><li>Para obter mais informações sobre como usar contêineres com o <span class="keyword">Alert Notification</span>, consulte <a href="container_integrations.html#container_alertnotification" title="Configure seu app para enviar notificações quando uma determinada condição ou critérios são atendidos e use o serviço Alert Notification para gerenciar suas notificações de alerta. Com o serviço Alert Notification, é possível criar políticas de notificação customizadas que filtram os alertas do seu interesse. É possível refinar os filtros de política conforme necessário para especificar indivíduos ou grupos como destinatários de alertas, bem como métodos e frequência de notificação preferenciais.">Configurando alertas para apps implementados em contêineres usando o Alert Notification</a>.</li>
<li>Para obter informações gerais sobre o serviço
<span class="keyword">Alert Notification</span>,
consulte <a href="../services/AlertNotification/index.html">Introdução
ao <span class="keyword">Alert Notification</span></a>.</li>
</ul>
</div>
</dd>
<dt class="dlterm"><span class="keyword">Delivery Pipeline</span></dt>
<dd><p>Automatize as construções de app e as implementações de contêiner para o <span class="keyword">Bluemix</span> usando <span class="keyword">Delivery Pipeline</span>, que faz parte
do <span class="keyword">IBM
Bluemix Continuous Delivery</span>. </p>

<div class="p"><ul><li>Para obter mais informações sobre como usar contêineres com o pipeline, consulte <a href="container_integrations.html#container_pipeline_ov" title="Automatize as construções de app e as implementações de contêiner para o Bluemix usando o Delivery Pipeline, que faz parte do IBM Bluemix Continuous Delivery.">Automatizando implementações de contêiner usando o Delivery Pipeline no serviço Continuous Delivery</a>.</li>
<li>Para obter informações gerais sobre o serviço do <span class="keyword">Delivery Pipeline</span>, consulte <a href="../services/ContinuousDelivery/pipeline_about.html">Introdução ao
Pipeline de Entrega</a>.</li>
</ul>
</div>
</dd>
<dt class="dlterm">UrbanCode Deploy</dt>
<dd><p>Gerencie suas liberações e automatize as implementações do contêiner com o IBM UrbanCode Deploy. Esse serviço
fornece as ferramentas que podem ser usadas para ter visibilidade em suas implementações em todos os
ambientes. É possível usar esse serviço como uma alternativa ao serviço <span class="keyword">Delivery Pipeline</span>.</p>

<ul><li>Para obter informações de compra, consulte a página de produto para <a href="http://www.ibm.com/software/products/en/ucdep" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">IBM UrbanCode
Deploy</a>.</li>
<li>Para obter informações gerais sobre o UrbanCode Deploy, consulte o <a href="http://www.ibm.com/support/knowledgecenter/SS4GSP/ucd_welcome.html" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">IBM Knowledge Center</a>.</li>
</ul>
</dd>
</dl>
</div>
</section><section role="region" aria-labelledby="d58942e390" id="container_integrations__integrate"><h2 class="sectiontitle" id="d58942e390">Integrar serviços</h2>
<div class="p"><dl><dt class="dlterm">Istio</dt>
<dd><p>Gerencie seus microsserviços no <span class="keyword">IBM
Bluemix Container Service</span>
para um aplicativo ou serviço. <span class="ph">Para obter informações ou para se envolver no projeto de software livre
Istio, veja <a href="https://istio.io/" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">https://istio.io/</a>.</span></p>
</dd>
<dt class="dlterm"><span class="keyword">Secure Gateway</span></dt>
<dd><p>Conecte com segurança os aplicativos do <span class="keyword">Bluemix</span>
aos locais remotos no local ou na nuvem.</p>

<div class="p"><ul><li>Para obter informações sobre como usar o <span class="keyword">IBM
Bluemix Container Service</span>
com o <span class="keyword">Secure Gateway</span>, consulte <a href="../services/SecureGateway/sg_003.html#sg_003">Usando o Docker como um
cliente</a>.</li>
<li>Para obter informações gerais sobre o serviço <span class="keyword">Secure Gateway</span>, consulte <a href="../services/SecureGateway/secure_gateway.html">Introdução ao
serviço <span class="keyword">Secure Gateway</span></a>.</li>
</ul>
</div>

</dd>
</dl>
</div>
</section><section role="region" aria-labelledby="d58942e457" id="container_integrations__network"><h2 class="sectiontitle" id="d58942e457">Serviços de Rede</h2>
<div class="p"><dl><dt class="dlterm">VPN</dt>
<dd><p>Permita que os contêineres se comuniquem uns com os outros entre um espaço do <span class="keyword">Bluemix</span> e um servidor de intranet.</p>

<div class="p"><ul><li>Para obter informações gerais sobre o serviço <span class="keyword">IBM
VPN</span>, consulte <a href="../services/vpn/index.html">Introdução
ao serviço <span class="keyword">IBM
VPN</span></a>.</li>
</ul>
</div>
</dd>
</dl>
</div>
</section><section role="region" aria-labelledby="d58942e490" id="container_integrations__security"><h2 class="sectiontitle" id="d58942e490">Serviços de segurança</h2>
<div class="p"><dl><dt class="dlterm"><span class="keyword">Access Trail</span></dt>
<dd><p>Auditar chamadas API de qualquer tipo de atividade anormal e ajudá-lo a obedecer os requisitos regulamentares
de auditoria.</p>
</dd>
<dd class="ddexpand"><div class="p"><ul><li>Para obter informações gerais sobre o serviço <span class="keyword">Access Trail</span>, consulte <a href="../services/AccessTrail/index.html">Introdução ao serviço <span class="keyword">Access Trail</span></a>.</li>
</ul>
</div>
</dd>
</dl>
</div>
</section></div>
<article class="topic concept nested1" role="article" aria-labelledby="d58942e516" id="rellinks"><h2 class="topictitle2" id="d58942e516">Links relacionados</h2>
<aside role="complementary" aria-labelledby="d58942e516">
<div class="linklist" id="general"><h3 class="linklistlabel">Links relacionados</h3>
<ul><li><img src="./sout.gif" alt=""><a href="https://wiki.eclipse.org/Linux_Tools_Project/Docker_Tooling" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">Docker Tooling for Eclipse</a></li>
</ul></div>
</aside></article><article class="topic task nested1" role="article" aria-labelledby="d58942e526" lang="pt-br" id="container_integrations_binding"><h2 class="topictitle2" id="d58942e526">Ligando um serviço a partir da GUI do <span class="keyword">Bluemix</span></h2>
<div class="body taskbody"><p class="shortdesc">O <span class="keyword">IBM
Bluemix</span> possui uma lista de serviços e
gerencia-os em nome dos desenvolvedores de apps. Para incluir um serviço
do <span class="keyword">Bluemix</span> para uso
do contêiner, deve-se solicitar uma instância desse serviço e ligar o serviço ao contêiner.</p>
<div class="section prereq">Antes de iniciar, inclua o serviço no espaço do <span class="keyword">Bluemix</span>. Para obter mais informações, consulte <a href="../services/reqnsi.html#req_instance">Solicitando uma nova instância de
serviço</a>.</div><div class="section context"><div class="note restriction" id="container_integrations_binding__restriction"><span class="restrictiontitle">Restrição:</span> Alguns serviços do
<span class="keyword">Bluemix</span> não
suportam a ligação diretamente com um contêiner e levam a uma falha durante a criação do
contêiner. Nesse caso, ligue o serviço do
<span class="keyword">Bluemix</span> ao app
Cloud Foundry primeiro e depois ligue o app ao contêiner. O app age como uma ponte entre o serviço e o contêiner. Para obter mais informações, consulte <a href="container_troubleshoot.html#ts_bridge_app">O serviço do Bluemix não é ligado diretamente a um contêiner</a>.</div>
</div><ol class="steps"><li class="step"><span class="cmd">No <span class="keyword wintitle">Catálogo</span> do
<span class="keyword">Bluemix</span>, clique em <span class="ph uicontrol">Contêineres</span>.</span></li>
<li class="step"><span class="cmd">Clique em uma imagem de contêiner.</span></li>
<li class="step"><span class="cmd">Expanda <span class="ph uicontrol">Opções avançadas</span> e para <span class="ph uicontrol">Selecionar um
serviço</span>, selecione um serviço disponível do <span class="keyword">Bluemix</span>.</span></li>
<li class="step"><span class="cmd">Clique em <span class="ph uicontrol">Incluir</span>.</span> O serviço do
<span class="keyword">Bluemix</span> é exibido
no campo <span class="ph uicontrol">Já ligado ao seu contêiner</span>.</li>
<li class="step"><span class="cmd">Conclua os outros campos e, em seguida, clique em <span class="ph uicontrol">CREATE</span>.</span></li>
<li class="step"><span class="cmd">Quando o contêiner for criado, verifique se as informações de VCAP_SERVICES são exibidas.</span> Na guia Visão Geral do contêiner, localize o serviço de limite e clique em <span class="ph uicontrol">Visualizar
credenciais</span>. As informações exibidas são os VCAP_SERVICES.</li>
</ol>
</div>
</article><article class="topic task nested1" role="article" aria-labelledby="d58942e683" lang="pt-br" id="container_integrations_binding_cli"><h2 class="topictitle2" id="d58942e683">Ligando um serviço a um contêiner a partir da CLI</h2>
<div class="body taskbody"><p class="shortdesc">O <span class="keyword">IBM
Bluemix</span> possui uma lista de serviços e
gerencia-os em nome dos desenvolvedores de apps. Para incluir um serviço
do <span class="keyword">Bluemix</span> para uso
do contêiner, deve-se solicitar uma instância desse serviço e ligar o serviço ao contêiner.</p>
<div class="section prereq">Antes de iniciar, inclua o serviço no espaço do <span class="keyword">Bluemix</span>. Para obter mais informações, consulte <a href="../services/reqnsi.html#req_instance">Solicitando uma nova instância de
serviço</a>.</div><div class="section context"><div class="note restriction" id="container_integrations_binding_cli__restriction"><span class="restrictiontitle">Restrição:</span> Alguns serviços do
<span class="keyword">Bluemix</span> não
suportam a ligação diretamente com um contêiner e levam a uma falha durante a criação do
contêiner. Nesse caso, ligue o serviço do
<span class="keyword">Bluemix</span> ao app
Cloud Foundry primeiro e depois ligue o app ao contêiner. O app age como uma ponte entre o serviço e o contêiner. Para obter mais informações, consulte <a href="container_troubleshoot.html#ts_bridge_app">O serviço do Bluemix não é ligado diretamente a um contêiner</a>.</div>
</div><ol class="steps"><li class="step stepexpand"><span class="cmd">Use um dos comandos a seguir para ligar a instância de serviço do
<span class="keyword">Bluemix</span> a um novo
contêiner.</span> <div class="note tip"><span class="tiptitle">Dica:</span> <span class="ph">Execute <samp class="ph codeph"><span class="ph">bx ic</span> namespace-get</samp> para recuperar
seu namespace e substitua <var class="keyword varname">&lt;my_namespace&gt;</var> por suas informações de namespace.</span></div>
<ul class="ul choices"><li class="li choice">Se você estiver criando um único contêiner, use o comando
a seguir.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> run --name <var class="keyword varname">container_name</var> -e "<var class="keyword varname">CCS_BIND_SRV</var>=<var class="keyword varname">service_instance1</var>,<var class="keyword varname">service_instance2</var>" registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">&lt;my_namespace&gt;</var>/<var class="keyword varname">image_name</var></code></pre>
</li>
<li class="li choice">Se você estiver criando um grupo de contêiner, use o comando
a seguir.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> group-create --name <var class="keyword varname">container_group_name</var> -e "<var class="keyword varname">CCS_BIND_SRV</var>=<var class="keyword varname">service_instance1</var>,<var class="keyword varname">service_instance2</var>" registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">&lt;my_namespace&gt;</var>/<var class="keyword varname">image_name</var></code></pre>
</li>
<li class="li choice">Se você estiver ligando um serviço ao grupo de contêiner que já está em execução,
use o comando a seguir. Esse comando está disponível somente para grupos de contêiner. Apenas
um serviço pode ser ligado por vez.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> service-bind <var class="keyword varname">container_group_name</var> <var class="keyword varname">service_instance</var></code></pre>
</li>
</ul>
</li>
<li class="step stepexpand"><span class="cmd">Use um dos comandos a seguir para verificar se a instância de serviço está ligada ao
contêiner.</span> <ul class="ul choices"><li class="li choice">Para um único contêiner, use o comando
a seguir.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> inspect CONTAINER</code></pre>
</li>
<li class="li choice">Para um grupo de contêiner, use o comando
a seguir.<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> group-inspect GROUP</code></pre>
</li>
</ul>
Verifique se as informações de VCAP_SERVICES para o serviço são
exibidas.
<pre class="codeblock"><code>{
 "VCAP_SERVICES": {
  "&lt;service_name&gt;": [
   {
    "credentials": {
     "hostname": "&lt;hostname_id&gt;",
     "jdbcUrl": "&lt;jdbc_URL&gt;",
     "name": "&lt;encoded_name&gt;",
     "password": "&lt;encoded_password&gt;",
     "port": "&lt;port_number&gt;",
     "uri": "&lt;service_URI&gt;",
     "username": "&lt;encoded_username&gt;"
    },
    "label": "&lt;service_name&gt;",
    "name": "&lt;service_instance&gt;",
    "plan": "&lt;plan_name&gt;",
    "tags": [
     "&lt;tag1&gt;",
     "&lt;tag2&gt;",
     "&lt;tag3&gt;"
    ]
   } </code></pre>
</li>
</ol>
</div>
</article><article class="topic task nested1" role="article" aria-labelledby="d58942e883" lang="pt-br" id="container_alertnotification"><h2 class="topictitle2" id="d58942e883">Configurando alertas para apps implementados em contêineres usando o <span class="keyword">Alert Notification</span></h2>
<div class="body taskbody"><p class="shortdesc">Configure seu app para enviar notificações quando uma determinada condição ou
critérios são atendidos e use o serviço
<span class="keyword">Alert Notification</span>
para gerenciar suas notificações de alerta. Com o serviço
<span class="keyword">Alert Notification</span>, é
possível criar políticas de notificação customizadas que filtram os alertas do seu
interesse. É possível refinar
os filtros de política conforme necessário para especificar indivíduos ou grupos como destinatários de alertas, bem como
métodos e frequência de notificação preferenciais.</p>
<div class="section prereq">Antes de iniciar, revise o tópico <a href="../services/reqnsi.html#req_instance">Solicitando uma nova instância de serviço</a> e crie uma instância do serviço <span class="keyword">Alert Notification</span> em seu espaço do <span class="keyword">Bluemix</span>. </div><div class="section context"><p>As etapas a seguir mostram como criar um contêiner que executa um app do nó
<span class="keyword">Alert Notification</span> de
amostra. É possível enviar alertas de teste para o serviço
<span class="keyword">Alert Notification</span> e
revisá-los na ferramenta Visualizador de alerta. </p>
</div><ol class="steps"><li class="step stepexpand"><span class="cmd">Faça download e clone o
<a href="https://github.com/IBM-Bluemix/alert-notification-helloworld" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">app
de Notificação de alerta</a> de amostra para sua máquina local. </span> <pre class="codeblock"><code>git clone <span class="ph filepath">https://github.com/IBM-Bluemix/alert-notification-helloworld.git</span></code></pre>


<div class="steps note"><span class="notetitle">Nota:</span> Ao clonar o projeto Git, uma nova pasta chamada
<span class="ph filepath">alert-notification-helloworld</span> é criada em sua máquina local. </div>
</li>
<li class="step stepexpand"><span class="cmd">Construa uma imagem de contêiner que inclua o app Alert Notification de amostra e envie-a por push para o
registro de imagens privadas do <span class="keyword">Bluemix</span>. </span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd"><a href="container_cli_cfic_install.html#container_cli_login" title="Depois de instalar a CLI, efetue login para usá-la.">Efetue login na CLI do
<span class="keyword">IBM
Bluemix Container Service</span></a>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Navegue para o diretório <span class="ph filepath">alert-notification-helloworld</span>. </span></li>
<li class="li substep substepexpand"><span class="cmd">Crie a imagem do contêiner e envie-a por push para o registro de imagens privadas do <span class="keyword">Bluemix</span>. Execute
<samp class="ph codeph"><span class="ph"><samp class="ph codeph">bx ic</samp></span> namespace-get</samp> para recuperar as suas
informações de espaço de nomes e substituir <var class="keyword varname">&lt;my_namespace&gt;</var> por seu espaço de nomes.</span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> build -t registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">&lt;my_namespace&gt;</var>/alert .</code></pre>
</li>
<li class="li substep substepexpand"><span class="cmd">Verifique se a imagem do contêiner foi criada e enviada por push com sucesso. </span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> images</code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Crie um contêiner a partir da imagem e ligue o serviço
<span class="keyword">Alert Notification</span> a
ele. Substitua
<var class="keyword varname">&lt;my_namespace&gt;</var> pelas informações de namespace e
<var class="keyword varname">&lt;my_alert&gt;</var> pelo nome da instância de serviço de notificação de
alerta que você criou no início. </span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> run --name alertcontainer -p 8080 -e "CCS_BIND_SRV=<var class="keyword varname">&lt;my_alert&gt;</var>" registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">&lt;my_namespace&gt;</var>/alert</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Verifique se o contêiner está em execução.</span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> ps</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Ligue um endereço IP público ao contêiner. </span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Listar os endereços IP públicos que estão disponíveis em seu espaço e anote o
endereço IP que você deseja usar. </span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> ips</code></pre>


<div class="note tip"><span class="tiptitle">Dica:</span> Se nenhum endereço IP público estiver disponível em seu espaço, execute <samp class="ph codeph"><span class="ph"><samp class="ph codeph">bx ic</samp></span> ip-request</samp> para solicitar um novo
endereço IP. Também é possível desvincular um endereço IP usado de um contêiner executando o comando <samp class="ph codeph"><span class="ph"><samp class="ph codeph">bx ic</samp></span> unbind <var class="keyword varname">&lt;IP_ADDRESS&gt;</var>
<var class="keyword varname">&lt;CONTAINER&gt;</var></samp>.</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Ligue o endereço IP público ao contêiner. Substitua
<var class="keyword varname">&lt;IP_ADDRESS&gt;</var> pelo endereço IP que você anotou na etapa anterior. </span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> ip-bind <var class="keyword varname">&lt;IP_ADDRESS&gt;</var> alertcontainer</code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Crie um alerta de teste.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Abra o navegador da web.</span></li>
<li class="li substep substepexpand"><span class="cmd">Insira o endereço IP e a porta em seu navegador da web, conforme a seguir:
<samp class="ph codeph"><var class="keyword varname">&lt;IP_ADDRESS&gt;</var>:8080</samp>. </span> A página de boas-vindas do seu app da web
<span class="keyword">Alert Notification</span> é
aberta.
<p><img src="images/alertapp.png" width="400" alt="Testar seu app da web de Notificação de alerta"></p>
</li>
<li class="li substep substepexpand"><span class="cmd">Clique no botão <span class="ph uicontrol">Enviar alerta de amostra</span> para enviar um
alerta de teste para o Visualizador de alerta.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Abra o <span class="keyword wintitle">Visualizador de alerta</span> e revise o alerta de teste.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Na GUI do <span class="keyword">Bluemix</span>, selecione sua
instância de contêiner em execução. </span></li>
<li class="li substep"><span class="cmd">Clique no serviço
<span class="keyword">Alert Notification</span>
sob <span class="ph uicontrol">Serviços de limite</span>.</span></li>
<li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">Ativar</span> para abrir o Visualizador de alerta.</span></li>
<li class="li substep"><span class="cmd">Revise seu alerta de teste. </span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Explore os recursos do serviço
<span class="keyword">Alert Notification</span>.</span> Revise a documentação do
<span class="keyword">Alert Notification</span>
para localizar mais informações sobre como
<a href="../services/AlertNotification/alert_configuring.html" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">criar
políticas de notificação</a> e
<a href="../services/AlertNotification/alert_viewer.html" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">gerenciar
seus alertas</a>.</li>
</ol>
</div>
</article><article class="topic concept nested1" role="article" aria-labelledby="d58942e1210" lang="pt-br" id="container_pipeline_ov"><h2 class="topictitle2" id="d58942e1210">Automatizando implementações de contêiner usando o <span class="keyword">Delivery Pipeline</span> no serviço <span class="keyword">Continuous Delivery</span></h2>
<div class="body conbody"><p class="shortdesc">Automatize as construções de app e as implementações de contêiner para o <span class="keyword">Bluemix</span> usando o <span class="keyword">Delivery Pipeline</span>, que faz parte do <span class="keyword">IBM
Bluemix Continuous Delivery</span>.</p>
<div class="p">O <span class="keyword">Delivery Pipeline</span> suporta:<ul><li>Construção de imagens do Docker</li>
<li>Implementação de imagens em contêineres para <span class="keyword">Bluemix</span></li>
</ul>
</div>
<div><p>Guia de iniciação rápida para implementar contêineres usando o <span class="keyword">Delivery Pipeline</span>:</p>

<ol><li>Crie um repositório Git que contenha seu código.</li>
<li>Inclua um <samp class="ph codeph">Dockerfile</samp> no diretório-raiz de seu repositório. </li>
<li>No menu, clique em
<span class="ph menucascade"><span class="ph uicontrol">Serviços</span> &gt; <span class="ph uicontrol">DevOps</span></span> e, em seguida,
clique em <span class="ph uicontrol">Pipelines</span>.</li>
<li>Clique em <span class="ph menucascade"><span class="ph uicontrol">Criar pipeline</span> &gt; <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span></span>.</li>
<li>Clique em
<span class="ph uicontrol">Criar</span>.</li>
<li>Inclua o repositório Git na cadeia de ferramentas.<ol type="a" id="container_pipeline_ov__ol_mvk_s3v_vz"><li>Clique em <span class="ph uicontrol">Incluir uma ferramenta</span>.</li>
<li>Clique no tipo de serviço Git que hospeda o repositório.</li>
<li>Forneça os detalhes de configuração para o repositório.</li>
<li>Clique em
<span class="ph uicontrol">Criar integração</span>.</li>
</ol>
</li>
<li>Na página Visão geral da cadeia de ferramentas, clique em <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</li>
<li>Crie um estágio de compilação que inclua uma tarefa de
compilação.<ol type="a" id="container_pipeline_ov__ol_pds_x3v_vz"><li>Clique em <span class="ph uicontrol">Incluir estágio</span>.</li>
<li>Na guia <span class="ph uicontrol">ENTRADA</span>, para o <span class="ph uicontrol">Tipo de entrada</span>, selecione
<span class="ph uicontrol">Repositório Git</span>.</li>
<li>Na guia <span class="ph uicontrol">TAREFAS</span>, inclua uma tarefa de construção. Para o <span class="ph uicontrol">Tipo de
construtor</span>, selecione <span class="ph uicontrol">IBM Containers no <span class="keyword">Bluemix</span></span>.</li>
</ol>
</li>
<li>Crie um estágio de implementação que inclua uma tarefa de
implementação.<ol type="a" id="container_pipeline_ov__ol_ahk_djv_vz"><li>Na guia <span class="ph uicontrol">ENTRADA</span>, para o <span class="ph uicontrol">Tipo de entrada</span>, selecione
<span class="ph uicontrol">Artefatos de construção</span>.</li>
<li>Na guia <span class="ph uicontrol">TAREFAS</span>, para o <span class="ph uicontrol">Tipo de implementador</span>, selecione
<span class="ph uicontrol">IBM Container Service for Bluemix</span>.</li>
</ol>
</li>
<li>Execute uma implementação enviando por push uma mudança de código ou clicando no ícone Executar estágio no estágio de
construção do <span class="keyword">Delivery Pipeline</span>.</li>
</ol>
</div><div>Precisa de mais informações? Consulte os tópicos a seguir.<ul><li><a href="container_integrations.html#container_single_pipeline_ov" title="Automatize a construção e a implementação de seus contêineres únicos com o Delivery Pipeline.">Criando um único contêiner usando o Delivery Pipeline</a></li>
<li><a href="container_integrations.html#container_group_pipeline_ov" title="Automatize a construção e a implementação de seus grupos de contêineres usando o Delivery Pipeline.">Criando grupos de contêineres usando o Delivery Pipeline</a></li>
</ul>
</div></div>
<article class="topic task nested2" role="article" aria-labelledby="d58942e1444" lang="pt-br" id="container_single_pipeline_ov"><h3 class="topictitle3" id="d58942e1444">Criando um único contêiner usando o <span class="keyword">Delivery Pipeline</span></h3>
<div class="body taskbody"><p class="shortdesc">Automatize a construção e a implementação de seus contêineres únicos com o <span class="keyword">Delivery Pipeline</span>.</p>
</div>
<article class="topic task nested3" role="article" aria-labelledby="d58942e1504" lang="pt-br" id="container_single_pipeline_build"><h4 class="topictitle4" id="d58942e1504">Criando estágios de construção para contêineres usando o <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">O <span class="keyword">IBM
Bluemix Container Service</span>
inclui um serviço de construção que usa o código-fonte e, em seguida, constrói e publica uma imagem do Docker para
o registro do contêiner. O <span class="keyword">Delivery Pipeline</span>,
que faz parte do <span class="keyword">IBM
Bluemix Continuous Delivery</span>, fornece
uma tarefa de construção que usa o serviço de construção de contêiner. Essa tarefa de compilação utiliza
o código-fonte de um repositório, compila uma imagem de Docker desse
código, cria versões (tags) dessa imagem para corresponder ao número de
construção, em seguida, envia a imagem resultante para o registro do
<span class="keyword">IBM
Bluemix Container Service</span>
da organização no
<span class="keyword">Bluemix</span>. Em seguida, os membros da organização podem implementar a imagem
resultante em espaços dentro da organização.</p>
<div class="section prereq" id="container_single_pipeline_build__prereq"> <div class="p">Antes de iniciar, considere as informações a seguir. <ul><li>Para saber mais sobre construções, estágios e funcionalidade básica de pipeline, veja o tópico <a href="../services/ContinuousDelivery/pipeline_about.html">Sobre o <span class="keyword">Delivery Pipeline</span></a> na documentação do <span class="keyword">Continuous Delivery</span>.</li>
<li>Identifique uma imagem existente no registro de imagens privadas de sua organização para usar em seu
contêiner, verificando o <span class="keyword wintitle">Catálogo</span> do <span class="keyword">Bluemix</span>.</li>
<li>Se souber que deseja ligar um serviço ao contêiner, crie um app para usar como uma ponte.
Para obter mais informações, consulte <a href="container_integrations.html#unique_191016160" title="Os serviços não podem ser ligados diretamente a um contêiner. Como alternativa, é possível ligar o serviço a um app e, em seguida, ligar esse app ao contêiner, configurando uma propriedade de ambiente em um estágio do pipeline. O app serve como uma ponte entre o serviço e o contêiner.">Ligando um serviço a um contêiner usando o <span class="keyword">Delivery Pipeline</span></a>.</li>
</ul>
</div>
 </div><p class="li stepsection">Construa uma imagem do Docker a partir do <span class="keyword">Delivery Pipeline</span>.</p><ol class="steps" id="container_single_pipeline_build__steps"><li class="step stepexpand"><span class="cmd">Crie um Dockerfile no diretório-raiz do repositório Git que está associado à sua
cadeia de ferramentas e confirme-o em seu repositório.</span></li>
<li class="step stepexpand"><span class="cmd">Na página Visão geral da cadeia de ferramentas, clique em <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step stepexpand"><span class="cmd">Crie um estágio de compilação.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">Incluir estágio</span>.</span></li>
<li class="li substep"><span class="cmd">Nomeie o estágio. </span> Por exemplo, <samp class="ph codeph"><var class="keyword varname">Build</var></samp>.</li>
<li class="li substep"><span class="cmd">Para o <span class="ph uicontrol">Tipo de entrada</span>, selecione <span class="ph uicontrol">Repositório
Git</span>.</span></li>
<li class="li substep"><span class="cmd">Para os outros campos, verifique os valores e atualize, se necessário.</span></li>
<li class="li substep"><span class="cmd">Clique na guia <span class="ph uicontrol">TAREFAS</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">No estágio de compilação, crie uma tarefa de
compilação.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Na guia <span class="ph uicontrol">TAREFAS</span>, clique em
<span class="ph uicontrol">INCLUIR TAREFA</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Selecione o tipo de tarefa <span class="ph uicontrol">Compilação</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o <span class="ph uicontrol">Tipo de construtor</span>, selecione <span class="ph uicontrol">IBM Containers no
<span class="keyword">Bluemix</span></span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Se necessário, atualize o destino, a organização
e o espaço do <span class="keyword">Bluemix</span>. </span></li>
<li class="li substep substepexpand"><span class="cmd">Para <span class="ph uicontrol">Usar camadas em cache</span>, limpe o campo quando você deve forçar uma atualização de
camadas que puxam conteúdo dinamicamente de outras fontes. </span> <p>Por exemplo, se o <samp class="ph codeph">Dockerfile</samp> incluir um comando <samp class="ph codeph">apt-get
install</samp> ou <samp class="ph codeph">wget</samp>, assegure-se de que essas dependências dinâmicas sejam
reunidas em cada compilação, limpando a caixa de seleção <span class="ph uicontrol">Usar camadas em cache</span>. </p>
 <div class="steps note"><span class="notetitle">Nota:</span> Quando o campo <span class="ph uicontrol">Usar camadas em cache</span> é limpo, os tempos de construção são maiores
porque as camadas em cache não são usadas quando a imagem está sendo construída.</div>
</li>
<li class="li substep substepexpand"><span class="cmd">No campo <span class="ph uicontrol">Nome da imagem</span>, insira um nome para a imagem a ser construída. Para atender às
convenções de nomenclatura do Docker, use somente letras minúsculas, números e hifens (-). </span> Quando a imagem é
construída, ela é identificada com o nome da imagem e um número de construção.  Por exemplo, se você digitar o nome da imagem
<samp class="ph codeph">myappimage</samp>, a imagem resultante para o número de
construção 4 será denominada <samp class="ph codeph">myappimage:4</samp>. </li>
<li class="li substep substepexpand"><span class="cmd">Se o Dockerfile não estiver localizado no diretório-raiz do projeto, na seção
Script de Construção, inclua o caminho para o Dockerfile nos locais a seguir.</span> <ol type="i"><li>Antes da seção Executar testes de unidade, inclua o nome da pasta com um comando change directory.<div class="p"><pre class="codeblock"><code>cd <var class="keyword varname">&lt;folder&gt;</var></code></pre>
</div>
</li>
<li>Sempre que a variável <var class="keyword varname">${WORKSPACE}</var> for exibida, anexe o nome da pasta. A variável
<var class="keyword varname">${WORKSPACE}</var> detecta automaticamente o diretório-raiz do projeto para
você.<div class="p">Exemplo<pre class="codeblock"><code>BUILD_COMMAND="build --pull --tag ${FULL_REPOSITORY_NAME} ${WORKSPACE}/<var class="keyword varname">&lt;folder&gt;</var>"</code></pre>
</div>
</li>
</ol>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Clique no ícone <span class="ph uicontrol">Executar estágio</span> para verificar se o estágio é construído sem
erros.</span> Se a construção falhar, revise os logs e corrija os erros. Se o estágio passar, verifique o
registro de imagem de sua organização e verifique se a imagem foi construída.</li>
</ol>
</div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58942e1805" lang="pt-br" id="container_pipeline_vulnerability"><h4 class="topictitle4" id="d58942e1805">(Opcional) Verificando a segurança da imagem como parte do pipeline</h4>
<div class="body taskbody"><div class="abstract"><span class="shortdesc">Localize problemas de segurança ou configuração em sua imagem antes que o contêiner seja implementado
usando o Vulnerability Advisor.</span>
</div>
<div class="section context"><div class="p">Configuração de pipeline comum que inclui esta
varredura:<ul><li>Estágio de compilação para compilar os arquivos de origem</li>
<li>Estágio de processamento, que inclui as seguintes tarefas: <ul><li>Uma tarefa de compilação para executar uma compilação de
contêiner</li>
<li>Uma tarefa de teste para executar o Vulnerability Advisor em uma imagem</li>
</ul>
</li>
<li>Estágio de implementação para implementar o contêiner</li>
</ul>
</div>

<div class="note tip"><span class="tiptitle">Dica:</span> Essa tarefa descreve como criar uma tarefa de teste para o Vulnerability Advisor em um
estágio diferente da tarefa que constrói a imagem do contêiner. Como alternativa, é possível usar o mesmo
estágio. Se decidir criar um estágio separado, não será necessário configurar
a variável de ambiente. </div>
</div><p class="li stepsection">Crie a varredura do Vulnerability Advisor.</p><ol class="steps" id="container_pipeline_vulnerability__steps"><li class="step stepexpand"><span class="cmd">Crie um estágio de processamento.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">Incluir estágio</span>.</span></li>
<li class="li substep"><span class="cmd">Nomeie o estágio. </span> Por exemplo, <samp class="ph codeph"><var class="keyword varname">Processing</var></samp>. </li>
<li class="li substep"><span class="cmd">Para o tipo de entrada, selecione <span class="ph uicontrol">Artefatos de construção</span>.</span></li>
<li class="li substep"><span class="cmd">Para o estágio e tarefa, verifique os valores e os atualize, se
necessário.</span></li>
<li class="li substep"><span class="cmd">Clique na guia <span class="ph uicontrol">TAREFAS</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">No estágio de processamento, inclua uma tarefa de teste para executar a varredura de código.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Na guia <span class="ph uicontrol">TAREFAS</span>, clique em <span class="ph uicontrol">INCLUIR TAREFA</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o tipo de tarefa, selecione <span class="ph uicontrol">Teste</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o <span class="ph uicontrol">Tipo de testador</span>, selecione <span class="ph uicontrol">IBM Vulnerability
Advisor</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Se necessário, atualize o destino, a organização
e o espaço do <span class="keyword">Bluemix</span>. </span></li>
<li class="li substep substepexpand"><span class="cmd">Para <span class="ph uicontrol">Minutos para aguardar a conclusão da
análise</span>, insira um valor de 0 a 59 minutos.</span> O valor padrão é <var class="keyword varname">5</var> minutos. Uma URL para o painel é fornecida nos
logs do console no final da tarefa. 
<p>Se a varredura não for concluída antes do término desse tempo, a tarefa
falhará, mas a análise da varredura continuará em execução e poderá ser visualizada no painel. Após a varredura ser
concluída, se você executar novamente a tarefa, a solicitação de varredura não será reenviada e a tarefa de pipeline
poderá ser concluída com êxito. Alternativamente, você pode configurar o
pipeline para que não seja bloqueado em um resultado de varredura
bem-sucedido, que é descrito na próxima etapa. </p>
</li>
<li class="li substep substepexpand"><span class="cmd">Para determinar o comportamento no tempo limite, selecione ou limpe a caixa de seleção <span class="ph uicontrol">Parar de executar este estágio se
esta tarefa falhar</span>.</span> <p>É possível configurar a tarefa para bloquear tarefas posteriores
no estágio e estágios posteriores da execução se essa tarefa
falhar, ou você pode configurar o estágio para continuar sem bloqueio depois de
tarefas e estágios.
O estado da tarefa é determinado pela existência de problemas graves de segurança. </p>


<p>Problemas graves de segurança fazem com que a tarefa falhe. Dependendo da seleção para <span class="ph uicontrol">Parar
execução desse estágio se essa tarefa falhar</span>, uma tarefa com falha interromperá o andamento do estágio
e do pipeline ou permitirá que continuem. Se você
souber que o relatório inclui muitos problemas de processamento,
poderá configurar o estágio para continuar porque a varredura pode
levar um longo tempo. Neste cenário, você pode não desejar que o
restante das tarefas e dos estágios parem apenas porque a
varredura está demorando muito.</p>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Se a tarefa estiver no mesmo estágio que a tarefa de construção, configure uma variável de ambiente para o
nome de repositório.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Clique na guia <span class="ph uicontrol">PROPRIEDADES DO AMBIENTE</span>.</span></li>
<li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">INCLUIR PROPRIEDADE</span> e selecione <span class="ph uicontrol">Propriedade
de Texto</span>.</span></li>
<li class="li substep"><span class="cmd">No campo <span class="ph uicontrol">Nome</span>, insira <samp class="ph codeph">FULL_REPOSITORY_NAME</samp></span></li>
<li class="li substep"><span class="cmd">No campo <span class="ph uicontrol">Valor</span>, não insira nada.</span> O nome da imagem que está especificado na tarefa de compilação de contêiner é transmitida por meio desta variável
de ambiente.</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Clique no ícone <span class="ph uicontrol">Executar estágio</span> para verificar se o estágio é construído sem
erros.</span></li>
</ol>
<div class="section result"><div class="p">Para visualizar os resultados de uma varredura do Vulnerability Advisor, após a conclusão da tarefa, clique em
<span class="ph uicontrol">Visualizar resultados e histórico</span>. Na guia <span class="ph uicontrol">LOGS</span>, procure
a seção
a seguir:<pre class="pre msgblock"><code>image registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">namespace</var>/<var class="keyword varname">image</var> vulnerability results found</code></pre>
</div>

<p>Uma lista de pacotes vulneráveis, problemas de segurança e sugestões de melhoria são listados, conforme
descrito no tópico <a href="va/va_index.html#va_reviewing">Revisando um relatório de imagem</a> do Vulnerability Advisor. O
código do Dockerfile é fornecido para resolver alguns
problemas comuns em <a href="va/va_index.html#va_report">Resolvendo
problemas em imagens</a>.</p>
</div></div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58942e2083" lang="pt-br" id="container_pipeline_cleanup"><h4 class="topictitle4" id="d58942e2083">(Opcional) Limpando imagens com o <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">A tarefa de construção do <span class="keyword">IBM
Bluemix Container Service</span> limpa
versões de imagem não usadas automaticamente. Imagens que estão em uso não são removidas. É possível especificar um
número de versões de imagem para manter ou é possível desativar a limpeza da imagem.</p>
<p class="li stepsection">Para mudar o número de versões de imagem que são mantidas para um projeto:</p><ol class="steps"><li class="step"><span class="cmd">No pipeline, abra a configuração para o estágio de
compilação.</span></li>
<li class="step"><span class="cmd">Na guia <span class="ph uicontrol">PROPRIEDADES DO AMBIENTE</span>, clique em <span class="ph uicontrol">INCLUIR
PROPRIEDADE</span>.</span></li>
<li class="step"><span class="cmd">Selecione <span class="ph uicontrol">Propriedade de texto</span>.</span></li>
<li class="step"><span class="cmd">No campo <span class="ph uicontrol">Nome</span>, insira o comando <samp class="ph codeph">IMAGE_LIMIT</samp>.</span></li>
<li class="step"><span class="cmd">No campo <span class="ph uicontrol">Valor</span>, insira o número de versões de imagem para esse projeto
a serem mantidas no registro. Por padrão, as cinco versões de imagem mais recentes para um projeto são mantidas. Para
desativar a limpeza da imagem e manter todas as versões de imagem, configure o valor como
<samp class="ph codeph">-1</samp>.</span></li>
<li class="step"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
</ol>
</div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58942e2218" lang="pt-br" id="container_binding_pipeline"><h4 class="topictitle4" id="d58942e2218">(Opcional) Ligando um serviço a um contêiner usando o <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">Os serviços não podem ser ligados diretamente a um contêiner. Como alternativa, é possível ligar o
serviço a um app e, em seguida, ligar esse app ao contêiner, configurando uma propriedade de ambiente em
um estágio do pipeline. O app serve como uma ponte entre o serviço e o contêiner.</p>
<div class="section prereq"><p id="container_binding_pipeline__context">O <span class="keyword">Bluemix</span> fornece um conjunto
de variáveis de ambiente que definem os nomes e detalhes dos serviços que estão ligados a um app,
como o MySQL ClearDB Database ou Question and Answer. Essas variáveis de ambiente são chamadas <samp class="ph codeph">VCAP_SERVICES</samp>. Quando um contêiner é ligado a um serviço os
<samp class="ph codeph">VCAP_SERVICES</samp> são passados para o contêiner como uma variável de ambiente por meio de um
app que age como uma ponte entre o contêiner e o serviço. Em seguida, o contêiner pode consultar
informações do serviço, como o terminal, o usuário e a senha.</p>

<p>Antes de configurar a propriedade do ambiente, identifique um app existente que tenha serviços que
já estejam ligados a ele ou crie um app usando a GUI do <span class="keyword">Bluemix</span> ou a linha de comandos. Para obter mais informações, consulte <a href="container_troubleshoot.html#ts_bridge_app">O serviço do Bluemix não é ligado diretamente a um contêiner</a>.</p>
</div><p class="li stepsection">Ligue o app de ponte ao contêiner.</p><ol class="steps"><li class="step"><span class="cmd">Na página de visão geral da cadeia de ferramentas, clique em <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step"><span class="cmd">Abra um estágio de pipeline e clique na guia
<span class="ph uicontrol">PROPRIEDADES DO AMBIENTE</span>.</span></li>
<li class="step"><span class="cmd">Clique em <span class="ph uicontrol">INCLUIR PROPRIEDADE</span> e selecione
<span class="ph uicontrol">Propriedade de texto</span>.</span></li>
<li class="step"><span class="cmd">No campo <span class="ph uicontrol">Nome</span>, insira o comando
<kbd class="ph userinput">BIND_TO</kbd>.</span></li>
<li class="step"><span class="cmd">No campo <span class="ph uicontrol">Valor</span>, insira o nome do app de ponte, como
<var class="keyword varname">pipeline_bridge_app</var>.</span></li>
<li class="step"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
<li class="step"><span class="cmd">Teste a configuração executando seu pipeline.</span></li>
</ol>
<div class="section postreq"><div class="note tip"><span class="tiptitle">Dica:</span> Depois que o app de ligação estiver ligado a um contêiner, não exclua o app de ligação. Se
você excluir um app de ligação ligado, o contêiner será interrompido. Exclua o contêiner, e quaisquer outros contêineres que estiverem
utilizando o app de ligação, antes de excluir o app de ligação.</div>
</div></div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58942e2378" lang="pt-br" id="container_single_pipeline_deploy"><h4 class="topictitle4" id="d58942e2378">Criando estágios de implementação para contêineres com o <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">É possível criar um estágio de implementação para o contêiner usando o <span class="keyword">Delivery Pipeline</span>.</p>
<div class="section prereq"><div class="p">Antes de iniciar:<ul><li><a href="container_integrations.html#container_single_pipeline_build" title="O IBM Bluemix Container Service inclui um serviço de construção que usa o código-fonte e, em seguida, constrói e publica uma imagem do Docker para o registro do contêiner. O Delivery Pipeline, que faz parte do IBM Bluemix Continuous Delivery, fornece uma tarefa de construção que usa o serviço de construção de contêiner. Essa tarefa de compilação utiliza o código-fonte de um repositório, compila uma imagem de Docker desse código, cria versões (tags) dessa imagem para corresponder ao número de construção, em seguida, envia a imagem resultante para o registro do IBM Bluemix Container Service da organização no Bluemix. Em seguida, os membros da organização podem implementar a imagem resultante em espaços dentro da organização.">Crie
um estágio de construção</a>.</li>
<li><a href="https://github.com/Osthanes/deployscripts/blob/master/deploycontainer.sh" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">Revise
o script de implementação padrão para contêineres únicos</a>.
É possível bifurcar o script padrão e editá-lo ou então criar seu próprio script para uso.</li>
<li><a href="../services/ContinuousDelivery/pipeline_deploy_var.html">Revise uma lista de variáveis de ambiente disponíveis que são fornecidas pelo serviço <span class="keyword">Delivery Pipeline</span></a>.</li>
</ul>
</div>
</div><ol class="steps"><li class="step stepexpand"><span class="cmd">Na página Visão geral da cadeia de ferramentas, clique em <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step stepexpand" id="container_single_pipeline_deploy__deploy_stage"><span class="cmd">Crie um estágio de implementação.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">INCLUIR ESTÁGIO</span>.</span></li>
<li class="li substep"><span class="cmd">Nomeie o estágio. </span> Por exemplo, <samp class="ph codeph"><var class="keyword varname">Deploy</var></samp>.</li>
<li class="li substep"><span class="cmd">Para o tipo de entrada, selecione <span class="ph uicontrol">Artefatos de construção</span>.</span></li>
</ol>
</li>
<li class="step stepexpand" id="container_single_pipeline_deploy__deployment_job"><span class="cmd">No estágio, crie uma tarefa de implementação.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Na guia <span class="ph uicontrol">TAREFAS</span>, clique em <span class="ph uicontrol">INCLUIR TAREFA</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o tipo de tarefa, selecione <span class="ph uicontrol">Implementar</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o tipo de implementador, selecione <span class="ph uicontrol">IBM Container Service no <span class="keyword">Bluemix</span></span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para organização e espaço, verifique os
valores e os atualize, se necessário.</span></li>
<li class="li substep substepexpand"><span class="cmd">No campo <span class="ph uicontrol">Estratégia de implementação</span>, insira um dos valores
a seguir.</span> <ul><li><span class="ph uicontrol">red_black</span> - Implementa uma nova versão do app. Se a implementação for bem-sucedida, a implementação anterior do
app será removida e o endereço IP ou rota será mapeado para a nova
versão.</li>
<li><span class="ph uicontrol">clean</span> - Remove todas as implementações anteriores do aplicativo. </li>
</ul>
 <div class="note tip"><span class="tiptitle">Dica:</span> A propriedade do
ambiente <samp class="ph codeph">CONCURRENT_VERSIONS</samp> configura o número de
versões das implementações do app que manterá ativas. O valor padrão
é uma versão. Por exemplo, se <samp class="ph codeph">CONCURRENT_VERSIONS</samp> for configurado como 2
e você estiver usando um endereço IP, a implementação mais recente será ligada ao
endereço IP, mas a versão anterior ainda será implementada para uma espera rápida. 
<p>Para
remover sempre todas as implementações do app, na guia <span class="ph uicontrol">ENVIRONMENT
PROPERTIES</span>, é possível configurar <samp class="ph codeph">CONCURRENT_VERSIONS</samp> como
<samp class="ph codeph">0</samp>.</p>
</div>
</li>
<li class="li substep substepexpand"><span class="cmd">No campo <span class="ph uicontrol">Nome</span>, insira o nome do contêiner a ser implementado.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para a porta, insira a porta publicada para o contêiner.</span> Separe diversas portas com vírgula (,).
<div class="note tip" id="container_single_pipeline_deploy__private_container"><span class="tiptitle">Dica:</span> Se nenhuma porta for especificada e você estiver
usando o script de implementação padrão, a porta 80 será publicada automaticamente. Para
tornar um contêiner privado com o script de implementação padrão, conclua as etapas a
seguir.
<ol type="i"><li>Para estratégia de implementação, insira <kbd class="ph userinput">simple</kbd>.</li>
<li> Deixe o campo <span class="ph uicontrol">Porta</span> em branco.</li>
<li>Como as implementações simples não limpam as implementações
anteriores, será possível criar outro estágio de implementação para limpá-las. Configure
a <span class="ph uicontrol">Estratégia de implementação</span> no segundo estágio de implementação
como <kbd class="ph userinput">clean</kbd>.</li>
</ol>
</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Se você tiver quaisquer argumentos de implementação opcionais, insira-os.</span> Por exemplo, se o app requerer uma variável de ambiente para o local do banco de dados
de backend, você poderá incluir esta linha:

<pre class="codeblock"><code>--env MY_DB_HOSTNAME_PROPERTY=<var class="keyword varname">mydbhostname</var></code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Se você criou seu próprio script de implementação, edite a seção
<span class="ph uicontrol">Script do implementador</span> para usá-lo.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Copie a linha a seguir e atualize-a para usar seu repositório.</span> <pre class="pre screen"><code>git_retry clone https://github.com/Osthanes/deployscripts.git deployscripts</code></pre>
</li>
<li class="li substep substepexpand"><span class="cmd">Edite a linha a seguir para usar seu script.</span> <pre class="pre screen"><code>/bin/bash deployscripts/deploycontainer.sh</code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
</ol>
</div>
</article></article><article class="topic task nested2" role="article" aria-labelledby="d58942e2655" lang="pt-br" id="container_group_pipeline_ov"><h3 class="topictitle3" id="d58942e2655">Criando grupos de contêineres usando o <span class="keyword">Delivery Pipeline</span></h3>
<div class="body taskbody"><p class="shortdesc">Automatize a construção e a implementação de seus grupos de contêineres usando o <span class="keyword">Delivery Pipeline</span>.</p>
</div>
<article class="topic task nested3" role="article" aria-labelledby="d58942e2721" lang="pt-br" id="container_group_pipeline_build"><h4 class="topictitle4" id="d58942e2721">Criando estágios de compilação para grupos de contêiner usando o<span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">O <span class="keyword">IBM
Bluemix Container Service</span>
inclui um serviço de construção que usa o código-fonte e, em seguida, constrói e publica uma imagem do Docker para
o registro do contêiner. O <span class="keyword">Delivery Pipeline</span>,
que faz parte do <span class="keyword">IBM
Bluemix Continuous Delivery</span>, fornece
uma tarefa de construção que usa o serviço de construção de contêiner. Essa tarefa de compilação utiliza
o código-fonte de um repositório, compila uma imagem de Docker desse
código, cria versões (tags) dessa imagem para corresponder ao número de
construção, em seguida, envia a imagem resultante para o registro do
<span class="keyword">IBM
Bluemix Container Service</span>
da organização no
<span class="keyword">Bluemix</span>. Em seguida, os membros da organização podem implementar a imagem
resultante em espaços dentro da organização.</p>
<div class="section prereq"> <div class="p">Antes de iniciar, considere as informações a seguir. <ul><li>Para saber mais sobre construções, estágios e funcionalidade básica de pipeline, veja o tópico <a href="../services/ContinuousDelivery/pipeline_about.html">Sobre o <span class="keyword">Delivery Pipeline</span></a> na documentação do <span class="keyword">Continuous Delivery</span>.</li>
<li>Identifique uma imagem existente no registro de imagens privadas de sua organização para usar em seu
contêiner, verificando o <span class="keyword wintitle">Catálogo</span> do <span class="keyword">Bluemix</span>.</li>
<li>Se souber que deseja ligar um serviço ao contêiner, crie um app para usar como uma ponte.
Para obter mais informações, consulte <a href="container_integrations.html#unique_191016160" title="Os serviços não podem ser ligados diretamente a um contêiner. Como alternativa, é possível ligar o serviço a um app e, em seguida, ligar esse app ao contêiner, configurando uma propriedade de ambiente em um estágio do pipeline. O app serve como uma ponte entre o serviço e o contêiner.">Ligando um serviço a um contêiner usando o <span class="keyword">Delivery Pipeline</span></a>.</li>
</ul>
</div>
 </div><p class="li stepsection">Construa uma imagem do Docker a partir do <span class="keyword">Delivery Pipeline</span>.</p><ol class="steps"><li class="step stepexpand"><span class="cmd">Crie um Dockerfile no diretório-raiz do repositório Git que está associado à sua
cadeia de ferramentas e confirme-o em seu repositório.</span></li>
<li class="step stepexpand"><span class="cmd">Na página Visão geral da cadeia de ferramentas, clique em <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step stepexpand"><span class="cmd">Crie um estágio de compilação.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">Incluir estágio</span>.</span></li>
<li class="li substep"><span class="cmd">Nomeie o estágio. </span> Por exemplo, <samp class="ph codeph"><var class="keyword varname">Build</var></samp>.</li>
<li class="li substep"><span class="cmd">Para o <span class="ph uicontrol">Tipo de entrada</span>, selecione <span class="ph uicontrol">Repositório
Git</span>.</span></li>
<li class="li substep"><span class="cmd">Para os outros campos, verifique os valores e atualize, se necessário.</span></li>
<li class="li substep"><span class="cmd">Clique na guia <span class="ph uicontrol">TAREFAS</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">No estágio de compilação, crie uma tarefa de
compilação.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Na guia <span class="ph uicontrol">TAREFAS</span>, clique em
<span class="ph uicontrol">INCLUIR TAREFA</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Selecione o tipo de tarefa <span class="ph uicontrol">Compilação</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o <span class="ph uicontrol">Tipo de construtor</span>, selecione <span class="ph uicontrol">IBM Containers no
<span class="keyword">Bluemix</span></span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Se necessário, atualize o destino, a organização
e o espaço do <span class="keyword">Bluemix</span>. </span></li>
<li class="li substep substepexpand"><span class="cmd">Para <span class="ph uicontrol">Usar camadas em cache</span>, limpe o campo quando você deve forçar uma atualização de
camadas que puxam conteúdo dinamicamente de outras fontes. </span> <p>Por exemplo, se o <samp class="ph codeph">Dockerfile</samp> incluir um comando <samp class="ph codeph">apt-get
install</samp> ou <samp class="ph codeph">wget</samp>, assegure-se de que essas dependências dinâmicas sejam
reunidas em cada compilação, limpando a caixa de seleção <span class="ph uicontrol">Usar camadas em cache</span>. </p>
 <div class="steps note"><span class="notetitle">Nota:</span> Quando o campo <span class="ph uicontrol">Usar camadas em cache</span> é limpo, os tempos de construção são maiores
porque as camadas em cache não são usadas quando a imagem está sendo construída.</div>
</li>
<li class="li substep substepexpand"><span class="cmd">No campo <span class="ph uicontrol">Nome da imagem</span>, insira um nome para a imagem a ser construída. Para atender às
convenções de nomenclatura do Docker, use somente letras minúsculas, números e hifens (-). </span> Quando a imagem é
construída, ela é identificada com o nome da imagem e um número de construção.  Por exemplo, se você digitar o nome da imagem
<samp class="ph codeph">myappimage</samp>, a imagem resultante para o número de
construção 4 será denominada <samp class="ph codeph">myappimage:4</samp>. </li>
<li class="li substep substepexpand"><span class="cmd">Se o Dockerfile não estiver localizado no diretório-raiz do projeto, na seção
Script de Construção, inclua o caminho para o Dockerfile nos locais a seguir.</span> <ol type="i"><li>Antes da seção Executar testes de unidade, inclua o nome da pasta com um comando change directory.<div class="p"><pre class="codeblock"><code>cd <var class="keyword varname">&lt;folder&gt;</var></code></pre>
</div>
</li>
<li>Sempre que a variável <var class="keyword varname">${WORKSPACE}</var> for exibida, anexe o nome da pasta. A variável
<var class="keyword varname">${WORKSPACE}</var> detecta automaticamente o diretório-raiz do projeto para
você.<div class="p">Exemplo<pre class="codeblock"><code>BUILD_COMMAND="build --pull --tag ${FULL_REPOSITORY_NAME} ${WORKSPACE}/<var class="keyword varname">&lt;folder&gt;</var>"</code></pre>
</div>
</li>
</ol>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Clique no ícone <span class="ph uicontrol">Executar estágio</span> para verificar se o estágio é construído sem
erros.</span> Se a construção falhar, revise os logs e corrija os erros. Se o estágio passar, verifique o
registro de imagem de sua organização e verifique se a imagem foi construída.</li>
</ol>
</div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58942e3026" lang="pt-br" id="unique_1687504071"><h4 class="topictitle4" id="d58942e3026">(Opcional) Verificando a segurança da imagem como parte do pipeline</h4>
<div class="body taskbody"><div class="abstract"><span class="shortdesc">Localize problemas de segurança ou configuração em sua imagem antes que o contêiner seja implementado
usando o Vulnerability Advisor.</span>
</div>
<div class="section context"><div class="p">Configuração de pipeline comum que inclui esta
varredura:<ul><li>Estágio de compilação para compilar os arquivos de origem</li>
<li>Estágio de processamento, que inclui as seguintes tarefas: <ul><li>Uma tarefa de compilação para executar uma compilação de
contêiner</li>
<li>Uma tarefa de teste para executar o Vulnerability Advisor em uma imagem</li>
</ul>
</li>
<li>Estágio de implementação para implementar o contêiner</li>
</ul>
</div>

<div class="note tip"><span class="tiptitle">Dica:</span> Essa tarefa descreve como criar uma tarefa de teste para o Vulnerability Advisor em um
estágio diferente da tarefa que constrói a imagem do contêiner. Como alternativa, é possível usar o mesmo
estágio. Se decidir criar um estágio separado, não será necessário configurar
a variável de ambiente. </div>
</div><p class="li stepsection">Crie a varredura do Vulnerability Advisor.</p><ol class="steps" id="unique_1687504071__steps"><li class="step stepexpand"><span class="cmd">Crie um estágio de processamento.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">Incluir estágio</span>.</span></li>
<li class="li substep"><span class="cmd">Nomeie o estágio. </span> Por exemplo, <samp class="ph codeph"><var class="keyword varname">Processing</var></samp>. </li>
<li class="li substep"><span class="cmd">Para o tipo de entrada, selecione <span class="ph uicontrol">Artefatos de construção</span>.</span></li>
<li class="li substep"><span class="cmd">Para o estágio e tarefa, verifique os valores e os atualize, se
necessário.</span></li>
<li class="li substep"><span class="cmd">Clique na guia <span class="ph uicontrol">TAREFAS</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">No estágio de processamento, inclua uma tarefa de teste para executar a varredura de código.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Na guia <span class="ph uicontrol">TAREFAS</span>, clique em <span class="ph uicontrol">INCLUIR TAREFA</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o tipo de tarefa, selecione <span class="ph uicontrol">Teste</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o <span class="ph uicontrol">Tipo de testador</span>, selecione <span class="ph uicontrol">IBM Vulnerability
Advisor</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Se necessário, atualize o destino, a organização
e o espaço do <span class="keyword">Bluemix</span>. </span></li>
<li class="li substep substepexpand"><span class="cmd">Para <span class="ph uicontrol">Minutos para aguardar a conclusão da
análise</span>, insira um valor de 0 a 59 minutos.</span> O valor padrão é <var class="keyword varname">5</var> minutos. Uma URL para o painel é fornecida nos
logs do console no final da tarefa. 
<p>Se a varredura não for concluída antes do término desse tempo, a tarefa
falhará, mas a análise da varredura continuará em execução e poderá ser visualizada no painel. Após a varredura ser
concluída, se você executar novamente a tarefa, a solicitação de varredura não será reenviada e a tarefa de pipeline
poderá ser concluída com êxito. Alternativamente, você pode configurar o
pipeline para que não seja bloqueado em um resultado de varredura
bem-sucedido, que é descrito na próxima etapa. </p>
</li>
<li class="li substep substepexpand"><span class="cmd">Para determinar o comportamento no tempo limite, selecione ou limpe a caixa de seleção <span class="ph uicontrol">Parar de executar este estágio se
esta tarefa falhar</span>.</span> <p>É possível configurar a tarefa para bloquear tarefas posteriores
no estágio e estágios posteriores da execução se essa tarefa
falhar, ou você pode configurar o estágio para continuar sem bloqueio depois de
tarefas e estágios.
O estado da tarefa é determinado pela existência de problemas graves de segurança. </p>


<p>Problemas graves de segurança fazem com que a tarefa falhe. Dependendo da seleção para <span class="ph uicontrol">Parar
execução desse estágio se essa tarefa falhar</span>, uma tarefa com falha interromperá o andamento do estágio
e do pipeline ou permitirá que continuem. Se você
souber que o relatório inclui muitos problemas de processamento,
poderá configurar o estágio para continuar porque a varredura pode
levar um longo tempo. Neste cenário, você pode não desejar que o
restante das tarefas e dos estágios parem apenas porque a
varredura está demorando muito.</p>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Se a tarefa estiver no mesmo estágio que a tarefa de construção, configure uma variável de ambiente para o
nome de repositório.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Clique na guia <span class="ph uicontrol">PROPRIEDADES DO AMBIENTE</span>.</span></li>
<li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">INCLUIR PROPRIEDADE</span> e selecione <span class="ph uicontrol">Propriedade
de Texto</span>.</span></li>
<li class="li substep"><span class="cmd">No campo <span class="ph uicontrol">Nome</span>, insira <samp class="ph codeph">FULL_REPOSITORY_NAME</samp></span></li>
<li class="li substep"><span class="cmd">No campo <span class="ph uicontrol">Valor</span>, não insira nada.</span> O nome da imagem que está especificado na tarefa de compilação de contêiner é transmitida por meio desta variável
de ambiente.</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Clique no ícone <span class="ph uicontrol">Executar estágio</span> para verificar se o estágio é construído sem
erros.</span></li>
</ol>
<div class="section result"><div class="p">Para visualizar os resultados de uma varredura do Vulnerability Advisor, após a conclusão da tarefa, clique em
<span class="ph uicontrol">Visualizar resultados e histórico</span>. Na guia <span class="ph uicontrol">LOGS</span>, procure
a seção
a seguir:<pre class="pre msgblock"><code>image registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">namespace</var>/<var class="keyword varname">image</var> vulnerability results found</code></pre>
</div>

<p>Uma lista de pacotes vulneráveis, problemas de segurança e sugestões de melhoria são listados, conforme
descrito no tópico <a href="va/va_index.html#va_reviewing">Revisando um relatório de imagem</a> do Vulnerability Advisor. O
código do Dockerfile é fornecido para resolver alguns
problemas comuns em <a href="va/va_index.html#va_report">Resolvendo
problemas em imagens</a>.</p>
</div></div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58942e3304" lang="pt-br" id="unique_984317078"><h4 class="topictitle4" id="d58942e3304">(Opcional) Limpando imagens com o <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">A tarefa de construção do <span class="keyword">IBM
Bluemix Container Service</span> limpa
versões de imagem não usadas automaticamente. Imagens que estão em uso não são removidas. É possível especificar um
número de versões de imagem para manter ou é possível desativar a limpeza da imagem.</p>
<p class="li stepsection">Para mudar o número de versões de imagem que são mantidas para um projeto:</p><ol class="steps"><li class="step"><span class="cmd">No pipeline, abra a configuração para o estágio de
compilação.</span></li>
<li class="step"><span class="cmd">Na guia <span class="ph uicontrol">PROPRIEDADES DO AMBIENTE</span>, clique em <span class="ph uicontrol">INCLUIR
PROPRIEDADE</span>.</span></li>
<li class="step"><span class="cmd">Selecione <span class="ph uicontrol">Propriedade de texto</span>.</span></li>
<li class="step"><span class="cmd">No campo <span class="ph uicontrol">Nome</span>, insira o comando <samp class="ph codeph">IMAGE_LIMIT</samp>.</span></li>
<li class="step"><span class="cmd">No campo <span class="ph uicontrol">Valor</span>, insira o número de versões de imagem para esse projeto
a serem mantidas no registro. Por padrão, as cinco versões de imagem mais recentes para um projeto são mantidas. Para
desativar a limpeza da imagem e manter todas as versões de imagem, configure o valor como
<samp class="ph codeph">-1</samp>.</span></li>
<li class="step"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
</ol>
</div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58942e3439" lang="pt-br" id="unique_191016160"><h4 class="topictitle4" id="d58942e3439">(Opcional) Ligando um serviço a um contêiner usando o <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">Os serviços não podem ser ligados diretamente a um contêiner. Como alternativa, é possível ligar o
serviço a um app e, em seguida, ligar esse app ao contêiner, configurando uma propriedade de ambiente em
um estágio do pipeline. O app serve como uma ponte entre o serviço e o contêiner.</p>
<div class="section prereq"><p id="unique_191016160__context">O <span class="keyword">Bluemix</span> fornece um conjunto
de variáveis de ambiente que definem os nomes e detalhes dos serviços que estão ligados a um app,
como o MySQL ClearDB Database ou Question and Answer. Essas variáveis de ambiente são chamadas <samp class="ph codeph">VCAP_SERVICES</samp>. Quando um contêiner é ligado a um serviço os
<samp class="ph codeph">VCAP_SERVICES</samp> são passados para o contêiner como uma variável de ambiente por meio de um
app que age como uma ponte entre o contêiner e o serviço. Em seguida, o contêiner pode consultar
informações do serviço, como o terminal, o usuário e a senha.</p>

<p>Antes de configurar a propriedade do ambiente, identifique um app existente que tenha serviços que
já estejam ligados a ele ou crie um app usando a GUI do <span class="keyword">Bluemix</span> ou a linha de comandos. Para obter mais informações, consulte <a href="container_troubleshoot.html#ts_bridge_app">O serviço do Bluemix não é ligado diretamente a um contêiner</a>.</p>
</div><p class="li stepsection">Ligue o app de ponte ao contêiner.</p><ol class="steps"><li class="step"><span class="cmd">Na página de visão geral da cadeia de ferramentas, clique em <span class="ph uicontrol"><span class="keyword">Delivery Pipeline</span></span>.</span></li>
<li class="step"><span class="cmd">Abra um estágio de pipeline e clique na guia
<span class="ph uicontrol">PROPRIEDADES DO AMBIENTE</span>.</span></li>
<li class="step"><span class="cmd">Clique em <span class="ph uicontrol">INCLUIR PROPRIEDADE</span> e selecione
<span class="ph uicontrol">Propriedade de texto</span>.</span></li>
<li class="step"><span class="cmd">No campo <span class="ph uicontrol">Nome</span>, insira o comando
<kbd class="ph userinput">BIND_TO</kbd>.</span></li>
<li class="step"><span class="cmd">No campo <span class="ph uicontrol">Valor</span>, insira o nome do app de ponte, como
<var class="keyword varname">pipeline_bridge_app</var>.</span></li>
<li class="step"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
<li class="step"><span class="cmd">Teste a configuração executando seu pipeline.</span></li>
</ol>
<div class="section postreq"><div class="note tip"><span class="tiptitle">Dica:</span> Depois que o app de ligação estiver ligado a um contêiner, não exclua o app de ligação. Se
você excluir um app de ligação ligado, o contêiner será interrompido. Exclua o contêiner, e quaisquer outros contêineres que estiverem
utilizando o app de ligação, antes de excluir o app de ligação.</div>
</div></div>
</article><article class="topic task nested3" role="article" aria-labelledby="d58942e3599" lang="pt-br" id="container_group_pipeline_deploy"><h4 class="topictitle4" id="d58942e3599">Criando estágios de implementação para grupos de contêineres usando o <span class="keyword">Delivery Pipeline</span></h4>
<div class="body taskbody"><p class="shortdesc">É possível criar um estágio de implementação para seu grupo de contêineres usando o <span class="keyword">Delivery Pipeline</span>.</p>
<div class="section prereq"><div class="p">Antes de iniciar:<ul><li><a href="container_integrations.html#container_group_pipeline_build" title="O IBM Bluemix Container Service inclui um serviço de construção que usa o código-fonte e, em seguida, constrói e publica uma imagem do Docker para o registro do contêiner. O Delivery Pipeline, que faz parte do IBM Bluemix Continuous Delivery, fornece uma tarefa de construção que usa o serviço de construção de contêiner. Essa tarefa de compilação utiliza o código-fonte de um repositório, compila uma imagem de Docker desse código, cria versões (tags) dessa imagem para corresponder ao número de construção, em seguida, envia a imagem resultante para o registro do IBM Bluemix Container Service da organização no Bluemix. Em seguida, os membros da organização podem implementar a imagem resultante em espaços dentro da organização.">Crie
um estágio de construção</a>.</li>
<li><a href="https://github.com/Osthanes/deployscripts/blob/master/deploygroup.sh" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">Revise
o script de implementação padrão para grupos de contêiner</a>. É possível bifurcar o script padrão e editá-lo ou então criar seu próprio script para uso.</li>
<li><a href="../services/ContinuousDelivery/pipeline_deploy_var.html">Revise uma lista de variáveis de ambiente disponíveis que são fornecidas pelo serviço <span class="keyword">Delivery Pipeline</span></a>.</li>
</ul>
</div>
</div><ol class="steps"><li class="step stepexpand"><span class="cmd">Crie um estágio de implementação.</span> <ol type="a" class="ol substeps"><li class="li substep"><span class="cmd">Clique em <span class="ph uicontrol">INCLUIR ESTÁGIO</span>.</span></li>
<li class="li substep"><span class="cmd">Nomeie o estágio. </span> Por exemplo, <samp class="ph codeph"><var class="keyword varname">Deploy</var></samp>.</li>
<li class="li substep"><span class="cmd">Para o tipo de entrada, selecione <span class="ph uicontrol">Artefatos de construção</span>.</span></li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">No estágio, crie uma tarefa de implementação.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Na guia <span class="ph uicontrol">TAREFAS</span>, clique em <span class="ph uicontrol">INCLUIR TAREFA</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o tipo de tarefa, selecione <span class="ph uicontrol">Implementar</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para o tipo de implementador, selecione <span class="ph uicontrol">IBM Container Service no <span class="keyword">Bluemix</span></span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Selecione a organização e o espaço.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para a estratégia de implementação, insira um dos valores a seguir.</span> <ul><li><span class="ph uicontrol">red_black</span> - Implementa uma nova versão do app. Se a implementação for bem-sucedida, a implementação anterior do
app será removida e o endereço IP ou rota será mapeado para a nova
versão.</li>
<li><span class="ph uicontrol">clean</span> - Remove todas as implementações anteriores do aplicativo. </li>
</ul>
</li>
<li class="li substep substepexpand"><span class="cmd">Para o nome, insira o nome do contêiner a ser implementado.</span></li>
<li class="li substep substepexpand"><span class="cmd">Para a porta, insira a porta publicada para o contêiner.</span> Para grupos de contêiner, somente é possível especificar uma porta.
<div class="note tip"><span class="tiptitle">Dica:</span> Se nenhuma porta for especificada e você estiver
usando o script de implementação padrão, a porta 80 será publicada automaticamente. Para
tornar um contêiner privado com o script de implementação padrão, conclua as etapas a
seguir.
<ol type="i"><li>Para estratégia de implementação, insira <kbd class="ph userinput">simple</kbd>.</li>
<li> Deixe o campo <span class="ph uicontrol">Porta</span> em branco.</li>
<li>Como as implementações simples não limpam as implementações
anteriores, será possível criar outro estágio de implementação para limpá-las. Configure
a <span class="ph uicontrol">Estratégia de implementação</span> no segundo estágio de implementação
como <kbd class="ph userinput">clean</kbd>.</li>
</ol>
</div>
</li>
<li class="li substep substepexpand"><span class="cmd">Se você tiver quaisquer argumentos de implementação opcionais, insira-os.</span> Por exemplo, se seu app requerer uma variável de ambiente para o local do banco de dados
de backend, você poderá incluir esta linha:

<pre class="codeblock"><code>--env MY_DB_HOSTNAME_PROPERTY=<var class="keyword varname">mydbhostname</var></code></pre>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Configure uma implementação de grupo de contêiner, em vez de uma implementação de
contêiner único. Na seção "Script do
implementador", remova o # para remover o comentário do script de grupo de contêiner:</span> <pre class="pre screen"><code>/bin/bash deployscripts/deploygroup.sh</code></pre>
Inclua um # para comentar o script de
contêiner único:
<pre class="pre screen"><code>#/bin/bash deployscripts/deploycontainer.sh</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Se você criou seu próprio script de implementação, edite a seção
<span class="ph uicontrol">Script do implementador</span> para usá-lo.</span> <ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Copie a linha a seguir e atualize-a para usar seu repositório.</span> <pre class="pre screen"><code>git_retry clone https://github.com/Osthanes/deployscripts.git deployscripts</code></pre>
</li>
<li class="li substep substepexpand"><span class="cmd">Edite a linha a seguir para usar seu script.</span> <pre class="pre screen"><code>/bin/bash deployscripts/deploygroup.sh</code></pre>
</li>
</ol>
</li>
<li class="step stepexpand">Opcional: <span class="cmd">Para configurar um grupo de contêiner básico, configure cada variável de ambiente na tabela.</span> Essas propriedades permitem definir algumas das opções que você poderá configurar
quando estiver implementando contêineres na linha de comandos ou na interface com o
usuário do <span class="keyword">Bluemix</span>. Para
outras propriedades, consulte os comentários na seção Script do implementador da
interface com o usuário.<ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">Clique na guia <span class="ph uicontrol">PROPRIEDADES DO AMBIENTE</span> e
clique em <span class="ph uicontrol">INCLUIR PROPRIEDADE</span>. </span></li>
<li class="li substep substepexpand"><span class="cmd">Selecione <span class="ph uicontrol">Propriedade de texto</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Insira o nome e o valor de uma propriedade de ambiente.</span> <div class="tablenoborder"><table summary="" id="container_group_pipeline_deploy__common_properties" class="defaultstyle"><thead><tr><th id="d58942e3889" class="thleft">Propriedade</th>
<th id="d58942e3891" class="thleft">Descrição</th>
</tr>
</thead>
<tbody><tr><td headers="d58942e3889 "><span class="ph uicontrol">AUTO_RECOVERY</span></td>
<td headers="d58942e3891 "><kbd class="ph userinput">true</kbd> ou <kbd class="ph userinput">false</kbd><p><span class="ph">Quando a recuperação automática é ativada para um grupo de contêiner e
o grupo fica em execução durante 10 minutos, o balanceador de carga do grupo inicia a verificação regular do
funcionamento de cada instância do contêiner no grupo por meio de solicitações de HTTP. Se uma instância do contêiner não
responder dentro de 100 segundos, ela será marcada como inativa. As instâncias de contêiner inativas são removidas do
grupo e recriadas pela recuperação automática. A recuperação automática tenta recuperar instâncias do contêiner em
um grupo 3 vezes. Após a terceira tentativa, a recuperação automática não recuperará nenhuma instância de contêiner no
grupo durante 60 minutos. Depois de 60 minutos, o processo de recuperação automática inicia novamente.</span></p>
</td>
</tr>
<tr><td headers="d58942e3889 "><span class="ph uicontrol">CONCURRENT_VERSIONS</span></td>
<td headers="d58942e3891 ">Um número<p>A propriedade do
ambiente <samp class="ph systemoutput">CONCURRENT_VERSIONS</samp> configura o número de
versões das implementações do app que manterá ativas. O valor padrão
é uma versão. Por
exemplo, se <samp class="ph systemoutput">CONCURRENT_VERSIONS</samp> for configurado como 2 e você estiver implementando um
grupo de contêiner, dois grupos serão mapeados para a rota e receberão tráfego.</p>

<p>Para sempre remover todas as implementações do app, na guia ENVIRONMENT PROPERTIES, é possível configurar
<samp class="ph systemoutput">CONCURRENT_VERSIONS</samp> como <samp class="ph systemoutput">0</samp>.</p>
</td>
</tr>
<tr><td headers="d58942e3889 "><span class="ph uicontrol">DESIRED_INSTANCES</span></td>
<td headers="d58942e3891 ">Um número<p>Exemplo: <samp class="ph codeph">4</samp></p>
<span class="ph">O número de instâncias do grupo de contêiner que seu app requer depende
da carga de trabalho esperada e do tempo em que uma solicitação pode ser processada pelo app. Por exemplo,
a conectividade de multitarefas ou de rede afeta quantas instâncias podem ser necessárias para seu app.</span><p><span class="ph">Para tornar seu grupo de contêiner altamente disponível e mais resiliente
à falha, considere a inclusão de instâncias extras, além do mínimo, para manipular a carga de trabalho esperada.
Instâncias extras podem manipular a carga de trabalho no caso de travamento de outra instância. Para assegurar a recuperação
automática de uma instância com falha sem afetar a carga de trabalho, inclua uma instância extra. Para
proteção contra duas falhas simultâneas, inclua duas instâncias extras. Essa configuração é um
padrão <var class="keyword varname">N+2</var>, em que <var class="keyword varname">N</var> é o número de instâncias para manipular as
solicitações e <var class="keyword varname">+2</var> são duas instâncias extras.</span></p>
</td>
</tr>
<tr><td headers="d58942e3889 "><span class="ph uicontrol">ROUTE_DOMAIN</span></td>
<td headers="d58942e3891 ">Uma sequência ou <samp class="ph codeph">none</samp><p>Exemplo:
<samp class="ph codeph">mycustomdomain.com</samp></p>
<p>O domínio do sistema padrão é
<samp class="ph codeph"><span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span></samp>
e já fornece um certificado SSL, para que seja possível acessar seus grupos de contêiner
com HTTPS sem nenhuma configuração adicional. Para usar um domínio customizado, deve-se registrar o domínio customizado em um servidor DNS público, configurar o domínio customizado no <span class="keyword">Bluemix</span> e, em seguida, mapear o domínio customizado para o domínio do sistema do <span class="keyword">Bluemix</span> no servidor DNS público.</p>
<p>Se um domínio não for especificado,
<samp class="ph codeph"><span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span></samp>
será usado. Se <samp class="ph codeph">none</samp> for especificado, nenhum domínio será
criado.</p>
<p>Se
<samp class="ph codeph">none</samp> for especificado para o nome do host e domínio, o grupo será
acessível por outros contêineres no mesmo espaço, mas não será publicamente acessível.</p>
</td>
</tr>
<tr><td headers="d58942e3889 "><span class="ph uicontrol">ROUTE_HOSTNAME</span></td>
<td headers="d58942e3891 ">Uma sequência ou <samp class="ph codeph">none</samp><p>Exemplo: <samp class="ph codeph">myapp</samp></p>
<p>O nome do host, como <var class="keyword varname">mycontainerhost</var>. Não inclua sublinhados (_) no nome do host. O host e o domínio combinados formam a URL de rota pública
completa, como <samp class="ph codeph">http://mycontainerhost.<span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span></samp>. </p>
<p>Se
um nome de host não for especificado, será criado um para você. Se <samp class="ph codeph">none</samp>
for especificado, nenhum nome de host será criado.</p>
<p>Se
<samp class="ph codeph">none</samp> for especificado para o nome do host e domínio, o grupo será
acessível por outros contêineres no mesmo espaço, mas não será publicamente acessível.</p>
</td>
</tr>
</tbody>
</table>
</div>
</li>
</ol>
</li>
<li class="step stepexpand"><span class="cmd">Clique em <span class="ph uicontrol">SALVAR</span>.</span></li>
</ol>
</div>
</article></article></article><article class="topic tutorial tutorialIntro nested1" role="article" aria-labelledby="d58942e4033" lang="pt-br" id="container_cfapp_tutorial_intro"><h2 class="topictitle2" id="d58942e4033">Tutorial: Implementando um app Node.js do Cloud Foundry em um contêiner</h2>
<div class="body  tutorialIntroBody"><p class="shortdesc">É possível usar um app implementado anteriormente usando o Cloud Foundry e implementá-lo em
um contêiner usando o <span class="keyword">IBM
Bluemix Container Service</span>.</p>
<div class="section tutorialDesc longDesc"></div><section class="section learningObjectives tutorialLearningObjectives" role="region" aria-labelledby="d58942e4082"><h3 class="sectiontitle" id="d58942e4082">Objetivos</h3>
<ul><li>Conheça o processo geral de implementação de contêineres</li>
<li>Saiba o que deve ser incluído em um Dockerfile para construir uma imagem</li>
</ul>
</section>
<section class="section timeRequired tutorialTimeRequired" role="region" aria-labelledby="d58942e4091"><h3 class="sectiontitle" id="d58942e4091">Tempo Necessário</h3>30 minutos</section>
<section role="region" aria-labelledby="d58942e4095" class="section section audienceDesc"><h3 class="sectiontitle" id="d58942e4095">Público</h3>Desenvolvedores de app do Cloud Foundry</section><section role="region" aria-labelledby="d58942e4099" class="section section prerequisites"><h3 class="sectiontitle" id="d58942e4099">Pré-requisitos</h3>
<ul><li><a href="container_cli_cfic_install.html#container_cli_cfic_install" title="Instale o plug-in do IBM Bluemix Container Service (bx ic) para executar comandos nativos do Docker CLI para gerenciar seus contêineres.">Instalar a CLI do <span class="keyword">IBM
Bluemix Container Service</span></a></li>
<li><a href="container_cli_cfic_install.html#container_cli_login" title="Depois de instalar a CLI, efetue login para usá-la.">Efetuar login na CLI do <span class="keyword">IBM
Bluemix Container Service</span></a></li>
</ul>
</section></div>
<article class="topic task tutorialLesson nested2" role="article" aria-labelledby="d58942e4140" lang="pt-br" id="container_cfapp_tutorial_lesson1"><h3 class="topictitle3" id="d58942e4140">Lição 1: Fazer download do código de app Node.js do Cloud Foundry</h3>
<div class="body taskbody"><p class="shortdesc">Faça com que o código Node.js esteja pronto para execução. Não tem nenhum código ainda? É possível fazer download do código de início
a partir do <span class="keyword">Bluemix</span> para usar neste
tutorial.</p>
<div class="section prereq">Antes de iniciar, <a href="container_cli_cfic_install.html#container_cli_cfic_install" title="Instale o plug-in do IBM Bluemix Container Service (bx ic) para executar comandos nativos do Docker CLI para gerenciar seus contêineres.">instale a CLI do <span class="keyword">IBM
Bluemix Container Service</span></a> e
<a href="container_cli_cfic_install.html#container_cli_login" title="Depois de instalar a CLI, efetue login para usá-la.">efetue login</a>.</div><p class="li stepsection">Para obter e organizar o código de app:</p><ol class="steps"><li class="step stepexpand"><span class="cmd">Crie um diretório com o nome <kbd class="ph userinput"><var class="keyword varname">cf-pi-myinitials</var></kbd> e
navegue até ele.</span> Nesse diretório, você salva todos os arquivos que são necessários para construir a imagem do Docker e para
executar seu app Node.js. É possível usar qualquer nome para o diretório. Se você usar o nome do exemplo,
substitua <var class="keyword varname">myinitials</var> por suas iniciais, como
<var class="keyword varname">cf-pi-ms</var>.
<pre class="codeblock"><code>mkdir <var class="keyword varname">cf-pi-myinitials</var> &amp;&amp; cd <var class="keyword varname">cf-pi-myinitials</var></code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Copie o código de app Node.js e todos os arquivos relacionados para o diretório.</span> É possível usar seu próprio código de app Node.js ou fazer download do app Personal Insights a partir do <span class="keyword">Bluemix</span>. 
<p>Para fazer download do código de app do
Personal Insights a partir do <span class="keyword">Bluemix</span>, siga estas
etapas.</p>
<ol type="a" class="ol substeps"><li class="li substep substepexpand"><span class="cmd">No <span class="keyword wintitle">Catálogo</span> do
<span class="keyword">Bluemix</span>, em <span class="ph uicontrol">Modelos</span>, clique em <span class="ph uicontrol">Personality
Insights Node.js Web Starter</span>.</span> Esse modelo inclui um app Node.js que usa o serviço <span class="keyword">IBM
Watson Personality Insights</span> para extrair um espectro
de características cognitivas e sociais de um texto que uma pessoa gera por meio de blogs, tweets
ou posts do fórum.</li>
<li class="li substep substepexpand"><span class="cmd">Insira o nome do app <kbd class="ph userinput"><var class="keyword varname">cf-pi-myinitials</var></kbd> e clique em
<span class="ph uicontrol">CRIAR</span>.</span> Para acessar o código de app do modelo, deve-se implementar o app do CF no <span class="keyword">Bluemix</span> primeiro. É possível usar qualquer nome para o app.
Se você usar o nome do exemplo, substitua <var class="keyword varname">myinitials</var> por suas iniciais, como
<var class="keyword varname">cf-pi-ms</var> para assegurar-se de que seja exclusivo. 
<p>Essa implementação cria um app com o
nome <var class="keyword varname">cf-pi-myinitials</var>, assim como uma instância do serviço <span class="keyword">IBM
Watson Personality Insights</span> com o nome
<var class="keyword varname">cf-pi-myinitials-personality_insights</var>. </p>

<p>À medida que o app é implementado,
são exibidas instruções para <strong>Implementando seu app com a interface da linha de comandos</strong>.</p>
</li>
<li class="li substep substepexpand"><span class="cmd">Na etapa 1, clique em <span class="ph uicontrol">FAZER DOWNLOAD DO CÓDIGO DE INÍCIO</span>.</span></li>
<li class="li substep substepexpand"><span class="cmd">Extraia o arquivo .zip e salve os arquivos de app em seu diretório. </span></li>
</ol>
</li>
</ol>
<div class="section result">Seu código de app do Cloud Foundry está pronto para ser conteinerizado!</div></div>
</article><article class="topic task tutorialLesson nested2" role="article" aria-labelledby="d58942e4335" lang="pt-br" id="container_cfapp_tutorial_lesson2"><h3 class="topictitle3" id="d58942e4335">Lição 2: Criando uma imagem do Docker com seu código de app CF</h3>
<div class="body taskbody"><p class="shortdesc">Crie um Dockerfile que inclua o código de app Node.js e as configurações necessárias
para seu contêiner. Em seguida, construa uma imagem do Docker a partir desse Dockerfile e envie-a por push para o registro privado do
<span class="keyword">Bluemix</span>.</p>
<p class="li stepsection">Para criar uma imagem do Docker com seu código de app, siga estas etapas.</p><ol class="steps"><li class="step stepexpand"><span class="cmd">Crie um <span class="ph filepath">Dockerfile</span>, que é a base para criar um contêiner. </span> É possível criar o Dockerfile usando seu editor de CLI preferencial ou um editor de texto no
computador. O exemplo a seguir mostra como criar um arquivo Dockerfile com o <a href="https://www.nano-editor.org/dist/v2.2/nano.html" rel="external" target="_blank" title="(Abre em uma nova guia ou janela)">nano
editor</a>. 
<pre class="codeblock"><code>nano Dockerfile</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Copie o script a seguir para o Dockerfile.</span> <pre class="codeblock"><code>#Use the IBM Node image as a base image
FROM registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/ibmnode:latest

#Expose the port for your Personal Insights app, and set 
#it as an environment variable as expected by cf apps
ENV PORT=3000
EXPOSE 3000
ENV NODE_ENV production

#Copy all app files from the current directory into the app 
#directory in your container. Set the app directory
#as the working directory
ADD . /app
WORKDIR /app

#Install any necessary requirements from package.json
RUN npm install

#Sleep before the app starts. This command ensures that the
#IBM Containers networking is finished before the app starts. 
CMD (sleep 60; npm start)

#Start the Personal Insight app. 
CMD ["node", "/app/app.js"]</code></pre>
</li>
<li class="step stepexpand"><span class="cmd">Salve suas mudanças pressionando <span class="ph uicontrol">ctrl + o</span>. Confirme suas mudanças pressionando
<span class="ph uicontrol">ENTER</span>. Saia do editor nano pressionando <span class="ph uicontrol">ctrl + x</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Construa a imagem do Docker com seu código de app e envie-a por push para o registro privado do <span class="keyword">Bluemix</span>.</span> <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> build -t registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">namespace</var>/<var class="keyword varname">cf-pi-myinitials</var> .</code></pre>


<div class="tablenoborder"><table summary="" id="container_cfapp_tutorial_lesson2__table_build" class="defaultstyle"><thead><tr><th colspan="2" id="d58942e4444" class="thleft"><span class="ph"><img src="images/idea.png" alt="Este ícone indica que há mais informações a serem conhecidas sobre esta etapa da tarefa."></span>
Entendendo os componentes deste comando</th>
</tr>
</thead>
<tbody><tr><td style="width: 50%" headers="d58942e4444 "><samp class="ph codeph">build</samp></td>
<td style="width: 50%" headers="d58942e4444 ">O comando <samp class="ph codeph">build</samp>.</td>
</tr>
<tr><td style="width: 50%" headers="d58942e4444 "><samp class="ph codeph">registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">namespace</var>/<var class="keyword varname">cf-pi-myinitials</var></samp></td>
<td style="width: 50%" headers="d58942e4444 ">Seu caminho do registro privado do <span class="keyword">Bluemix</span>,
que inclui o namespace exclusivo e o nome da imagem. Para este exemplo, o mesmo
nome é usado para a imagem como o app de nó do CF <var class="keyword varname">cf-pi-myinitials</var>, mas é possível
escolher qualquer nome para a imagem em seu registro privado. Se você não estiver seguro
de qual é seu namespace, execute o comando a seguir para localizá-lo.
<pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> namespace-get</code></pre>
</td>
</tr>
<tr><td style="width: 50%" headers="d58942e4444 "><samp class="ph codeph">.</samp></td>
<td style="width: 50%" headers="d58942e4444 ">A localização do Dockerfile. Se você estiver executando o comando de construção a partir do diretório que
inclui o Dockerfile, insira um ponto (.). Caso contrário, use um caminho relativo para o
Dockerfile.</td>
</tr>
</tbody>
</table>
</div>
</li>
</ol>
<div class="section result">A imagem é criada em seu registro. É possível executar o comando
<samp class="ph codeph"><span class="ph"><samp class="ph codeph">bx ic</samp></span> images</samp>
para verificar se a imagem foi criada.<pre class="pre screen"><code>$ <span class="ph"><samp class="ph codeph">bx ic</samp></span> images
REPOSITORY                                                  TAG                 IMAGE ID            CREATED             SIZE
registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">namespace</var>/<var class="keyword varname">cf-pi-myinitials</var>  latest  b02b7a24c35f  48 seconds ago  251.3 MB</code></pre>
</div></div>
</article><article class="topic task tutorialLesson nested2" role="article" aria-labelledby="d58942e4514" lang="pt-br" id="container_cfapp_tutorial_lesson3"><h3 class="topictitle3" id="d58942e4514">Lição 3: Implementar um contêiner a partir de sua imagem</h3>
<div class="body taskbody"><p class="shortdesc">Implemente seu app como um grupo de contêiner no <span class="keyword">Bluemix</span>.</p>
<p class="li stepsection">Para implementar seu app em um grupo contêiner, siga estas etapas.</p><ol class="steps"><li class="step stepexpand"><span class="cmd"> Crie um grupo de contêiner da imagem criada na lição anterior executando o
comando a seguir.</span>  <pre class="codeblock"><code><span class="ph"><samp class="ph codeph">bx ic</samp></span> group-create --name <var class="keyword varname">cf-pi-myinitials</var> -m 64 -n <var class="keyword varname">pi-app-myinitials</var> -d <span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span> -p 3000 -e CCS_BIND_SRV=<var class="keyword varname">cf-pi-myinitials-personal_insights</var> --desired 3 --auto --anti registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">namespace</var>/<var class="keyword varname">cf-pi-myinitials</var>:latest</code></pre>


<div class="p"><div class="tablenoborder"><table summary="" id="container_cfapp_tutorial_lesson3__table_group_create" class="defaultstyle"><thead><tr><th colspan="2" id="d58942e4600" class="thleft"><span class="ph"><img src="images/idea.png" alt="Este ícone indica que há mais informações a serem conhecidas sobre esta etapa da tarefa."></span>
Entendendo os componentes deste comando</th>
</tr>
</thead>
<tbody><tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">group-create</samp></td>
<td style="width: 50%" headers="d58942e4600 ">O comando <samp class="ph codeph">group-create</samp>.</td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">--name <var class="keyword varname">cf-pi-myinitials</var></samp></td>
<td style="width: 50%" headers="d58942e4600 ">O nome do contêiner do jeito que você deseja que seja exibido a partir da GUI do <span class="keyword">Bluemix</span>. </td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">-m 64</samp></td>
<td style="width: 50%" headers="d58942e4600 ">A cada instância no grupo são designados 64 MB de memória. </td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">-n <var class="keyword varname">pi-app-myinitials</var></samp></td>
<td style="width: 50%" headers="d58942e4600 ">O nome do host na URL da rota.<div class="note tip"><span class="tiptitle">Dica:</span> Se você estiver usando o código de início, use um
nome diferente para o nome do host do que o usado na lição anterior para implementar o
app Cloud Foundry. Se o mesmo host for usado e o app CF ainda estiver em execução, o balanceamento de carga ocorrerá entre
o grupo de contêiner e o app. </div>
</td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">-d <span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span></samp></td>
<td style="width: 50%" headers="d58942e4600 ">O nome do domínio na URL da rota. A menos que você tenha um domínio customizado, use <span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span>.</td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">-p 3000</samp></td>
<td style="width: 50%" headers="d58942e4600 ">O número da porta a ser exposta. As conexões para a URL da rota são encaminhadas para a porta 3000 no
contêiner. </td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">-e
CCS_BIND_SRV=<var class="keyword varname">cf-pi-myinitials-personal_insights</var></samp></td>
<td style="width: 50%" headers="d58942e4600 ">Ligue a instância de serviço do <span class="keyword">IBM
Watson Personality Insights</span>
ao contêiner, para que possa analisar as características cognitivas e sociais do
texto inserido no app Personal Insights. A instância de serviço foi criada como parte da
implementação do app CF na lição 1. <div class="p">Se você estiver inseguro sobre o nome de sua instância de serviço, execute o
comando a seguir. <pre class="codeblock"><code>bx service list</code></pre>
</div>
</td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">--desired 3</samp></td>
<td style="width: 50%" headers="d58942e4600 ">O número de instâncias de contêiner únicas a serem criadas no grupo de contêiner. Todas as
instâncias são iguais.</td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">--auto</samp></td>
<td style="width: 50%" headers="d58942e4600 ">Ativar a recuperação automática do grupo de contêiner. Se uma das instâncias no grupo
se tornar indisponível, outra instância será criada automaticamente, substituindo a não responsiva. </td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">--anti</samp></td>
<td style="width: 50%" headers="d58942e4600 ">Ativar a antiafinidade do grupo de contêiner. Cada instância do grupo é colocada em um
nó de cálculo físico separado, reduzindo as chances de impacto de todos os contêineres em um grupo em razão de
uma falha de hardware.</td>
</tr>
<tr><td style="width: 50%" headers="d58942e4600 "><samp class="ph codeph">registry.<span class="keyword" data-hd-keyref="DomainName">DomainName</span>/<var class="keyword varname">namespace</var>/<var class="keyword varname">cf-pi-myinitials</var>:latest</samp></td>
<td style="width: 50%" headers="d58942e4600 ">O caminho do repositório de destino, que inclui o namespace exclusivo e o nome da
imagem de destino. Para esse exemplo, o mesmo nome é usado para a imagem como o app de nó do CF
<var class="keyword varname">cf-pi-myinitials</var>. </td>
</tr>
</tbody>
</table>
</div>
</div>
</li>
<li class="step stepexpand"><span class="cmd">Aguarde alguns minutos para a implementação do contêiner e para a configuração da rede. Quando o
contêiner for implementado, será possível visualizar o app Personal Insights em um navegador inserindo a
URL a seguir <span class="ph filepath">http://<var class="keyword varname">pi-app-myinitials</var>.<span class="keyword" data-hd-keyref="APPDomain">AppDomainName</span>/</span>.</span></li>
<li class="step stepexpand"><span class="cmd">Remova o app CF. </span> Agora que seu código de app CF está implementado em um contêiner, será possível remover o app CF para maximizar
o uso de sua cota. 
<pre class="codeblock"><code>cf delete <var class="keyword varname">cf-pi-myinitials</var></code></pre>
Confirme a exclusão
inserindo <span class="ph uicontrol">y</span>. </li>
</ol>
<div class="section result">Seu app está implementado em um contêiner!</div></div>
</article></article></article></div></main></body></html>